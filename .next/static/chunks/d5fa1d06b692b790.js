(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92418,e=>{"use strict";e.s(["PRAYER_PHRASES",0,{fajr:{arabic:"Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø©ØŒ Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙÙ„Ø§Ø­ØŒ Ø§Ù„ØµÙ„Ø§Ø© Ø®ÙŠØ± Ù…Ù† Ø§Ù„Ù†ÙˆÙ…",transliteration:"Hayya 'ala as-salah, hayya 'ala al-falah, as-salatu khayrun min an-nawm",english:"Come to prayer, come to success, prayer is better than sleep"},dhuhr:{arabic:"Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø©ØŒ Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙÙ„Ø§Ø­",transliteration:"Hayya 'ala as-salah, hayya 'ala al-falah",english:"Come to prayer, come to success"},asr:{arabic:"Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø©ØŒ Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙÙ„Ø§Ø­",transliteration:"Hayya 'ala as-salah, hayya 'ala al-falah",english:"Come to prayer, come to success"},maghrib:{arabic:"Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø©ØŒ Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙÙ„Ø§Ø­",transliteration:"Hayya 'ala as-salah, hayya 'ala al-falah",english:"Come to prayer, come to success"},isha:{arabic:"Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø©ØŒ Ø­ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙÙ„Ø§Ø­",transliteration:"Hayya 'ala as-salah, hayya 'ala al-falah",english:"Come to prayer, come to success"}},"PROVIDER_COSTS",0,{openai:.015,elevenlabs:.3,azure:.016},"generateCacheKey",0,(e,a,t)=>{let n=btoa(e+a+t).replace(/[^a-zA-Z0-9]/g,"").substring(0,32);return`ai-voice-${t}-${a}-${n}`}])},62519,e=>{"use strict";var a=e.i(92418);class t{TAKBIR="Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø± Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±";TAKBIR_TRANSLITERATION="Allahu Akbar Allahu Akbar";TAKBIR_ENGLISH="Allah is the Greatest, Allah is the Greatest";BASMALA="Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø±Ø­ÙŠÙ…";BASMALA_TRANSLITERATION="Bismillah ar-Rahman ar-Raheem";BASMALA_ENGLISH="In the name of Allah, the Most Gracious, the Most Merciful";SHAHADA="Ø£Ø´Ù‡Ø¯ Ø£Ù† Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ØŒ Ø£Ø´Ù‡Ø¯ Ø£Ù† Ù…Ø­Ù…Ø¯Ø§Ù‹ Ø±Ø³ÙˆÙ„ Ø§Ù„Ù„Ù‡";SHAHADA_TRANSLITERATION="Ashhadu an la ilaha illa Allah, Ashhadu anna Muhammadan rasul Allah";SHAHADA_ENGLISH="I bear witness that there is no god but Allah, I bear witness that Muhammad is the messenger of Allah";generatePrayerCall(e,a={}){let t={includeArabic:!0,includeTransliteration:!0,includeEnglish:!0,includeBasmala:!1,includeTakbir:!0,customMessage:"",voiceStyle:"traditional",...a},n=e.toLowerCase(),r=[],i="",s="",o="";t.includeBasmala&&(t.includeArabic&&(i+=this.BASMALA+". "),t.includeTransliteration&&(s+=this.BASMALA_TRANSLITERATION+". "),t.includeEnglish&&(o+=this.BASMALA_ENGLISH+". "),r.push("basmala")),t.includeTakbir&&(t.includeArabic&&(i+=this.TAKBIR+". "),t.includeTransliteration&&(s+=this.TAKBIR_TRANSLITERATION+". "),t.includeEnglish&&(o+=this.TAKBIR_ENGLISH+". "),r.push("takbir"));let l=this.getPrayerSpecificContent(n);l&&(t.includeArabic&&(i+=l.arabic+". "),t.includeTransliteration&&(s+=l.transliteration+". "),t.includeEnglish&&(o+=l.english+". "),r.push("prayer-call")),"traditional"===t.voiceStyle&&(t.includeArabic&&(i+=this.SHAHADA+". "),t.includeTransliteration&&(s+=this.SHAHADA_TRANSLITERATION+". "),t.includeEnglish&&(o+=this.SHAHADA_ENGLISH+". "),r.push("shahada"));let c=this.getPrayerTimeAnnouncement(n);t.includeEnglish&&(o+=c+". "),r.push("time-announcement"),t.customMessage&&(t.includeEnglish&&(o+=t.customMessage+". "),r.push("custom-message"));let u=this.createCombinedText(i.trim(),s.trim(),o.trim(),t.voiceStyle);return{arabic:i.trim(),transliteration:s.trim(),english:o.trim(),combined:u,metadata:{prayer:e,timestamp:Date.now(),style:t.voiceStyle,components:r}}}getPrayerSpecificContent(e){let t=a.PRAYER_PHRASES[e];return t?{arabic:t.arabic,transliteration:t.transliteration,english:t.english}:null}getPrayerTimeAnnouncement(e){return({fajr:"Fajr prayer time",dhuhr:"Dhuhr prayer time",asr:"Asr prayer time",maghrib:"Maghrib prayer time",isha:"Isha prayer time"})[e]||`${e.charAt(0).toUpperCase()+e.slice(1)} prayer time`}createCombinedText(e,a,t,n){switch(n){case"traditional":return[e,a,t].filter(Boolean).join(" ");case"modern":default:return[e,t].filter(Boolean).join(" ");case"simple":return t}}generateContextualPrayerCall(e,a,t={}){a.getHours();let n={...t};switch(e.toLowerCase()){case"fajr":n.customMessage="Wake up for the dawn prayer. Prayer is better than sleep.";break;case"dhuhr":n.customMessage="Take a break from your activities for the noon prayer.";break;case"asr":n.customMessage="Time for the afternoon prayer before sunset.";break;case"maghrib":n.customMessage="The sun has set. Time for Maghrib prayer.";break;case"isha":n.customMessage="Complete your day with the night prayer."}return this.generatePrayerCall(e,n)}generateSchoolPrayerCall(e,a={},t={}){let n={...t};if(a.isSchoolHours&&a.hasStudents){let a={fajr:"Students and staff, it's time for Fajr prayer before school begins.",dhuhr:"Students and staff, please proceed to the prayer area for Dhuhr prayer.",asr:"Students and staff, time for Asr prayer. Classes will resume after prayer.",maghrib:"Students and staff, Maghrib prayer time. School day is ending.",isha:"Students and staff, time for Isha prayer before going home."}[e.toLowerCase()];a&&(n.customMessage=a)}return a.location&&(n.customMessage=(n.customMessage||"")+` Please gather at ${a.location}.`),this.generatePrayerCall(e,n)}generateMultilingualPrayerCall(e,a,t={}){let n={};for(let r of a){let a={...t};switch(r){case"arabic":a.includeArabic=!0,a.includeEnglish=!1,a.includeTransliteration=!1;break;case"english":a.includeArabic=!1,a.includeEnglish=!0,a.includeTransliteration=!0;break;case"hausa":case"twi":a.includeArabic=!0,a.includeEnglish=!0,a.includeTransliteration=!0,a.customMessage=this.getLocalLanguageGreeting(r,e)}n[r]=this.generatePrayerCall(e,a)}return n}getLocalLanguageGreeting(e,a){return({hausa:{fajr:"Lokacin sallah ta asuba ya yi. Ku zo mu yi sallah.",dhuhr:"Lokacin sallah ta rana ya yi. Ku zo mu yi sallah.",asr:"Lokacin sallah ta yamma ya yi. Ku zo mu yi sallah.",maghrib:"Lokacin sallah ta magariba ya yi. Ku zo mu yi sallah.",isha:"Lokacin sallah ta dare ya yi. Ku zo mu yi sallah."},twi:{fajr:"AnÉ”pa mpaebÉ” berÉ› aso. Mommra yÉ›n kÉ” bÉ” mpae.",dhuhr:"Awia mpaebÉ” berÉ› aso. Mommra yÉ›n kÉ” bÉ” mpae.",asr:"Anwummere mpaebÉ” berÉ› aso. Mommra yÉ›n kÉ” bÉ” mpae.",maghrib:"Anwummere mpaebÉ” berÉ› aso. Mommra yÉ›n kÉ” bÉ” mpae.",isha:"Anadwo mpaebÉ” berÉ› aso. Mommra yÉ›n kÉ” bÉ” mpae."}})[e]?.[a.toLowerCase()]||`Time for ${a} prayer. Come and pray.`}validatePrayerCall(e){let a=[],t=[];return e.combined.trim()||a.push("Prayer call content is empty"),e.metadata.components.includes("prayer-call")||t.push("Prayer call does not include traditional prayer phrases"),e.metadata.components.includes("time-announcement")||t.push("Prayer call does not include time announcement"),e.arabic&&!this.containsArabicText(e.arabic)&&t.push("Arabic content may not contain proper Arabic text"),e.combined.length>1e3&&t.push("Prayer call content is very long and may affect voice generation quality"),{valid:0===a.length,errors:a,warnings:t}}containsArabicText(e){return/[\u0600-\u06FF]/.test(e)}getContentStatistics(e){let a=e.combined.split(/\s+/).filter(e=>e.length>0);return{totalLength:e.combined.length,arabicLength:e.arabic.length,englishLength:e.english.length,wordCount:a.length,estimatedDuration:Math.ceil(.6*a.length),components:e.metadata.components}}}let n=null,r=()=>(n||(n=new t),n);e.s(["PrayerCallGenerator",()=>t,"generateSchoolPrayerCall",0,(e,a=!0)=>r().generateSchoolPrayerCall(e,{isSchoolHours:a,hasStudents:!0,location:"prayer area"}).combined,"generateSimplePrayerCall",0,e=>r().generatePrayerCall(e,{voiceStyle:"simple",includeArabic:!1,includeTransliteration:!1,includeEnglish:!0}).combined,"generateTraditionalPrayerCall",0,e=>r().generatePrayerCall(e,{voiceStyle:"traditional",includeBasmala:!0,includeTakbir:!0}).combined,"getPrayerCallGenerator",0,r])},37188,44241,45145,e=>{"use strict";var a=e.i(10480);e.s(["VOICE_OPTIONS",()=>g,"generateAIVoice",()=>A,"getTTSStatus",()=>T,"playAnnouncement",()=>E,"playAudioBuffer",()=>f,"playAzanCall",()=>C,"playBrowserTTS",()=>v,"playTextToSpeech",()=>w,"translateMessage",()=>S],44241);class t extends Error{provider;code;retryable;constructor(e,a,t,n=!1){super(e),this.provider=a,this.code=t,this.retryable=n,this.name="AIVoiceError"}}class n extends t{constructor(e,a){super(`Rate limit exceeded for ${e}`,e,"RATE_LIMIT",!0),this.retryAfter=a}retryAfter}class r extends t{constructor(e){super(`Authentication failed for ${e}`,e,"AUTH_FAILED",!1)}}class i extends t{constructor(e){super(`Service unavailable for ${e}`,e,"SERVICE_UNAVAILABLE",!0)}}var s=e.i(92418);class o{name="OpenAI TTS";apiKey;baseUrl="https://api.openai.com/v1";constructor(e){this.apiKey=e}async generateSpeech(e,a){if(!this.apiKey)throw new r("OpenAI");let n={model:"tts-1",input:e,voice:this.mapVoiceId(a.voice),response_format:"mp3",speed:Math.max(.25,Math.min(4,a.speed))};try{let e=await fetch(`${this.baseUrl}/audio/speech`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify(n)});e.ok||await this.handleErrorResponse(e);let a=await e.arrayBuffer();return await this.convertMp3ToAudioBuffer(a)}catch(e){if(e instanceof t)throw e;throw new i("OpenAI")}}async getAvailableVoices(){return[{id:"openai-alloy",name:"Alloy",language:"english",gender:"neutral",category:"standard",provider:"openai"},{id:"openai-echo",name:"Echo",language:"english",gender:"male",category:"announcement",provider:"openai"},{id:"openai-fable",name:"Fable",language:"english",gender:"neutral",category:"standard",provider:"openai"},{id:"openai-onyx",name:"Onyx",language:"english",gender:"male",category:"announcement",provider:"openai"},{id:"openai-nova",name:"Nova",language:"english",gender:"female",category:"standard",provider:"openai"},{id:"openai-shimmer",name:"Shimmer",language:"english",gender:"female",category:"announcement",provider:"openai"}]}async validateCredentials(){if(!this.apiKey)return!1;try{let e=await fetch(`${this.baseUrl}/audio/speech`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:"tts-1",input:"test",voice:"alloy",response_format:"mp3"})});return e.ok||400===e.status}catch(e){return!1}}estimateCost(e,a){return e.length/1e3*s.PROVIDER_COSTS.openai}mapVoiceId(e){return({"openai-alloy":"alloy","openai-echo":"echo","openai-fable":"fable","openai-onyx":"onyx","openai-nova":"nova","openai-shimmer":"shimmer"})[e]||"alloy"}async handleErrorResponse(e){let a=await e.text(),s={};try{s=JSON.parse(a)}catch{}switch(e.status){case 401:throw new r("OpenAI");case 429:let o=e.headers.get("retry-after");throw new n("OpenAI",o?parseInt(o):void 0);case 500:case 502:case 503:case 504:throw new i("OpenAI");default:throw new t(s.error?.message||`OpenAI API error: ${e.status}`,"OpenAI",`HTTP_${e.status}`,e.status>=500)}}async convertMp3ToAudioBuffer(e){let a=new(window.AudioContext||window.webkitAudioContext);try{return await a.decodeAudioData(e.slice(0))}catch(e){throw new t("Failed to decode audio data from OpenAI","OpenAI","DECODE_ERROR",!1)}}isLanguageSupported(e){return["english","spanish","french","german","italian","portuguese","russian","japanese","korean","chinese","arabic","hindi","dutch"].includes(e.toLowerCase())}getMaxCharacters(){return 4096}getSupportedFormats(){return["mp3","opus","aac","flac"]}updateApiKey(e){this.apiKey=e}getApiKeyMask(){return this.apiKey?this.apiKey.substring(0,7)+"..."+this.apiKey.substring(this.apiKey.length-4):""}}class l{name="ElevenLabs";apiKey;baseUrl="https://api.elevenlabs.io/v1";constructor(e){this.apiKey=e}async generateSpeech(e,a){if(!this.apiKey)throw new r("ElevenLabs");let n=this.mapVoiceId(a.voice),s={text:e,model_id:"eleven_monolingual_v1",voice_settings:{stability:a.stability||.5,similarity_boost:a.clarity||.75,style:0,use_speaker_boost:!0}};try{let e=await fetch(`${this.baseUrl}/text-to-speech/${n}`,{method:"POST",headers:{Accept:"audio/mpeg","Content-Type":"application/json","xi-api-key":this.apiKey},body:JSON.stringify(s)});e.ok||await this.handleErrorResponse(e);let a=await e.arrayBuffer();return await this.convertMp3ToAudioBuffer(a)}catch(e){if(e instanceof t)throw e;throw new i("ElevenLabs")}}async getAvailableVoices(){if(!this.apiKey)return this.getDefaultVoices();try{let e=await fetch(`${this.baseUrl}/voices`,{headers:{"xi-api-key":this.apiKey}});if(!e.ok)return this.getDefaultVoices();let a=await e.json();return this.mapElevenLabsVoices(a.voices||[])}catch(e){return this.getDefaultVoices()}}async validateCredentials(){if(!this.apiKey)return!1;try{return(await fetch(`${this.baseUrl}/user`,{headers:{"xi-api-key":this.apiKey}})).ok}catch(e){return!1}}estimateCost(e,a){return e.length/1e3*s.PROVIDER_COSTS.elevenlabs}getDefaultVoices(){return[{id:"elevenlabs-rachel",name:"Rachel",language:"english",gender:"female",accent:"american",category:"standard",provider:"elevenlabs"},{id:"elevenlabs-drew",name:"Drew",language:"english",gender:"male",accent:"american",category:"announcement",provider:"elevenlabs"},{id:"elevenlabs-clyde",name:"Clyde",language:"english",gender:"male",accent:"american",category:"standard",provider:"elevenlabs"},{id:"elevenlabs-paul",name:"Paul",language:"english",gender:"male",accent:"american",category:"announcement",provider:"elevenlabs"},{id:"elevenlabs-domi",name:"Domi",language:"english",gender:"female",accent:"american",category:"standard",provider:"elevenlabs"},{id:"elevenlabs-dave",name:"Dave",language:"english",gender:"male",accent:"british",category:"announcement",provider:"elevenlabs"}]}mapElevenLabsVoices(e){return e.map(e=>({id:`elevenlabs-${e.voice_id}`,name:e.name,language:this.detectLanguage(e.labels||{}),gender:this.detectGender(e.labels||{}),accent:this.detectAccent(e.labels||{}),category:this.detectCategory(e.labels||{}),provider:"elevenlabs",previewUrl:e.preview_url}))}detectLanguage(e){return(e.language||e.accent||"english").toLowerCase()}detectGender(e){let a=e.gender||e.sex||"";return a.toLowerCase().includes("male")?"male":a.toLowerCase().includes("female")?"female":"neutral"}detectAccent(e){return e.accent||e.region||void 0}detectCategory(e){let a=(e.description||"").toLowerCase(),t=(e.use_case||"").toLowerCase();return a.includes("announcement")||t.includes("announcement")?"announcement":a.includes("religious")||t.includes("religious")?"religious":a.includes("bell")||t.includes("bell")?"bell":"standard"}mapVoiceId(e){return 20!==e.length||e.includes("-")?({"elevenlabs-rachel":"21m00Tcm4TlvDq8ikWAM","elevenlabs-drew":"29vD33N1CtxCmqQRPOHJ","elevenlabs-clyde":"2EiwWnXFnvU5JabPnv8n","elevenlabs-paul":"5Q0t7uMcjvnagumLfvZi","elevenlabs-domi":"AZnzlk1XvdvUeBnXmlld","elevenlabs-dave":"CYw3kZ02Hs0563khs1Fj"})[e]||"21m00Tcm4TlvDq8ikWAM":e}async handleErrorResponse(e){let a=await e.text(),s={};try{s=JSON.parse(a)}catch{}switch(e.status){case 401:throw new r("ElevenLabs");case 429:let o=e.headers.get("retry-after");throw new n("ElevenLabs",o?parseInt(o):void 0);case 500:case 502:case 503:case 504:throw new i("ElevenLabs");default:throw new t(s.detail?.message||s.message||`ElevenLabs API error: ${e.status}`,"ElevenLabs",`HTTP_${e.status}`,e.status>=500)}}async convertMp3ToAudioBuffer(e){let a=new(window.AudioContext||window.webkitAudioContext);try{return await a.decodeAudioData(e.slice(0))}catch(e){throw new t("Failed to decode audio data from ElevenLabs","ElevenLabs","DECODE_ERROR",!1)}}isLanguageSupported(e){return["english","spanish","french","german","italian","portuguese","polish","hindi","arabic","japanese","korean","chinese"].includes(e.toLowerCase())}getMaxCharacters(){return 5e3}getSupportedFormats(){return["mp3","wav","ogg"]}updateApiKey(e){this.apiKey=e}getApiKeyMask(){return this.apiKey?this.apiKey.substring(0,7)+"..."+this.apiKey.substring(this.apiKey.length-4):""}async getVoiceSettings(e){if(!this.apiKey)throw new r("ElevenLabs");try{let a=await fetch(`${this.baseUrl}/voices/${e}/settings`,{headers:{"xi-api-key":this.apiKey}});if(!a.ok)throw new t("Failed to get voice settings","ElevenLabs","SETTINGS_ERROR",!1);return await a.json()}catch(e){if(e instanceof t)throw e;throw new i("ElevenLabs")}}async getUserInfo(){if(!this.apiKey)throw new r("ElevenLabs");try{let e=await fetch(`${this.baseUrl}/user`,{headers:{"xi-api-key":this.apiKey}});if(!e.ok)throw new t("Failed to get user info","ElevenLabs","USER_INFO_ERROR",!1);return await e.json()}catch(e){if(e instanceof t)throw e;throw new i("ElevenLabs")}}}class c{name="Azure Cognitive Services";apiKey;region;baseUrl;constructor(e,a){if(this.apiKey=e,a){const e=a.match(/https:\/\/([^.]+)\.tts\.speech\.microsoft\.com/);this.region=e?e[1]:"eastus",this.baseUrl=a}else this.region="eastus",this.baseUrl=`https://${this.region}.tts.speech.microsoft.com`}async generateSpeech(e,a){if(!this.apiKey)throw new r("Azure");let n=await this.getAccessToken(),s=this.mapVoiceId(a.voice),o=this.generateSSML(e,s,a);try{let e=await fetch(`${this.baseUrl}/cognitiveservices/v1`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/ssml+xml","X-Microsoft-OutputFormat":"audio-16khz-128kbitrate-mono-mp3","User-Agent":"SchoolBellSystem"},body:o});e.ok||await this.handleErrorResponse(e);let a=await e.arrayBuffer();return await this.convertMp3ToAudioBuffer(a)}catch(e){if(e instanceof t)throw e;throw new i("Azure")}}async getAvailableVoices(){if(!this.apiKey)return this.getDefaultVoices();try{let e=await this.getAccessToken(),a=await fetch(`${this.baseUrl}/cognitiveservices/voices/list`,{headers:{Authorization:`Bearer ${e}`}});if(!a.ok)return this.getDefaultVoices();let t=await a.json();return this.mapAzureVoices(t)}catch(e){return this.getDefaultVoices()}}async validateCredentials(){if(!this.apiKey)return!1;try{return!!await this.getAccessToken()}catch(e){return!1}}estimateCost(e,a){return e.length/1e3*s.PROVIDER_COSTS.azure}async getAccessToken(){let e=`https://${this.region}.api.cognitive.microsoft.com/sts/v1.0/issueToken`;try{let a=await fetch(e,{method:"POST",headers:{"Ocp-Apim-Subscription-Key":this.apiKey,"Content-Type":"application/x-www-form-urlencoded"},body:""});if(!a.ok){if(401===a.status||403===a.status)throw new r("Azure");throw new i("Azure")}return await a.text()}catch(e){if(e instanceof t)throw e;throw new i("Azure")}}generateSSML(e,a,t){let n=this.mapSpeedToRate(t.speed),r=this.mapPitchToSSML(t.pitch);return`
      <speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="${a.locale}">
        <voice name="${a.name}">
          <prosody rate="${n}" pitch="${r}">
            ${this.escapeXML(e)}
          </prosody>
        </voice>
      </speak>
    `.trim()}mapSpeedToRate(e){return e<=.5?"x-slow":e<=.75?"slow":e<=1.25?"medium":e<=1.5?"fast":"x-fast"}mapPitchToSSML(e){return e<=.75?"low":e<=1.25?"medium":"high"}escapeXML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}getDefaultVoices(){return[{id:"azure-jenny",name:"Jenny",language:"english",gender:"female",accent:"american",category:"standard",provider:"azure"},{id:"azure-guy",name:"Guy",language:"english",gender:"male",accent:"american",category:"announcement",provider:"azure"},{id:"azure-aria",name:"Aria",language:"english",gender:"female",accent:"american",category:"announcement",provider:"azure"},{id:"azure-davis",name:"Davis",language:"english",gender:"male",accent:"american",category:"standard",provider:"azure"},{id:"azure-jane",name:"Jane",language:"english",gender:"female",accent:"american",category:"standard",provider:"azure"},{id:"azure-jason",name:"Jason",language:"english",gender:"male",accent:"american",category:"announcement",provider:"azure"}]}mapAzureVoices(e){return e.filter(e=>"Neural"===e.VoiceType).map(e=>({id:`azure-${e.ShortName.toLowerCase().replace(/[^a-z0-9]/g,"-")}`,name:e.DisplayName,language:this.mapLocaleToLanguage(e.Locale),gender:e.Gender.toLowerCase(),accent:this.extractAccent(e.LocaleName),category:this.categorizeVoice(e.StyleList||[]),provider:"azure"})).slice(0,20)}mapLocaleToLanguage(e){return({"en-US":"english","en-GB":"english","en-AU":"english","en-CA":"english","es-ES":"spanish","es-MX":"spanish","fr-FR":"french","fr-CA":"french","de-DE":"german","it-IT":"italian","pt-BR":"portuguese","pt-PT":"portuguese","ru-RU":"russian","ja-JP":"japanese","ko-KR":"korean","zh-CN":"chinese","ar-SA":"arabic","hi-IN":"hindi","nl-NL":"dutch","sv-SE":"swedish"})[e]||"english"}extractAccent(e){return e.includes("United States")?"american":e.includes("United Kingdom")?"british":e.includes("Australia")?"australian":e.includes("Canada")?"canadian":void 0}categorizeVoice(e){let a=e.join(" ").toLowerCase();return a.includes("newscast")||a.includes("announcement")?"announcement":a.includes("religious")||a.includes("prayer")?"religious":"standard"}mapVoiceId(e){return({"azure-jenny":{name:"en-US-JennyNeural",locale:"en-US"},"azure-guy":{name:"en-US-GuyNeural",locale:"en-US"},"azure-aria":{name:"en-US-AriaNeural",locale:"en-US"},"azure-davis":{name:"en-US-DavisNeural",locale:"en-US"},"azure-jane":{name:"en-US-JaneNeural",locale:"en-US"},"azure-jason":{name:"en-US-JasonNeural",locale:"en-US"}})[e]||{name:"en-US-JennyNeural",locale:"en-US"}}async handleErrorResponse(e){let a=await e.text(),s={};try{s=JSON.parse(a)}catch{}switch(e.status){case 401:case 403:throw new r("Azure");case 429:let o=e.headers.get("retry-after");throw new n("Azure",o?parseInt(o):void 0);case 500:case 502:case 503:case 504:throw new i("Azure");default:throw new t(s.error?.message||`Azure API error: ${e.status}`,"Azure",`HTTP_${e.status}`,e.status>=500)}}async convertMp3ToAudioBuffer(e){let a=new(window.AudioContext||window.webkitAudioContext);try{return await a.decodeAudioData(e.slice(0))}catch(e){throw new t("Failed to decode audio data from Azure","Azure","DECODE_ERROR",!1)}}isLanguageSupported(e){return["english","spanish","french","german","italian","portuguese","russian","japanese","korean","chinese","arabic","hindi","dutch","swedish","norwegian","danish","finnish"].includes(e.toLowerCase())}getMaxCharacters(){return 1e4}getSupportedFormats(){return["mp3","wav","ogg","webm"]}updateCredentials(e,a){if(this.apiKey=e,a){let e=a.match(/https:\/\/([^.]+)\.tts\.speech\.microsoft\.com/);this.region=e?e[1]:"eastus",this.baseUrl=a}}getApiKeyMask(){return this.apiKey?this.apiKey.substring(0,7)+"..."+this.apiKey.substring(this.apiKey.length-4):""}getRegion(){return this.region}async getVoiceStyles(e){return["default","newscast","customerservice","chat","cheerful","empathetic"]}async getSpeechSynthesisMarkup(e,a,t){let n=t?.rate||"medium",r=t?.pitch||"medium",i=t?.volume||"medium",s=t?.style||"default";return`
      <speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xml:lang="en-US">
        <voice name="${a}">
          <mstts:express-as style="${s}">
            <prosody rate="${n}" pitch="${r}" volume="${i}">
              ${this.escapeXML(e)}
            </prosody>
          </mstts:express-as>
        </voice>
      </speak>
    `.trim()}}class u{static providers=new Map;static createProvider(e,a){let t,n=`${e}-${a.apiKey.substring(0,8)}`;if(this.providers.has(n))return this.providers.get(n);switch(e){case"openai":t=new o(a.apiKey);break;case"elevenlabs":t=new l(a.apiKey);break;case"azure":t=new c(a.apiKey,a.endpoint);break;default:throw Error(`Unknown provider type: ${e}`)}return this.providers.set(n,t),t}static getProvider(e,a){let t=`${e}-${a.apiKey.substring(0,8)}`;return this.providers.get(t)||null}static removeProvider(e,a){let t=`${e}-${a.apiKey.substring(0,8)}`;this.providers.delete(t)}static clearAllProviders(){this.providers.clear()}static getActiveProviders(){let e=[];for(let[a,t]of this.providers.entries()){let n=a.split("-")[0];e.push({type:n,provider:t})}return e}static async validateAllProviders(){let e={};for(let[a,t]of this.providers.entries())try{e[a]=await t.validateCredentials()}catch(t){e[a]=!1}return e}static getSupportedProviders(){return["openai","elevenlabs","azure"]}static isProviderSupported(e){return this.getSupportedProviders().includes(e)}}class h{limits=new Map;state=new Map;queues=new Map;processing=new Map;MINUTE_MS=6e4;DAY_MS=864e5;MAX_QUEUE_SIZE=100;MAX_RETRY_COUNT=3;RETRY_DELAY_BASE=1e3;constructor(){this.startQueueProcessor()}updateProviderLimits(e,a){this.limits.set(e,a),this.state.has(e)||this.state.set(e,{requests:[],characters:[],lastReset:Date.now()}),this.queues.has(e)||this.queues.set(e,[]),this.processing.has(e)||this.processing.set(e,!1)}async executeWithRateLimit(e,a,t){return new Promise((n,r)=>{let i={id:a.id,request:a,resolve:n,reject:r,timestamp:Date.now(),retryCount:0};this.enqueueRequest(e,i,t)})}enqueueRequest(e,a,t){let n=this.queues.get(e);n?n.length>=this.MAX_QUEUE_SIZE?a.reject(Error(`Queue full for provider ${e}`)):(a.executor=t,"high"===a.request.priority?n.unshift(a):n.push(a),this.processQueue(e)):a.reject(Error(`Provider ${e} not configured`))}async processQueue(e){if(this.processing.get(e))return;this.processing.set(e,!0);let a=this.queues.get(e);if(!a)return void this.processing.set(e,!1);for(;a.length>0;){let t=a.shift();try{if(Date.now()-t.timestamp>3e5){t.reject(Error("Request expired"));continue}await this.waitForRateLimit(e,t.request);let a=t.executor,n=await a();this.recordRequest(e,t.request),t.resolve(n)}catch(e){t.retryCount<this.MAX_RETRY_COUNT&&this.isRetryableError(e)?(t.retryCount++,setTimeout(()=>{a.push(t)},this.RETRY_DELAY_BASE*Math.pow(2,t.retryCount-1))):t.reject(e)}}this.processing.set(e,!1)}async waitForRateLimit(e,a){if(this.limits.get(e))for(;;){if(this.canMakeRequest(e,a))return;await this.sleep(1e3)}}canMakeRequest(e,a){let t=this.limits.get(e),n=this.state.get(e);if(!t||!n)return!0;let r=Date.now();return this.cleanupOldEntries(n,r),!(n.requests.length>=t.requestsPerMinute||n.characters.reduce((e,a)=>e+a,0)+a.text.length>t.charactersPerDay)}cleanupOldEntries(e,a){let t=a-this.MINUTE_MS;e.requests=e.requests.filter(e=>e>t),a-e.lastReset>this.DAY_MS&&(e.characters=[],e.lastReset=a)}recordRequest(e,a){let t=this.state.get(e);if(!t)return;let n=Date.now();t.requests.push(n),t.characters.push(a.text.length)}isRetryableError(e){return e?.code==="RATE_LIMIT"||e?.code==="SERVICE_UNAVAILABLE"||e?.retryable===!0}sleep(e){return new Promise(a=>setTimeout(a,e))}startQueueProcessor(){setInterval(()=>{for(let e of this.queues.keys())this.processing.get(e)||this.processQueue(e)},1e3)}getQueueStatus(){let e={};for(let[a,t]of this.queues.entries()){let n=t.length>0?t[0].timestamp:void 0;e[a]={queueLength:t.length,processing:this.processing.get(a)||!1,oldestRequest:n}}return e}getRateLimitStatus(){let e={};for(let[a,t]of this.state.entries()){let n=this.limits.get(a);if(!n)continue;let r=Date.now();this.cleanupOldEntries(t,r);let i=t.requests.length,s=t.characters.reduce((e,a)=>e+a,0),o=Math.max(i/n.requestsPerMinute*100,s/n.charactersPerDay*100);e[a]={requestsInLastMinute:i,charactersToday:s,requestsPerMinuteLimit:n.requestsPerMinute,charactersPerDayLimit:n.charactersPerDay,utilizationPercent:Math.round(o)}}return e}clearQueue(e){let a=this.queues.get(e);if(a){for(let e of a)e.reject(Error("Queue cleared"));a.length=0}}clearAllQueues(){for(let e of this.queues.keys())this.clearQueue(e)}getEstimatedWaitTime(e){let a=this.queues.get(e),t=this.limits.get(e);return a&&t&&0!==a.length?Math.ceil(a.length/t.requestsPerMinute*60):0}}class m{defaultOptions={maxRetries:2,retryDelay:1e3,preferAI:!0,fallbackToTTS:!0,logErrors:!0};async playWithFallback(e,a,t="english",n="general",r){let i,s={...this.defaultOptions,...r},o=Date.now(),l=0;for(let r of this.getPlaybackStrategies(s))for(let c=0;c<=s.maxRetries;c++)try{if(await this.executeStrategy(r,e,a,t,n)){let e=Date.now()-o;return{success:!0,method:r,provider:"ai"===r?await this.getActiveProvider(n):void 0,retries:c,duration:e}}}catch(e){i=e instanceof Error?e.message:"Unknown error",l=c+1,s.logErrors&&console.warn(`[VoiceFallback] ${r} attempt ${c+1} failed:`,i),c<s.maxRetries&&await this.sleep(s.retryDelay*(c+1))}return{success:!1,method:"none",error:i||"All playback methods failed",retries:l,duration:Date.now()-o}}getPlaybackStrategies(e){let a=[];return e.preferAI?(a.push("ai"),a.push("network-tts"),e.fallbackToTTS&&a.push("tts")):(a.push("network-tts"),a.push("tts"),e.preferAI&&a.push("ai")),a}async executeStrategy(e,a,t,n,r){switch(e){case"ai":return await this.tryAIVoice(a,r,{voice:t,language:n});case"network-tts":return await this.tryNetworkTTS(a,n);case"tts":return await this.tryBrowserTTS(a,t,n);default:throw Error(`Unknown strategy: ${e}`)}}async tryNetworkTTS(e,a){return console.log("[VoiceFallback] Network TTS not available, using browser TTS"),await this.tryBrowserTTS(e,"standard-male",a)}async tryAIVoice(e,a,n){!0;throw new t("AI voice service not available","System","SERVICE_UNAVAILABLE",!1)}async tryBrowserTTS(e,a,t){if(!("speechSynthesis"in window)||!window.speechSynthesis)throw Error("Browser TTS not available");if(!await v(e,a,t))throw Error("Browser TTS playback failed");return!0}async getActiveProvider(e){!0}sleep(e){return new Promise(a=>setTimeout(a,e))}async checkSystemHealth(){let e=await this.checkAIVoiceHealth(),a=this.checkTTSHealth(),t="none";return e.available&&a.available?t="both":e.available?t="ai":a.available&&(t="tts"),{ai:e,tts:a,recommendation:t}}async checkAIVoiceHealth(){try{!0;return{available:!1,providers:[],error:"AI voice service not initialized"}}catch(e){return{available:!1,providers:[],error:e instanceof Error?e.message:"Unknown error"}}}checkTTSHealth(){return"speechSynthesis"in window?window.speechSynthesis?{available:!0}:{available:!1,error:"Speech Synthesis API not available"}:{available:!1,error:"Speech Synthesis API not supported"}}async measurePerformance(e,a,t,n,r=3){let i=[],s=[];for(let s=0;s<r;s++){let r=Date.now();try{await this.tryAIVoice(e,n,{voice:a,language:t}),i.push({time:Date.now()-r,success:!0})}catch(e){i.push({time:Date.now()-r,success:!1,error:e instanceof Error?e.message:"Unknown error"})}await this.sleep(500)}for(let n=0;n<r;n++){let n=Date.now();try{await this.tryBrowserTTS(e,a,t),s.push({time:Date.now()-n,success:!0})}catch(e){s.push({time:Date.now()-n,success:!1,error:e instanceof Error?e.message:"Unknown error"})}await this.sleep(500)}return{ai:{avgTime:i.reduce((e,a)=>e+a.time,0)/i.length,successRate:i.filter(e=>e.success).length/i.length*100,errors:i.filter(e=>!e.success).map(e=>e.error||"Unknown")},tts:{avgTime:s.reduce((e,a)=>e+a.time,0)/s.length,successRate:s.filter(e=>e.success).length/s.length*100,errors:s.filter(e=>!e.success).map(e=>e.error||"Unknown")}}}}let d=null,p=()=>(d||(d=new m),d),g={"standard-male":{name:"Standard Male",language:"english",description:"Clear English voice"},"standard-female":{name:"Standard Female",language:"english",description:"Clear English voice"},"azan-islamic":{name:"Islamic Azan",language:"arabic",description:"Islamic prayer call (Azan)"},hausa:{name:"Hausa",language:"hausa",description:"Native Hausa speaker"},twi:{name:"Twi",language:"twi",description:"Native Twi speaker"},arabic:{name:"Arabic",language:"arabic",description:"Native Arabic speaker"},"openai-alloy":{name:"OpenAI Alloy",language:"english",description:"Neutral, balanced voice"},"openai-echo":{name:"OpenAI Echo",language:"english",description:"Warm, rounded male voice"},"openai-fable":{name:"OpenAI Fable",language:"english",description:"British accent, storytelling voice"},"openai-onyx":{name:"OpenAI Onyx",language:"english",description:"Deep, authoritative male voice"},"openai-nova":{name:"OpenAI Nova",language:"english",description:"Energetic female voice"},"openai-shimmer":{name:"OpenAI Shimmer",language:"english",description:"Clear, bright female voice"},"elevenlabs-rachel":{name:"ElevenLabs Rachel",language:"english",description:"American female, narrative"},"elevenlabs-drew":{name:"ElevenLabs Drew",language:"english",description:"American male, news"},"elevenlabs-clyde":{name:"ElevenLabs Clyde",language:"english",description:"American male, deep"},"elevenlabs-paul":{name:"ElevenLabs Paul",language:"english",description:"American male, soft"},"azure-jenny":{name:"Azure Jenny",language:"english",description:"American female, conversational"},"azure-guy":{name:"Azure Guy",language:"english",description:"American male, conversational"},"azure-aria":{name:"Azure Aria",language:"english",description:"American female, helpful"},"azure-davis":{name:"Azure Davis",language:"english",description:"American male, casual"}},y={"standard-male":{pitch:.7,rate:.95,volume:1},"standard-female":{pitch:1.4,rate:1.05,volume:1},"azan-islamic":{pitch:1.3,rate:.75,volume:1},hausa:{pitch:1.15,rate:.9,volume:1},twi:{pitch:1.1,rate:.9,volume:1},arabic:{pitch:1.25,rate:.85,volume:1},"openai-alloy":{pitch:1,rate:1,volume:1},"openai-echo":{pitch:.85,rate:.95,volume:1},"openai-fable":{pitch:1.1,rate:1.05,volume:1},"openai-onyx":{pitch:.7,rate:.9,volume:1},"openai-nova":{pitch:1.3,rate:1.1,volume:1},"openai-shimmer":{pitch:1.35,rate:1.05,volume:1},"elevenlabs-rachel":{pitch:1.25,rate:1,volume:1},"elevenlabs-drew":{pitch:.9,rate:1,volume:1},"elevenlabs-clyde":{pitch:.75,rate:.95,volume:1},"elevenlabs-paul":{pitch:.95,rate:.9,volume:1},"azure-jenny":{pitch:1.3,rate:1.05,volume:1},"azure-guy":{pitch:.8,rate:.95,volume:1},"azure-aria":{pitch:1.35,rate:1.1,volume:1},"azure-davis":{pitch:.85,rate:.9,volume:1}},w=async(a,t,n="english",r)=>{let{useStore:i}=await e.A(48874),s=i.getState().settings,o=r??s.defaultRepeatCount??1;console.log(`[v0] Playing text ${o} time(s): "${a.substring(0,50)}..."`);let l=!0;for(let e=0;e<o;e++){console.log(`[v0] Playing repetition ${e+1} of ${o}`);let r=p();(await r.playWithFallback(a,t,n,"general",{maxRetries:1,retryDelay:500,preferAI:!0,fallbackToTTS:!0,logErrors:!1})).success||(l=!1,console.error(`[v0] Repetition ${e+1} failed`)),e<o-1&&await new Promise(e=>setTimeout(e,1e3))}return console.log(`[v0] Completed ${o} repetitions. Success: ${l}`),l},A=async(e,a="general",n)=>{try{!0;return null}catch(e){return e instanceof t?console.error("[v0] AI Voice Error:",e.message,"Provider:",e.provider):console.error("[v0] AI voice generation failed:",e),null}},f=async e=>new Promise((a,t)=>{try{let n=new(window.AudioContext||window.webkitAudioContext),r=n.createBufferSource();r.buffer=e,r.connect(n.destination),r.onended=()=>{console.log("[v0] AI voice playback finished"),a()};let i=setTimeout(()=>{console.error("[v0] Audio playback timeout"),t(Error("Audio playback timeout"))},1e3*e.duration+5e3);r.onended=()=>{clearTimeout(i),console.log("[v0] AI voice playback finished"),a()},r.start(0),console.log("[v0] AI voice playback started")}catch(e){console.error("[v0] Failed to play audio buffer:",e),t(e)}}),v=async(e,a,t="english")=>{if(!("speechSynthesis"in window))return console.error("[v0] Speech Synthesis not supported in this browser"),!1;if(!window.speechSynthesis)return console.error("[v0] Speech Synthesis API is not available"),!1;let n=window.speechSynthesis.getVoices();return 0===n.length&&await new Promise(e=>{let a=()=>{n=window.speechSynthesis.getVoices(),window.speechSynthesis.removeEventListener("voiceschanged",a),e()};window.speechSynthesis.addEventListener("voiceschanged",a),setTimeout(e,1e3)}),new Promise(r=>{try{let i;window.speechSynthesis.speaking||window.speechSynthesis.cancel();let s=new SpeechSynthesisUtterance(e),o=y[a],l=b(t);console.log("[v0] Available Browser Voices:",n.map(e=>`${e.name} (${e.lang})`));let c=(e,a)=>{let t=n.find(a=>a.lang.startsWith(l.split("-")[0])&&e.some(e=>a.name.toLowerCase().includes(e)));if(!t){let e="male"===a?["male","david","james","daniel","mark","george"]:["female","zira","samantha","susan","hazel","heather"];t=n.find(a=>a.lang.startsWith(l.split("-")[0])&&e.some(e=>a.name.toLowerCase().includes(e)))}return t};"openai-onyx"===a||"openai-echo"===a||"standard-male"===a||"azure-guy"===a||"azure-davis"===a||"elevenlabs-clyde"===a||"elevenlabs-drew"===a||"elevenlabs-paul"===a?i=c(["male","david","james","daniel"],"male"):("openai-nova"===a||"openai-shimmer"===a||"openai-alloy"===a||"standard-female"===a||"azure-jenny"===a||"azure-aria"===a||"elevenlabs-rachel"===a)&&(i=c(["female","zira","samantha","google us english"],"female")),i?(s.voice=i,console.log(`[v0] Selected browser voice: ${i.name}`)):console.log(`[v0] No specific voice match found, using browser default for ${l}`),s.pitch=o.pitch,s.rate=o.rate,s.volume=o.volume,s.lang=l,console.log("[v0] Playing Browser TTS - Text:",e.substring(0,50),"Voice:",a,"Lang:",l),s.onstart=()=>{console.log("[v0] Browser TTS started")},s.onend=()=>{console.log("[v0] Browser TTS finished"),r(!0)},s.onerror=e=>{console.error("[v0] Browser TTS error:",e.error),r(!1)},window.speechSynthesis.speak(s)}catch(e){console.error("[v0] Browser TTS Error:",e),r(!1)}})},b=e=>({english:"en-US",hausa:"ha",twi:"ak",arabic:"ar"})[e]||"en-US",S=(e,a)=>{if("english"===a)return e;let t=e;return Object.entries({english:{},hausa:{"should report to the office":"ya kamata ya je ofis","your parent is waiting at the gate":"mahaifiyar ku tana jira a baje","please come to the staff common room":"zo gida mai aiki da fushi","report to the headteacher's office now":"je ofis mai shugaba yanzu"},twi:{"should report to the office":"forow kye ofis no","your parent is waiting at the gate":"wo/wo maame/papa retua wÉ” apon no","please come to the staff common room":"ba stamfo no","report to the headteacher's office now":"kÉ” ofis osofo mu"},arabic:{"should report to the office":"ÙŠØ¬Ø¨ Ø£Ù† ØªØªÙˆØ¬Ù‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙƒØªØ¨","your parent is waiting at the gate":"ÙˆØ§Ù„Ø¯Ùƒ ÙŠÙ†ØªØ¸Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©","please come to the staff common room":"ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø­Ø¶ÙˆØ± Ø¥Ù„Ù‰ ØºØ±ÙØ© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†","report to the headteacher's office now":"ØªÙˆØ¬Ù‡ Ø¥Ù„Ù‰ Ù…ÙƒØªØ¨ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¢Ù†"}}[a]||{}).forEach(([e,a])=>{t=t.replace(RegExp(e,"gi"),a)}),t},T=()=>"speechSynthesis"in window?window.speechSynthesis?{available:!0,message:"TTS is ready"}:{available:!1,message:"Speech Synthesis API is not available"}:{available:!1,message:"Speech Synthesis not supported in this browser"},E=async(a,t,n,r)=>{let{useStore:i}=await e.A(48874),s=i.getState().settings,o=t||s.defaultVoice,l=n||s.defaultLanguage,c=r??s.defaultRepeatCount??1;console.log(`[v0] Playing announcement ${c} time(s)`);let u=!0;for(let e=0;e<c;e++){console.log(`[v0] Announcement repetition ${e+1} of ${c}`);let t=p();(await t.playWithFallback(a,o,l,"announcement",{maxRetries:2,retryDelay:1e3,preferAI:!0,fallbackToTTS:!0,logErrors:!0})).success||(u=!1,console.error(`[v0] Announcement repetition ${e+1} failed`)),e<c-1&&await new Promise(e=>setTimeout(e,2e3))}return console.log(`[v0] Announcement completed. ${c} repetitions. Success: ${u}`),u},C=async e=>{let a=P(e),t=p(),n=await t.playWithFallback(a,"azan-islamic","arabic","prayer",{maxRetries:2,retryDelay:1e3,preferAI:!0,fallbackToTTS:!0,logErrors:!0});return n.success?console.log(`[v0] Prayer call played successfully using ${n.method} (${n.provider||"browser"})`):console.error(`[v0] Prayer call failed: ${n.error}`),n.success},P=a=>{let{generateSchoolPrayerCall:t}=e.r(62519);return t(a,!0)};var k=e.i(9399);class I{static async playToneAndAnnouncement(e,t={}){let n=k.useStore.getState().settings,{tone:r="bell",voice:i=n.defaultVoice,language:s=n.defaultLanguage,repeatCount:o=n.defaultRepeatCount,delayBetweenToneAndVoice:l=1500,delayBetweenRepeats:c=3e3}=t;console.log(`[CombinedAudio] Playing ${o} time(s): ${r} + "${e}"`);let u=!0;for(let t=0;t<o;t++){console.log(`[CombinedAudio] Repetition ${t+1} of ${o}`);try{console.log(`[CombinedAudio] Playing ${r} tone...`),(0,a.playBellSound)(r),await new Promise(e=>setTimeout(e,l)),console.log(`[CombinedAudio] Playing voice announcement: "${e}"`),await E(e,i,s,1)||(u=!1,console.error(`[CombinedAudio] Voice announcement failed for repetition ${t+1}`)),t<o-1&&(console.log(`[CombinedAudio] Waiting ${c}ms before next repetition...`),await new Promise(e=>setTimeout(e,c)))}catch(e){u=!1,console.error(`[CombinedAudio] Error in repetition ${t+1}:`,e)}}return console.log(`[CombinedAudio] Completed ${o} repetitions. Success: ${u}`),u}static async playClassBell(e,a){return this.playToneAndAnnouncement(e,{tone:"bell",delayBetweenToneAndVoice:2e3,...a})}static async playBreakChime(e,a){return this.playToneAndAnnouncement(e,{tone:"chime",delayBetweenToneAndVoice:1e3,...a})}static async playAnnouncement(e,a){return this.playToneAndAnnouncement(e,{tone:"announcement",delayBetweenToneAndVoice:800,...a})}static async playEmergencyAlert(e,a){return this.playToneAndAnnouncement(e,{tone:"emergency-alert",delayBetweenToneAndVoice:500,repeatCount:3,delayBetweenRepeats:2e3,...a})}static async playHighQualityAnnouncement(e,a){let t=k.useStore.getState().settings,{voice:n="openai-nova",language:r=t.defaultLanguage,repeatCount:i=t.defaultRepeatCount}=a||{};console.log(`[CombinedAudio] Playing high-quality announcement: "${e}"`);let s=!0;for(let a=0;a<i;a++){console.log(`[CombinedAudio] High-quality announcement repetition ${a+1} of ${i}`);try{await E(e,n,r,1)||(s=!1,console.error(`[CombinedAudio] High-quality announcement failed for repetition ${a+1}`)),a<i-1&&await new Promise(e=>setTimeout(e,3e3))}catch(e){s=!1,console.error(`[CombinedAudio] Error in high-quality announcement repetition ${a+1}:`,e)}}return console.log(`[CombinedAudio] High-quality announcement completed. Success: ${s}`),s}static async playNormalAnnouncement(e,a){return this.playToneAndAnnouncement(e,{tone:"announcement",voice:"openai-nova",delayBetweenToneAndVoice:800,...a})}static async playTaskAudio(e,a,t,n){console.log(`[CombinedAudio] Playing task audio for: "${e}" (Type: ${a}, Bell: ${t})`);let r=t||"bell",i=1500,s=e;switch(a.toLowerCase()){case"class":case"lesson":r=t||"bell",i=2e3,s=`Attention all students, it is time for ${e}. Please proceed to your classrooms.`;break;case"break":case"recess":r=t||"chime",i=1e3,s=`Attention all students, it is time for ${e}. You may now leave your classrooms.`;break;case"assembly":case"meeting":r=t||"announcement",i=800,s=`Attention all students and staff, it is time for ${e}. Please proceed to the assembly hall.`;break;case"lunch":case"meal":r=t||"chime",i=1200,s=`Attention all students, it is time for ${e}. Please proceed to the dining hall.`;break;case"dismissal":case"end":r=t||"dismissal-bell",i=2e3,s=`Attention all students, it is time for ${e}. Please collect your belongings and proceed to the exit.`;break;case"emergency":case"drill":r=t||"emergency-alert",i=500,s=`Emergency alert. ${e}. All students and staff must follow emergency procedures immediately.`;break;default:r=t||"bell",s=`Attention all students, it is time for ${e}.`}return this.playToneAndAnnouncement(s,{tone:r,delayBetweenToneAndVoice:i,...n})}static getToneForTaskType(e){switch(e.toLowerCase()){case"class":case"lesson":case"dismissal":default:return"bell";case"break":case"recess":case"lunch":return"chime";case"assembly":case"meeting":case"announcement":return"announcement";case"emergency":case"drill":return"emergency-alert"}}static generateVoiceMessage(e,a){return({class:`Attention all students, it is time for ${e}. Please proceed to your classrooms.`,lesson:`Attention all students, it is time for ${e}. Please proceed to your classrooms.`,break:`Attention all students, it is time for ${e}. You may now leave your classrooms.`,recess:`Attention all students, it is time for ${e}. You may now leave your classrooms.`,lunch:`Attention all students, it is time for ${e}. Please proceed to the dining hall.`,assembly:`Attention all students and staff, it is time for ${e}. Please proceed to the assembly hall.`,meeting:`Attention all students and staff, it is time for ${e}. Please proceed to the designated area.`,announcement:`Attention all students and staff, it is time for ${e}. Please listen carefully.`,dismissal:`Attention all students, it is time for ${e}. Please collect your belongings and proceed to the exit.`,end:`Attention all students, it is time for ${e}. Please collect your belongings and proceed to the exit.`,emergency:`Emergency alert. ${e}. All students and staff must follow emergency procedures immediately.`,drill:`Emergency drill. ${e}. All students and staff must follow drill procedures immediately.`})[a.toLowerCase()]||`Attention all students, it is time for ${e}.`}}let R=(e,a)=>I.playToneAndAnnouncement(e,a),M=(e,a)=>I.playHighQualityAnnouncement(e,a),$=(e,a)=>I.playNormalAnnouncement(e,a);window.CombinedAudioPlayer=I,window.playToneAndAnnouncement=R,window.playTaskAudio=(e,a,t,n)=>I.playTaskAudio(e,a,t,n),window.playHighQualityAnnouncement=M,window.playNormalAnnouncement=$,e.s(["playHighQualityAnnouncement",0,M,"playNormalAnnouncement",0,$,"playToneAndAnnouncement",0,R],45145);class L{static PREMIUM_VOICES={professional:"openai-nova",authoritative:"openai-onyx",friendly:"openai-shimmer",warm:"openai-echo",storytelling:"openai-fable",balanced:"openai-alloy",elevenlabs:"elevenlabs-rachel",azure:"azure-aria"};static async playCustomAnnouncement(e,a={}){let{voice:t=this.PREMIUM_VOICES.professional,language:n="english",repeatCount:r=1,withTone:i=!1}=a;return(console.log(`[HighQuality] Playing custom announcement with ${t}`),console.log(`[HighQuality] Message: "${e}"`),i)?$(e,{voice:t,language:n,repeatCount:r}):M(e,{voice:t,language:n,repeatCount:r})}static async playSchoolAnnouncement(e,a,t={}){let n=`Attention all students and staff. ${e}. ${a}`;return this.playCustomAnnouncement(n,{voice:this.PREMIUM_VOICES.professional,withTone:!0,...t})}static async playEmergencyAnnouncement(e,a,t={}){let n=`Emergency alert. ${e}. ${a}. Please follow all safety procedures immediately.`;return this.playCustomAnnouncement(n,{voice:this.PREMIUM_VOICES.authoritative,withTone:!0,repeatCount:2,...t})}static async playFriendlyAnnouncement(e,a={}){return this.playCustomAnnouncement(e,{voice:this.PREMIUM_VOICES.friendly,withTone:!0,...a})}static async playAdministrativeAnnouncement(e,a={}){return this.playCustomAnnouncement(e,{voice:this.PREMIUM_VOICES.balanced,withTone:!0,...a})}static async testAllPremiumVoices(){for(let[e,a]of(console.log("ðŸŽ¤ Testing All Premium AI Voices"),console.log("=".repeat(50)),Object.entries(this.PREMIUM_VOICES)))console.log(`
ðŸ”Š Testing ${e} voice (${a})`),await this.playCustomAnnouncement("This is a test of the high-quality announcement system.",{voice:a,repeatCount:1,withTone:!1}),await new Promise(e=>setTimeout(e,4e3));console.log("\nâœ… Premium voice testing completed!")}static async demonstrateAnnouncementTypes(){for(let e of(console.log("ðŸ“¢ Demonstrating High-Quality Announcement Types"),console.log("=".repeat(60)),[{type:"School Announcement",func:()=>this.playSchoolAnnouncement("Morning Assembly","All students please proceed to the main hall for our weekly assembly")},{type:"Emergency Announcement",func:()=>this.playEmergencyAnnouncement("Fire drill in progress","Please exit the building using the nearest emergency exit")},{type:"Friendly Announcement",func:()=>this.playFriendlyAnnouncement("Congratulations to our basketball team for winning the championship! Well done everyone!")},{type:"Administrative Announcement",func:()=>this.playAdministrativeAnnouncement("Reminder that parent-teacher conferences are scheduled for next week. Please check your emails for appointment times.")},{type:"Custom High-Quality",func:()=>this.playCustomAnnouncement("This is a demonstration of our premium AI voice system with crystal-clear audio quality.",{voice:this.PREMIUM_VOICES.elevenlabs,withTone:!1})}]))console.log(`
ðŸŽ¯ ${e.type}`),await e.func(),await new Promise(e=>setTimeout(e,6e3));console.log("\nâœ… All announcement type demonstrations completed!")}static async quickHighQualityTest(){console.log("âš¡ Quick High-Quality Voice Test"),await this.playCustomAnnouncement("Attention all students, this is a test of our premium AI voice announcement system. The audio quality should be crystal clear and professional.",{voice:this.PREMIUM_VOICES.professional,withTone:!0,repeatCount:1}),console.log("âœ… Quick test completed!")}static getAvailablePremiumVoices(){return[{name:"Professional",voice:this.PREMIUM_VOICES.professional,description:"Clear, professional female voice"},{name:"Authoritative",voice:this.PREMIUM_VOICES.authoritative,description:"Deep, authoritative male voice"},{name:"Friendly",voice:this.PREMIUM_VOICES.friendly,description:"Bright, friendly female voice"},{name:"Warm",voice:this.PREMIUM_VOICES.warm,description:"Warm, rounded male voice"},{name:"Storytelling",voice:this.PREMIUM_VOICES.storytelling,description:"British accent, engaging voice"},{name:"Balanced",voice:this.PREMIUM_VOICES.balanced,description:"Neutral, balanced voice"},{name:"ElevenLabs Premium",voice:this.PREMIUM_VOICES.elevenlabs,description:"Premium ElevenLabs voice"},{name:"Azure Premium",voice:this.PREMIUM_VOICES.azure,description:"Microsoft Azure premium voice"}]}}let z=(e,a)=>L.playCustomAnnouncement(e,a),V=(e,a,t)=>L.playSchoolAnnouncement(e,a,t),O=(e,a,t)=>L.playEmergencyAnnouncement(e,a,t),U=(e,a)=>L.playFriendlyAnnouncement(e,a),x=(e,a)=>L.playAdministrativeAnnouncement(e,a),_=()=>L.testAllPremiumVoices(),D=()=>L.demonstrateAnnouncementTypes(),B=()=>L.quickHighQualityTest(),K=()=>L.getAvailablePremiumVoices();window.HighQualityAnnouncementSystem=L,window.playCustomAnnouncement=z,window.playSchoolAnnouncement=V,window.playEmergencyAnnouncement=O,window.playFriendlyAnnouncement=U,window.playAdministrativeAnnouncement=x,window.testAllPremiumVoices=_,window.demonstrateAnnouncementTypes=D,window.quickHighQualityTest=B,window.getAvailablePremiumVoices=K,e.s(["HighQualityAnnouncementSystem",()=>L,"demonstrateAnnouncementTypes",0,D,"getAvailablePremiumVoices",0,K,"playAdministrativeAnnouncement",0,x,"playCustomAnnouncement",0,z,"playEmergencyAnnouncement",0,O,"playFriendlyAnnouncement",0,U,"playSchoolAnnouncement",0,V,"quickHighQualityTest",0,B,"testAllPremiumVoices",0,_],37188)}]);