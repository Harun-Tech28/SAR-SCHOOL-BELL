module.exports=[76966,a=>{"use strict";let b,c,d,e;var f,g=a.i(45515);let h=a=>{let b,c=new Set,d=(a,d)=>{let e="function"==typeof a?a(b):a;if(!Object.is(e,b)){let a=b;b=(null!=d?d:"object"!=typeof e||null===e)?e:Object.assign({},b,e),c.forEach(c=>c(b,a))}},e=()=>b,f={setState:d,getState:e,getInitialState:()=>g,subscribe:a=>(c.add(a),()=>c.delete(a))},g=b=a(d,e,f);return f},i=a=>b=>{try{let c=a(b);if(c instanceof Promise)return c;return{then:a=>i(a)(c),catch(a){return this}}}catch(a){return{then(a){return this},catch:b=>i(b)(a)}}};var j=a.i(15206);async function k(a){try{for(let b of(await j.storageManager.clearStore("TIMETABLE"),a))await j.storageManager.saveToIndexedDB("TIMETABLE",b.id,b);console.log(`[Storage Sync] Synced ${a.length} timetables to IndexedDB`)}catch(a){console.error("[Storage Sync] Failed to sync timetables:",a)}}async function l(a){try{for(let b of(await j.storageManager.clearStore("STUDENTS"),a))await j.storageManager.saveToIndexedDB("STUDENTS",b.id,b);console.log(`[Storage Sync] Synced ${a.length} students to IndexedDB`)}catch(a){console.error("[Storage Sync] Failed to sync students:",a)}}let m=(d=(f=(b=a=>({students:[],timetables:[],devices:[],callRequests:[],settings:{defaultVoice:"openai-onyx",defaultLanguage:"english",defaultRepeatCount:1,azanEnabled:!1,prayerTimes:{fajr:"05:30",dhuhr:"12:30",asr:"15:00",maghrib:"17:45",isha:"19:00"},aiVoice:{aiVoiceEnabled:!1,primaryProvider:"openai",fallbackProvider:"azure",voiceProfiles:{announcement:{id:"default-announcement",name:"Professional Announcer",language:"english",gender:"neutral",category:"announcement",provider:"openai"},prayer:{id:"default-prayer",name:"Islamic Prayer Voice",language:"arabic",gender:"male",category:"religious",provider:"openai"},bell:{id:"default-bell",name:"School Bell Voice",language:"english",gender:"neutral",category:"bell",provider:"openai"},general:{id:"default-general",name:"General Purpose Voice",language:"english",gender:"female",category:"standard",provider:"openai"}},cacheSettings:{maxSize:100,maxAge:30,enabled:!0},usageSettings:{monthlyLimit:1e5,costThreshold:50,optimizationEnabled:!0},providerConfigs:{openai:{apiKey:"",enabled:!1,priority:1,rateLimit:{requestsPerMinute:50,charactersPerDay:5e4}},elevenlabs:{apiKey:"",enabled:!1,priority:2,rateLimit:{requestsPerMinute:20,charactersPerDay:2e4}},azure:{apiKey:"",endpoint:"",enabled:!1,priority:3,rateLimit:{requestsPerMinute:100,charactersPerDay:1e5}}}}},addStudent:b=>a(a=>{let c=[...a.students,b];return l(c).catch(console.error),{students:c}}),removeStudent:b=>a(a=>{let c=a.students.filter(a=>a.id!==b);return l(c).catch(console.error),{students:c}}),addTimetable:b=>{console.log("ðŸ”µ Store: addTimetable called with:",b),a(a=>{let c=[...a.timetables,b];return console.log("ðŸ”µ Store: New timetables array:",c),k(c).catch(console.error),{timetables:c}}),console.log("ðŸ”µ Store: addTimetable completed")},removeTimetable:b=>{console.log("ðŸ”µ Store: removeTimetable called with id:",b),a(a=>{let c=a.timetables.filter(a=>a.id!==b);return k(c).catch(console.error),{timetables:c}})},updateTimetable:(b,c)=>{console.log("ðŸ”µ Store: updateTimetable called with id:",b,"updates:",c),a(a=>{let d=a.timetables.map(a=>a.id===b?{...a,...c}:a);return k(d).catch(console.error),{timetables:d}})},addDevice:b=>a(a=>({devices:[...a.devices,b]})),removeDevice:b=>a(a=>({devices:a.devices.filter(a=>a.id!==b)})),addCallRequest:b=>a(a=>({callRequests:[...a.callRequests,b]})),clearCallRequests:()=>a(()=>({callRequests:[]})),updateSettings:b=>a(a=>({settings:{...a.settings,...b}}))}),c={name:"school-bell-storage",onRehydrateStorage:()=>a=>{console.log("ðŸ”„ Store rehydrated from localStorage"),a&&console.log("ðŸ“Š Rehydrated state:",{studentsCount:a.students.length,timetablesCount:a.timetables.length,devicesCount:a.devices.length})}},(a,d,e)=>{let f,g={storage:function(a,b){let c;try{c=a()}catch(a){return}return{getItem:a=>{var b;let d=a=>null===a?null:JSON.parse(a,void 0),e=null!=(b=c.getItem(a))?b:null;return e instanceof Promise?e.then(d):d(e)},setItem:(a,b)=>c.setItem(a,JSON.stringify(b,void 0)),removeItem:a=>c.removeItem(a)}}(()=>localStorage),partialize:a=>a,version:0,merge:(a,b)=>({...b,...a}),...c},h=!1,j=new Set,k=new Set,l=g.storage;if(!l)return b((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${g.name}', the given storage is currently unavailable.`),a(...b)},d,e);let m=()=>{let a=g.partialize({...d()});return l.setItem(g.name,{state:a,version:g.version})},n=e.setState;e.setState=(a,b)=>(n(a,b),m());let o=b((...b)=>(a(...b),m()),d,e);e.getInitialState=()=>o;let p=()=>{var b,c;if(!l)return;h=!1,j.forEach(a=>{var b;return a(null!=(b=d())?b:o)});let e=(null==(c=g.onRehydrateStorage)?void 0:c.call(g,null!=(b=d())?b:o))||void 0;return i(l.getItem.bind(l))(g.name).then(a=>{if(a)if("number"!=typeof a.version||a.version===g.version)return[!1,a.state];else{if(g.migrate){let b=g.migrate(a.state,a.version);return b instanceof Promise?b.then(a=>[!0,a]):[!0,b]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(b=>{var c;let[e,h]=b;if(a(f=g.merge(h,null!=(c=d())?c:o),!0),e)return m()}).then(()=>{null==e||e(f,void 0),f=d(),h=!0,k.forEach(a=>a(f))}).catch(a=>{null==e||e(void 0,a)})};return e.persist={setOptions:a=>{g={...g,...a},a.storage&&(l=a.storage)},clearStorage:()=>{null==l||l.removeItem(g.name)},getOptions:()=>g,rehydrate:()=>p(),hasHydrated:()=>h,onHydrate:a=>(j.add(a),()=>{j.delete(a)}),onFinishHydration:a=>(k.add(a),()=>{k.delete(a)})},g.skipHydration||p(),f||o}))?h(f):h,Object.assign(e=a=>(function(a,b=a=>a){let c=g.default.useSyncExternalStore(a.subscribe,g.default.useCallback(()=>b(a.getState()),[a,b]),g.default.useCallback(()=>b(a.getInitialState()),[a,b]));return g.default.useDebugValue(c),c})(d,a),d),e);a.s(["useStore",0,m],76966)},80858,a=>{"use strict";let b="audioFiles",c=new class{db=null;async init(){if(!this.db)return new Promise((a,c)=>{console.log("[AudioStorage] Opening IndexedDB...");let d=indexedDB.open("SchoolBellAudioDB",1);d.onerror=()=>{console.error("[AudioStorage] DB Open Error:",d.error),c(d.error)},d.onsuccess=()=>{console.log("[AudioStorage] DB Opened Successfully"),this.db=d.result,a()},d.onupgradeneeded=a=>{console.log("[AudioStorage] DB Upgrade Needed");let c=a.target.result;if(!c.objectStoreNames.contains(b)){let a=c.createObjectStore(b,{keyPath:"id"});a.createIndex("category","category",{unique:!1}),a.createIndex("uploadDate","uploadDate",{unique:!1})}}})}async saveAudio(a,c){console.log(`[AudioStorage] Saving audio: ${a.name}, size: ${a.size}, type: ${a.type}`),this.db||await this.init();let d=`audio_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,e=await this.getAudioDuration(a),f={id:d,name:a.name.replace(/\.[^/.]+$/,""),fileName:a.name,fileSize:a.size,duration:e,uploadDate:new Date().toISOString(),mimeType:a.type,category:c},g={...f,audioBlob:a};return new Promise((a,c)=>{let d=this.db.transaction([b],"readwrite").objectStore(b).add(g);d.onsuccess=()=>a(f),d.onerror=()=>c(d.error)})}async getAudio(a){return this.db||await this.init(),new Promise((c,d)=>{let e=this.db.transaction([b],"readonly").objectStore(b).get(a);e.onsuccess=()=>c(e.result||null),e.onerror=()=>d(e.error)})}async listAudios(a){return this.db||await this.init(),new Promise((c,d)=>{let e,f=this.db.transaction([b],"readonly").objectStore(b);(e=a?f.index("category").getAll(a):f.getAll()).onsuccess=()=>{c(e.result.map(a=>{let{audioBlob:b,...c}=a;return c}))},e.onerror=()=>d(e.error)})}async deleteAudio(a){return this.db||await this.init(),new Promise((c,d)=>{let e=this.db.transaction([b],"readwrite").objectStore(b).delete(a);e.onsuccess=()=>c(),e.onerror=()=>d(e.error)})}async exportAll(){this.db||await this.init();let a=await new Promise((a,c)=>{let d=this.db.transaction([b],"readonly").objectStore(b).getAll();d.onsuccess=()=>a(d.result),d.onerror=()=>c(d.error)});return new Blob([JSON.stringify({version:1,audios:await Promise.all(a.map(async a=>{let b=await a.audioBlob.arrayBuffer(),c=this.arrayBufferToBase64(b);return{metadata:{id:a.id,name:a.name,fileName:a.fileName,fileSize:a.fileSize,duration:a.duration,uploadDate:a.uploadDate,mimeType:a.mimeType,category:a.category},audioData:c}}))},null,2)],{type:"application/json"})}async importAll(a){this.db||await this.init();let c=JSON.parse(await a.text());if(1!==c.version||!Array.isArray(c.audios))throw Error("Invalid export file format");let d=0;for(let a of c.audios)try{let c=this.base64ToArrayBuffer(a.audioData),e=new Blob([c],{type:a.metadata.mimeType}),f={...a.metadata,audioBlob:e};await new Promise((a,c)=>{let d=this.db.transaction([b],"readwrite").objectStore(b).put(f);d.onsuccess=()=>a(),d.onerror=()=>c(d.error)}),d++}catch(b){console.error("Failed to import audio:",a.metadata.name,b)}return d}async getAudioDuration(a){return new Promise(b=>{let c=new Audio,d=URL.createObjectURL(a);c.onloadedmetadata=()=>{URL.revokeObjectURL(d),b(c.duration)},c.onerror=()=>{URL.revokeObjectURL(d),b(0)},c.src=d})}arrayBufferToBase64(a){let b=new Uint8Array(a),c="";for(let a=0;a<b.byteLength;a++)c+=String.fromCharCode(b[a]);return btoa(c)}base64ToArrayBuffer(a){let b=atob(a),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);return c.buffer}};async function d(a){try{let b=await c.getAudio(a);if(!b)return console.error("[AudioStorage] Audio not found:",a),!1;let d=URL.createObjectURL(b.audioBlob),e=new Audio(d);return new Promise(a=>{e.onended=()=>{URL.revokeObjectURL(d),a(!0)},e.onerror=()=>{URL.revokeObjectURL(d),a(!1)},e.play().catch(()=>a(!1))})}catch(a){return console.error("[AudioStorage] Playback error:",a),!1}}a.s(["audioStorage",0,c,"playStoredAudio",()=>d])},96649,a=>{a.v(a=>Promise.resolve().then(()=>a(76966)))},58714,a=>{a.v(a=>Promise.resolve().then(()=>a(8878)))},3726,a=>{a.v(a=>Promise.resolve().then(()=>a(82924)))},38077,a=>{a.v(a=>Promise.resolve().then(()=>a(80858)))}];

//# sourceMappingURL=Downloads_school-bell-system_lib_ab18fbc3._.js.map