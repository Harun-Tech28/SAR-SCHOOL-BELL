{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,+MAAO,EAAC,IAAA,sLAAI,EAAC;AACtB"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,gNAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,iNAAI,GAAG;IAE9B,qBACE,uRAAC;QACC,aAAU;QACV,WAAW,IAAA,2JAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/sidebar.tsx"],"sourcesContent":["\"use client\"\n\nimport { Bell, Users, Megaphone, Wifi, FileText, Settings, Phone, Clock } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport { cn } from \"@/lib/utils\"\n\ninterface SidebarProps {\n  currentPage: string\n  setCurrentPage: (page: string) => void\n}\n\nexport function Sidebar({ currentPage, setCurrentPage }: SidebarProps) {\n  const menuItems = [\n    { id: \"dashboard\", label: \"Dashboard\", icon: Bell },\n    { id: \"timetable\", label: \"Timetables\", icon: Clock },\n    { id: \"call-student\", label: \"Call Student\", icon: Phone },\n    { id: \"students\", label: \"Students\", icon: Users },\n    { id: \"announcements\", label: \"Announcements\", icon: Megaphone },\n    { id: \"devices\", label: \"Devices\", icon: Wifi },\n    { id: \"logs\", label: \"Logs & Reports\", icon: FileText },\n    { id: \"settings\", label: \"Settings\", icon: Settings },\n  ]\n\n  return (\n    <aside className=\"w-64 bg-sidebar border-r border-sidebar-border p-6 overflow-y-auto\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-2xl font-bold text-sidebar-foreground\">SchoolBell</h1>\n        <p className=\"text-sm text-sidebar-foreground/60\">Automation System</p>\n      </div>\n\n      <nav className=\"space-y-2\">\n        {menuItems.map((item) => {\n          const Icon = item.icon\n          const isActive = currentPage === item.id\n          return (\n            <Button\n              key={item.id}\n              variant={isActive ? \"default\" : \"ghost\"}\n              className={cn(\n                \"w-full justify-start gap-3\",\n                isActive && \"bg-sidebar-primary text-sidebar-primary-foreground\",\n              )}\n              onClick={() => setCurrentPage(item.id)}\n            >\n              <Icon className=\"w-4 h-4\" />\n              {item.label}\n            </Button>\n          )\n        })}\n      </nav>\n    </aside>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAJA;;;;;AAWO,SAAS,QAAQ,EAAE,WAAW,EAAE,cAAc,EAAgB;IACnE,MAAM,YAAY;QAChB;YAAE,IAAI;YAAa,OAAO;YAAa,MAAM,mPAAI;QAAC;QAClD;YAAE,IAAI;YAAa,OAAO;YAAc,MAAM,sPAAK;QAAC;QACpD;YAAE,IAAI;YAAgB,OAAO;YAAgB,MAAM,sPAAK;QAAC;QACzD;YAAE,IAAI;YAAY,OAAO;YAAY,MAAM,sPAAK;QAAC;QACjD;YAAE,IAAI;YAAiB,OAAO;YAAiB,MAAM,kQAAS;QAAC;QAC/D;YAAE,IAAI;YAAW,OAAO;YAAW,MAAM,mPAAI;QAAC;QAC9C;YAAE,IAAI;YAAQ,OAAO;YAAkB,MAAM,mQAAQ;QAAC;QACtD;YAAE,IAAI;YAAY,OAAO;YAAY,MAAM,+PAAQ;QAAC;KACrD;IAED,qBACE,uRAAC;QAAM,WAAU;;0BACf,uRAAC;gBAAI,WAAU;;kCACb,uRAAC;wBAAG,WAAU;kCAA6C;;;;;;kCAC3D,uRAAC;wBAAE,WAAU;kCAAqC;;;;;;;;;;;;0BAGpD,uRAAC;gBAAI,WAAU;0BACZ,UAAU,GAAG,CAAC,CAAC;oBACd,MAAM,OAAO,KAAK,IAAI;oBACtB,MAAM,WAAW,gBAAgB,KAAK,EAAE;oBACxC,qBACE,uRAAC,8KAAM;wBAEL,SAAS,WAAW,YAAY;wBAChC,WAAW,IAAA,2JAAE,EACX,8BACA,YAAY;wBAEd,SAAS,IAAM,eAAe,KAAK,EAAE;;0CAErC,uRAAC;gCAAK,WAAU;;;;;;4BACf,KAAK,KAAK;;uBATN,KAAK,EAAE;;;;;gBAYlB;;;;;;;;;;;;AAIR"}},
    {"offset": {"line": 210, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn('leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn('px-6', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,uRAAC;QACC,aAAU;QACV,WAAW,IAAA,2JAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,uRAAC;QACC,aAAU;QACV,WAAW,IAAA,2JAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,uRAAC;QACC,aAAU;QACV,WAAW,IAAA,2JAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,uRAAC;QACC,aAAU;QACV,WAAW,IAAA,2JAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,uRAAC;QACC,aAAU;QACV,WAAW,IAAA,2JAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,uRAAC;QACC,aAAU;QACV,WAAW,IAAA,2JAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,uRAAC;QACC,aAAU;QACV,WAAW,IAAA,2JAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 312, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/store.ts"],"sourcesContent":["import { create } from \"zustand\"\nimport { persist } from \"zustand/middleware\"\nimport type { AIVoiceSettings, AIVoiceProfile } from \"./ai-voice-types\"\n\nexport type VoiceType =\n  | \"standard-male\"\n  | \"standard-female\"\n  | \"azan-islamic\"\n  | \"hausa\"\n  | \"twi\"\n  | \"arabic\"\n  // OpenAI Voices\n  | \"openai-alloy\"\n  | \"openai-echo\"\n  | \"openai-fable\"\n  | \"openai-onyx\"\n  | \"openai-nova\"\n  | \"openai-shimmer\"\n  // ElevenLabs Voices\n  | \"elevenlabs-rachel\"\n  | \"elevenlabs-drew\"\n  | \"elevenlabs-clyde\"\n  | \"elevenlabs-paul\"\n  // Azure Voices\n  | \"azure-jenny\"\n  | \"azure-guy\"\n  | \"azure-aria\"\n  | \"azure-davis\"\nexport type Language = \"english\" | \"hausa\" | \"twi\" | \"arabic\"\n\nexport interface Student {\n  id: string\n  firstName: string\n  lastName: string\n  class?: string\n}\n\nexport interface Timetable {\n  id: string\n  name: string\n  day: string\n  bellTime: string\n  bellType: string\n}\n\nexport interface Device {\n  id: string\n  name: string\n  type: \"esp32\" | \"raspberry-pi\"\n  status: \"online\" | \"offline\"\n  lastSeen: string\n}\n\nexport interface CallRequest {\n  id: string\n  studentId: string\n  message: string\n  timestamp: string\n  status: \"pending\" | \"played\" | \"failed\"\n  voice: VoiceType\n  language: Language\n}\n\nexport interface SystemSettings {\n  defaultVoice: VoiceType\n  defaultLanguage: Language\n  defaultRepeatCount: number\n  azanEnabled: boolean\n  prayerTimes?: {\n    fajr: string\n    dhuhr: string\n    asr: string\n    maghrib: string\n    isha: string\n  }\n  // AI Voice settings - optional for backward compatibility\n  aiVoice?: AIVoiceSettings\n}\n\ninterface SchoolStore {\n  students: Student[]\n  timetables: Timetable[]\n  devices: Device[]\n  callRequests: CallRequest[]\n  settings: SystemSettings\n  addStudent: (student: Student) => void\n  removeStudent: (id: string) => void\n  addTimetable: (timetable: Timetable) => void\n  removeTimetable: (id: string) => void\n  updateTimetable: (id: string, timetable: Partial<Timetable>) => void\n  addDevice: (device: Device) => void\n  removeDevice: (id: string) => void\n  addCallRequest: (request: CallRequest) => void\n  clearCallRequests: () => void\n  updateSettings: (settings: Partial<SystemSettings>) => void\n}\n\nexport const useStore = create<SchoolStore>()(\n  persist(\n    (set) => ({\n      students: [],\n      timetables: [\n        { id: \"1\", name: \"Morning Assembly\", day: \"Monday\", bellTime: \"08:00\", bellType: \"announcement\" },\n        { id: \"2\", name: \"Break Time\", day: \"Daily\", bellTime: \"10:30\", bellType: \"bell\" },\n      ],\n      devices: [\n        { id: \"1\", name: \"Office Speaker\", type: \"esp32\", status: \"online\", lastSeen: new Date().toISOString() },\n        { id: \"2\", name: \"Classroom PI\", type: \"raspberry-pi\", status: \"online\", lastSeen: new Date().toISOString() },\n      ],\n      callRequests: [],\n      settings: {\n        defaultVoice: \"standard-male\",\n        defaultLanguage: \"english\",\n        defaultRepeatCount: 1,\n        azanEnabled: false,\n        prayerTimes: {\n          fajr: \"05:30\",\n          dhuhr: \"12:30\",\n          asr: \"15:00\",\n          maghrib: \"17:45\",\n          isha: \"19:00\",\n        },\n        // Default AI voice settings\n        aiVoice: {\n          aiVoiceEnabled: false,\n          primaryProvider: \"openai\",\n          fallbackProvider: \"azure\",\n          voiceProfiles: {\n            announcement: {\n              id: \"default-announcement\",\n              name: \"Professional Announcer\",\n              language: \"english\",\n              gender: \"neutral\",\n              category: \"announcement\",\n              provider: \"openai\"\n            },\n            prayer: {\n              id: \"default-prayer\",\n              name: \"Islamic Prayer Voice\",\n              language: \"arabic\",\n              gender: \"male\",\n              category: \"religious\",\n              provider: \"openai\"\n            },\n            bell: {\n              id: \"default-bell\",\n              name: \"School Bell Voice\",\n              language: \"english\",\n              gender: \"neutral\",\n              category: \"bell\",\n              provider: \"openai\"\n            },\n            general: {\n              id: \"default-general\",\n              name: \"General Purpose Voice\",\n              language: \"english\",\n              gender: \"female\",\n              category: \"standard\",\n              provider: \"openai\"\n            }\n          },\n          cacheSettings: {\n            maxSize: 100, // 100MB\n            maxAge: 30, // 30 days\n            enabled: true\n          },\n          usageSettings: {\n            monthlyLimit: 100000, // 100k characters\n            costThreshold: 50, // $50 USD\n            optimizationEnabled: true\n          },\n          providerConfigs: {\n            openai: {\n              apiKey: \"\",\n              enabled: false,\n              priority: 1,\n              rateLimit: {\n                requestsPerMinute: 50,\n                charactersPerDay: 50000\n              }\n            },\n            elevenlabs: {\n              apiKey: \"\",\n              enabled: false,\n              priority: 2,\n              rateLimit: {\n                requestsPerMinute: 20,\n                charactersPerDay: 20000\n              }\n            },\n            azure: {\n              apiKey: \"\",\n              endpoint: \"\",\n              enabled: false,\n              priority: 3,\n              rateLimit: {\n                requestsPerMinute: 100,\n                charactersPerDay: 100000\n              }\n            }\n          }\n        }\n      },\n      addStudent: (student) => set((state) => ({ students: [...state.students, student] })),\n      removeStudent: (id) => set((state) => ({ students: state.students.filter((s) => s.id !== id) })),\n      addTimetable: (timetable) => set((state) => ({ timetables: [...state.timetables, timetable] })),\n      removeTimetable: (id) => set((state) => ({ timetables: state.timetables.filter((t) => t.id !== id) })),\n      updateTimetable: (id, updates) =>\n        set((state) => ({\n          timetables: state.timetables.map((t) => (t.id === id ? { ...t, ...updates } : t)),\n        })),\n      addDevice: (device) => set((state) => ({ devices: [...state.devices, device] })),\n      removeDevice: (id) => set((state) => ({ devices: state.devices.filter((d) => d.id !== id) })),\n      addCallRequest: (request) => set((state) => ({ callRequests: [...state.callRequests, request] })),\n      clearCallRequests: () => set(() => ({ callRequests: [] })),\n      updateSettings: (newSettings) => set((state) => ({ settings: { ...state.settings, ...newSettings } })),\n    }),\n    {\n      name: \"school-bell-storage\",\n    },\n  ),\n)\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 503, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/ai-voice-types.ts"],"sourcesContent":["// Core AI Voice Generation Types and Interfaces\r\n\r\nexport interface AIVoiceProvider {\r\n  name: string\r\n  generateSpeech(text: string, options: VoiceOptions): Promise<AudioBuffer>\r\n  getAvailableVoices(): Promise<AIVoiceProfile[]>\r\n  validateCredentials(): Promise<boolean>\r\n  estimateCost(text: string, voice: string): number\r\n}\r\n\r\nexport interface VoiceOptions {\r\n  voice: string\r\n  language: string\r\n  speed: number\r\n  pitch: number\r\n  stability?: number\r\n  clarity?: number\r\n}\r\n\r\nexport interface AIVoiceProfile {\r\n  id: string\r\n  name: string\r\n  language: string\r\n  gender: 'male' | 'female' | 'neutral'\r\n  accent?: string\r\n  category: 'standard' | 'religious' | 'announcement' | 'bell'\r\n  provider: string\r\n  previewUrl?: string\r\n}\r\n\r\nexport interface AudioCacheManager {\r\n  store(key: string, audio: AudioBuffer, metadata: CacheMetadata): Promise<void>\r\n  retrieve(key: string): Promise<AudioBuffer | null>\r\n  exists(key: string): Promise<boolean>\r\n  clear(pattern?: string): Promise<void>\r\n  getUsageStats(): Promise<CacheStats>\r\n  cleanup(): Promise<void>\r\n}\r\n\r\nexport interface CacheMetadata {\r\n  text: string\r\n  voice: string\r\n  provider: string\r\n  timestamp: number\r\n  size: number\r\n  usage: number\r\n}\r\n\r\nexport interface CacheStats {\r\n  totalSize: number\r\n  totalFiles: number\r\n  hitRate: number\r\n  oldestFile: number\r\n  newestFile: number\r\n}\r\n\r\nexport interface ProviderConfig {\r\n  apiKey: string\r\n  endpoint?: string\r\n  enabled: boolean\r\n  priority: number\r\n  rateLimit: {\r\n    requestsPerMinute: number\r\n    charactersPerDay: number\r\n  }\r\n}\r\n\r\nexport interface AIVoiceSettings {\r\n  aiVoiceEnabled: boolean\r\n  primaryProvider: string\r\n  fallbackProvider?: string\r\n  voiceProfiles: {\r\n    announcement: AIVoiceProfile\r\n    prayer: AIVoiceProfile\r\n    bell: AIVoiceProfile\r\n    general: AIVoiceProfile\r\n  }\r\n  cacheSettings: {\r\n    maxSize: number // MB\r\n    maxAge: number // days\r\n    enabled: boolean\r\n  }\r\n  usageSettings: {\r\n    monthlyLimit: number // characters\r\n    costThreshold: number // USD\r\n    optimizationEnabled: boolean\r\n  }\r\n  providerConfigs: Record<string, ProviderConfig>\r\n}\r\n\r\nexport interface AudioGenerationRequest {\r\n  id: string\r\n  text: string\r\n  type: 'announcement' | 'prayer' | 'bell' | 'general'\r\n  voice: AIVoiceProfile\r\n  options: VoiceOptions\r\n  priority: 'high' | 'normal' | 'low'\r\n  timestamp: number\r\n  status: 'pending' | 'generating' | 'completed' | 'failed' | 'cached'\r\n  retryCount: number\r\n  estimatedCost: number\r\n}\r\n\r\nexport interface UsageRecord {\r\n  id: string\r\n  timestamp: number\r\n  provider: string\r\n  voice: string\r\n  characterCount: number\r\n  cost: number\r\n  type: 'announcement' | 'prayer' | 'bell' | 'general'\r\n  cached: boolean\r\n}\r\n\r\nexport interface UsageStats {\r\n  currentMonth: {\r\n    totalCharacters: number\r\n    totalCost: number\r\n    requestCount: number\r\n    cacheHitRate: number\r\n  }\r\n  byProvider: Record<string, {\r\n    characters: number\r\n    cost: number\r\n    requests: number\r\n  }>\r\n  byType: Record<string, {\r\n    characters: number\r\n    cost: number\r\n    requests: number\r\n  }>\r\n}\r\n\r\n// Provider-specific types\r\nexport type AIVoiceProviderType = 'openai' | 'elevenlabs' | 'azure'\r\n\r\nexport interface ProviderCapabilities {\r\n  maxCharacters: number\r\n  supportedLanguages: string[]\r\n  supportedFormats: string[]\r\n  realTimeGeneration: boolean\r\n  voiceCloning: boolean\r\n  emotionControl: boolean\r\n}\r\n\r\n// Error types for AI voice operations\r\nexport class AIVoiceError extends Error {\r\n  constructor(\r\n    message: string,\r\n    public provider: string,\r\n    public code: string,\r\n    public retryable: boolean = false\r\n  ) {\r\n    super(message)\r\n    this.name = 'AIVoiceError'\r\n  }\r\n}\r\n\r\nexport class RateLimitError extends AIVoiceError {\r\n  constructor(provider: string, retryAfter?: number) {\r\n    super(`Rate limit exceeded for ${provider}`, provider, 'RATE_LIMIT', true)\r\n    this.retryAfter = retryAfter\r\n  }\r\n  retryAfter?: number\r\n}\r\n\r\nexport class AuthenticationError extends AIVoiceError {\r\n  constructor(provider: string) {\r\n    super(`Authentication failed for ${provider}`, provider, 'AUTH_FAILED', false)\r\n  }\r\n}\r\n\r\nexport class ServiceUnavailableError extends AIVoiceError {\r\n  constructor(provider: string) {\r\n    super(`Service unavailable for ${provider}`, provider, 'SERVICE_UNAVAILABLE', true)\r\n  }\r\n}\r\n\r\n// Utility types\r\nexport type VoiceGenerationStatus = 'idle' | 'generating' | 'completed' | 'error'\r\n\r\nexport interface VoiceGenerationProgress {\r\n  status: VoiceGenerationStatus\r\n  progress: number // 0-100\r\n  message?: string\r\n  estimatedTimeRemaining?: number\r\n}"],"names":[],"mappings":"AAAA,gDAAgD;;;;;;;;;;;AAkJzC,MAAM,qBAAqB;;;;IAChC,YACE,OAAe,EACf,AAAO,QAAgB,EACvB,AAAO,IAAY,EACnB,AAAO,YAAqB,KAAK,CACjC;QACA,KAAK,CAAC,eAJC,WAAA,eACA,OAAA,WACA,YAAA;QAGP,IAAI,CAAC,IAAI,GAAG;IACd;AACF;AAEO,MAAM,uBAAuB;IAClC,YAAY,QAAgB,EAAE,UAAmB,CAAE;QACjD,KAAK,CAAC,CAAC,wBAAwB,EAAE,UAAU,EAAE,UAAU,cAAc;QACrE,IAAI,CAAC,UAAU,GAAG;IACpB;IACA,WAAmB;AACrB;AAEO,MAAM,4BAA4B;IACvC,YAAY,QAAgB,CAAE;QAC5B,KAAK,CAAC,CAAC,0BAA0B,EAAE,UAAU,EAAE,UAAU,eAAe;IAC1E;AACF;AAEO,MAAM,gCAAgC;IAC3C,YAAY,QAAgB,CAAE;QAC5B,KAAK,CAAC,CAAC,wBAAwB,EAAE,UAAU,EAAE,UAAU,uBAAuB;IAChF;AACF"}},
    {"offset": {"line": 544, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/ai-voice-constants.ts"],"sourcesContent":["import type { AIVoiceProfile, ProviderCapabilities, AIVoiceProviderType } from \"./ai-voice-types\"\r\n\r\n// Default voice profiles for each provider\r\nexport const DEFAULT_VOICE_PROFILES: Record<AIVoiceProviderType, AIVoiceProfile[]> = {\r\n  openai: [\r\n    {\r\n      id: \"openai-alloy\",\r\n      name: \"Alloy\",\r\n      language: \"english\",\r\n      gender: \"neutral\",\r\n      category: \"standard\",\r\n      provider: \"openai\"\r\n    },\r\n    {\r\n      id: \"openai-echo\",\r\n      name: \"Echo\",\r\n      language: \"english\", \r\n      gender: \"male\",\r\n      category: \"announcement\",\r\n      provider: \"openai\"\r\n    },\r\n    {\r\n      id: \"openai-fable\",\r\n      name: \"Fable\",\r\n      language: \"english\",\r\n      gender: \"neutral\",\r\n      category: \"standard\",\r\n      provider: \"openai\"\r\n    },\r\n    {\r\n      id: \"openai-onyx\",\r\n      name: \"Onyx\",\r\n      language: \"english\",\r\n      gender: \"male\",\r\n      category: \"announcement\",\r\n      provider: \"openai\"\r\n    },\r\n    {\r\n      id: \"openai-nova\",\r\n      name: \"Nova\",\r\n      language: \"english\",\r\n      gender: \"female\",\r\n      category: \"standard\",\r\n      provider: \"openai\"\r\n    },\r\n    {\r\n      id: \"openai-shimmer\",\r\n      name: \"Shimmer\",\r\n      language: \"english\",\r\n      gender: \"female\",\r\n      category: \"announcement\",\r\n      provider: \"openai\"\r\n    }\r\n  ],\r\n  elevenlabs: [\r\n    {\r\n      id: \"elevenlabs-rachel\",\r\n      name: \"Rachel\",\r\n      language: \"english\",\r\n      gender: \"female\",\r\n      accent: \"american\",\r\n      category: \"standard\",\r\n      provider: \"elevenlabs\"\r\n    },\r\n    {\r\n      id: \"elevenlabs-drew\",\r\n      name: \"Drew\",\r\n      language: \"english\",\r\n      gender: \"male\",\r\n      accent: \"american\",\r\n      category: \"announcement\",\r\n      provider: \"elevenlabs\"\r\n    },\r\n    {\r\n      id: \"elevenlabs-clyde\",\r\n      name: \"Clyde\",\r\n      language: \"english\",\r\n      gender: \"male\",\r\n      accent: \"american\",\r\n      category: \"standard\",\r\n      provider: \"elevenlabs\"\r\n    },\r\n    {\r\n      id: \"elevenlabs-paul\",\r\n      name: \"Paul\",\r\n      language: \"english\",\r\n      gender: \"male\",\r\n      accent: \"american\",\r\n      category: \"announcement\",\r\n      provider: \"elevenlabs\"\r\n    }\r\n  ],\r\n  azure: [\r\n    {\r\n      id: \"azure-jenny\",\r\n      name: \"Jenny\",\r\n      language: \"english\",\r\n      gender: \"female\",\r\n      accent: \"american\",\r\n      category: \"standard\",\r\n      provider: \"azure\"\r\n    },\r\n    {\r\n      id: \"azure-guy\",\r\n      name: \"Guy\",\r\n      language: \"english\",\r\n      gender: \"male\",\r\n      accent: \"american\",\r\n      category: \"announcement\",\r\n      provider: \"azure\"\r\n    },\r\n    {\r\n      id: \"azure-aria\",\r\n      name: \"Aria\",\r\n      language: \"english\",\r\n      gender: \"female\",\r\n      accent: \"american\",\r\n      category: \"announcement\",\r\n      provider: \"azure\"\r\n    },\r\n    {\r\n      id: \"azure-davis\",\r\n      name: \"Davis\",\r\n      language: \"english\",\r\n      gender: \"male\",\r\n      accent: \"american\",\r\n      category: \"standard\",\r\n      provider: \"azure\"\r\n    }\r\n  ]\r\n}\r\n\r\n// Provider capabilities\r\nexport const PROVIDER_CAPABILITIES: Record<AIVoiceProviderType, ProviderCapabilities> = {\r\n  openai: {\r\n    maxCharacters: 4096,\r\n    supportedLanguages: [\"english\", \"spanish\", \"french\", \"german\", \"italian\", \"portuguese\", \"russian\", \"japanese\", \"korean\", \"chinese\", \"arabic\"],\r\n    supportedFormats: [\"mp3\", \"opus\", \"aac\", \"flac\"],\r\n    realTimeGeneration: true,\r\n    voiceCloning: false,\r\n    emotionControl: false\r\n  },\r\n  elevenlabs: {\r\n    maxCharacters: 5000,\r\n    supportedLanguages: [\"english\", \"spanish\", \"french\", \"german\", \"italian\", \"portuguese\", \"polish\", \"hindi\", \"arabic\"],\r\n    supportedFormats: [\"mp3\", \"wav\", \"ogg\"],\r\n    realTimeGeneration: true,\r\n    voiceCloning: true,\r\n    emotionControl: true\r\n  },\r\n  azure: {\r\n    maxCharacters: 10000,\r\n    supportedLanguages: [\"english\", \"spanish\", \"french\", \"german\", \"italian\", \"portuguese\", \"russian\", \"japanese\", \"korean\", \"chinese\", \"arabic\", \"hindi\", \"dutch\", \"swedish\"],\r\n    supportedFormats: [\"mp3\", \"wav\", \"ogg\", \"webm\"],\r\n    realTimeGeneration: true,\r\n    voiceCloning: false,\r\n    emotionControl: true\r\n  }\r\n}\r\n\r\n// Islamic prayer phrases in Arabic with transliteration\r\nexport const PRAYER_PHRASES = {\r\n  fajr: {\r\n    arabic: \"حي على الصلاة، حي على الفلاح، الصلاة خير من النوم\",\r\n    transliteration: \"Hayya 'ala as-salah, hayya 'ala al-falah, as-salatu khayrun min an-nawm\",\r\n    english: \"Come to prayer, come to success, prayer is better than sleep\"\r\n  },\r\n  dhuhr: {\r\n    arabic: \"حي على الصلاة، حي على الفلاح\",\r\n    transliteration: \"Hayya 'ala as-salah, hayya 'ala al-falah\",\r\n    english: \"Come to prayer, come to success\"\r\n  },\r\n  asr: {\r\n    arabic: \"حي على الصلاة، حي على الفلاح\",\r\n    transliteration: \"Hayya 'ala as-salah, hayya 'ala al-falah\",\r\n    english: \"Come to prayer, come to success\"\r\n  },\r\n  maghrib: {\r\n    arabic: \"حي على الصلاة، حي على الفلاح\",\r\n    transliteration: \"Hayya 'ala as-salah, hayya 'ala al-falah\",\r\n    english: \"Come to prayer, come to success\"\r\n  },\r\n  isha: {\r\n    arabic: \"حي على الصلاة، حي على الفلاح\",\r\n    transliteration: \"Hayya 'ala as-salah, hayya 'ala al-falah\",\r\n    english: \"Come to prayer, come to success\"\r\n  }\r\n}\r\n\r\n// Bell and announcement templates\r\nexport const AUDIO_TEMPLATES = {\r\n  bell: {\r\n    class: \"School bell - Class time\",\r\n    break: \"School bell - Break time\",\r\n    assembly: \"School bell - Assembly time\",\r\n    dismissal: \"School bell - Dismissal time\"\r\n  },\r\n  announcement: {\r\n    attention: \"Attention students and staff\",\r\n    general: \"This is a general announcement\",\r\n    emergency: \"This is an emergency announcement\"\r\n  }\r\n}\r\n\r\n// Cache key generation\r\nexport const generateCacheKey = (text: string, voice: string, provider: string): string => {\r\n  const hash = btoa(text + voice + provider).replace(/[^a-zA-Z0-9]/g, '').substring(0, 32)\r\n  return `ai-voice-${provider}-${voice}-${hash}`\r\n}\r\n\r\n// Cost estimation (approximate costs per 1000 characters)\r\nexport const PROVIDER_COSTS: Record<AIVoiceProviderType, number> = {\r\n  openai: 0.015, // $0.015 per 1000 characters\r\n  elevenlabs: 0.30, // $0.30 per 1000 characters\r\n  azure: 0.016 // $0.016 per 1000 characters\r\n}\r\n\r\n// Rate limiting defaults\r\nexport const DEFAULT_RATE_LIMITS = {\r\n  openai: {\r\n    requestsPerMinute: 50,\r\n    charactersPerDay: 50000\r\n  },\r\n  elevenlabs: {\r\n    requestsPerMinute: 20,\r\n    charactersPerDay: 20000\r\n  },\r\n  azure: {\r\n    requestsPerMinute: 100,\r\n    charactersPerDay: 100000\r\n  }\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 832, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/providers/openai-provider.ts"],"sourcesContent":["import type { AIVoiceProvider, VoiceOptions, AIVoiceProfile } from \"../ai-voice-types\"\r\nimport { AIVoiceError, RateLimitError, AuthenticationError, ServiceUnavailableError } from \"../ai-voice-types\"\r\nimport { PROVIDER_COSTS } from \"../ai-voice-constants\"\r\n\r\nexport class OpenAIProvider implements AIVoiceProvider {\r\n  name = \"OpenAI TTS\"\r\n  private apiKey: string\r\n  private baseUrl = \"https://api.openai.com/v1\"\r\n\r\n  constructor(apiKey: string) {\r\n    this.apiKey = apiKey\r\n  }\r\n\r\n  async generateSpeech(text: string, options: VoiceOptions): Promise<AudioBuffer> {\r\n    if (!this.apiKey) {\r\n      throw new AuthenticationError(\"OpenAI\")\r\n    }\r\n\r\n    const requestBody = {\r\n      model: \"tts-1\", // Use tts-1 for faster generation, tts-1-hd for higher quality\r\n      input: text,\r\n      voice: this.mapVoiceId(options.voice),\r\n      response_format: \"mp3\",\r\n      speed: Math.max(0.25, Math.min(4.0, options.speed)) // OpenAI supports 0.25 to 4.0\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/audio/speech`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Authorization\": `Bearer ${this.apiKey}`,\r\n          \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(requestBody)\r\n      })\r\n\r\n      if (!response.ok) {\r\n        await this.handleErrorResponse(response)\r\n      }\r\n\r\n      const arrayBuffer = await response.arrayBuffer()\r\n      return await this.convertMp3ToAudioBuffer(arrayBuffer)\r\n    } catch (error) {\r\n      if (error instanceof AIVoiceError) {\r\n        throw error\r\n      }\r\n      throw new ServiceUnavailableError(\"OpenAI\")\r\n    }\r\n  }\r\n\r\n  async getAvailableVoices(): Promise<AIVoiceProfile[]> {\r\n    // OpenAI TTS voices are predefined\r\n    return [\r\n      {\r\n        id: \"openai-alloy\",\r\n        name: \"Alloy\",\r\n        language: \"english\",\r\n        gender: \"neutral\",\r\n        category: \"standard\",\r\n        provider: \"openai\"\r\n      },\r\n      {\r\n        id: \"openai-echo\",\r\n        name: \"Echo\",\r\n        language: \"english\",\r\n        gender: \"male\",\r\n        category: \"announcement\",\r\n        provider: \"openai\"\r\n      },\r\n      {\r\n        id: \"openai-fable\",\r\n        name: \"Fable\",\r\n        language: \"english\",\r\n        gender: \"neutral\",\r\n        category: \"standard\",\r\n        provider: \"openai\"\r\n      },\r\n      {\r\n        id: \"openai-onyx\",\r\n        name: \"Onyx\",\r\n        language: \"english\",\r\n        gender: \"male\",\r\n        category: \"announcement\",\r\n        provider: \"openai\"\r\n      },\r\n      {\r\n        id: \"openai-nova\",\r\n        name: \"Nova\",\r\n        language: \"english\",\r\n        gender: \"female\",\r\n        category: \"standard\",\r\n        provider: \"openai\"\r\n      },\r\n      {\r\n        id: \"openai-shimmer\",\r\n        name: \"Shimmer\",\r\n        language: \"english\",\r\n        gender: \"female\",\r\n        category: \"announcement\",\r\n        provider: \"openai\"\r\n      }\r\n    ]\r\n  }\r\n\r\n  async validateCredentials(): Promise<boolean> {\r\n    if (!this.apiKey) {\r\n      return false\r\n    }\r\n\r\n    try {\r\n      // Test with a minimal request\r\n      const response = await fetch(`${this.baseUrl}/audio/speech`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Authorization\": `Bearer ${this.apiKey}`,\r\n          \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify({\r\n          model: \"tts-1\",\r\n          input: \"test\",\r\n          voice: \"alloy\",\r\n          response_format: \"mp3\"\r\n        })\r\n      })\r\n\r\n      return response.ok || response.status === 400 // 400 might be due to minimal input, but auth is valid\r\n    } catch (error) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  estimateCost(text: string, voice: string): number {\r\n    const characterCount = text.length\r\n    return (characterCount / 1000) * PROVIDER_COSTS.openai\r\n  }\r\n\r\n  private mapVoiceId(voiceId: string): string {\r\n    // Map our voice IDs to OpenAI voice names\r\n    const voiceMap: Record<string, string> = {\r\n      \"openai-alloy\": \"alloy\",\r\n      \"openai-echo\": \"echo\",\r\n      \"openai-fable\": \"fable\",\r\n      \"openai-onyx\": \"onyx\",\r\n      \"openai-nova\": \"nova\",\r\n      \"openai-shimmer\": \"shimmer\"\r\n    }\r\n\r\n    return voiceMap[voiceId] || \"alloy\" // Default to alloy\r\n  }\r\n\r\n  private async handleErrorResponse(response: Response): Promise<never> {\r\n    const errorText = await response.text()\r\n    let errorData: any = {}\r\n    \r\n    try {\r\n      errorData = JSON.parse(errorText)\r\n    } catch {\r\n      // If JSON parsing fails, use the raw text\r\n    }\r\n\r\n    switch (response.status) {\r\n      case 401:\r\n        throw new AuthenticationError(\"OpenAI\")\r\n      case 429:\r\n        const retryAfter = response.headers.get(\"retry-after\")\r\n        throw new RateLimitError(\"OpenAI\", retryAfter ? parseInt(retryAfter) : undefined)\r\n      case 500:\r\n      case 502:\r\n      case 503:\r\n      case 504:\r\n        throw new ServiceUnavailableError(\"OpenAI\")\r\n      default:\r\n        throw new AIVoiceError(\r\n          errorData.error?.message || `OpenAI API error: ${response.status}`,\r\n          \"OpenAI\",\r\n          `HTTP_${response.status}`,\r\n          response.status >= 500\r\n        )\r\n    }\r\n  }\r\n\r\n  private async convertMp3ToAudioBuffer(mp3ArrayBuffer: ArrayBuffer): Promise<AudioBuffer> {\r\n    // Create AudioContext\r\n    const AudioContext = window.AudioContext || (window as any).webkitAudioContext\r\n    const audioContext = new AudioContext()\r\n\r\n    try {\r\n      // Decode the MP3 data\r\n      const audioBuffer = await audioContext.decodeAudioData(mp3ArrayBuffer.slice(0))\r\n      return audioBuffer\r\n    } catch (error) {\r\n      throw new AIVoiceError(\r\n        \"Failed to decode audio data from OpenAI\",\r\n        \"OpenAI\",\r\n        \"DECODE_ERROR\",\r\n        false\r\n      )\r\n    }\r\n  }\r\n\r\n  // Utility method to check if a language is supported\r\n  isLanguageSupported(language: string): boolean {\r\n    // OpenAI TTS supports many languages, but voices are primarily English\r\n    const supportedLanguages = [\r\n      \"english\", \"spanish\", \"french\", \"german\", \"italian\", \"portuguese\", \r\n      \"russian\", \"japanese\", \"korean\", \"chinese\", \"arabic\", \"hindi\", \"dutch\"\r\n    ]\r\n    return supportedLanguages.includes(language.toLowerCase())\r\n  }\r\n\r\n  // Get the maximum character limit for OpenAI\r\n  getMaxCharacters(): number {\r\n    return 4096\r\n  }\r\n\r\n  // Get supported audio formats\r\n  getSupportedFormats(): string[] {\r\n    return [\"mp3\", \"opus\", \"aac\", \"flac\"]\r\n  }\r\n\r\n  // Update API key\r\n  updateApiKey(apiKey: string): void {\r\n    this.apiKey = apiKey\r\n  }\r\n\r\n  // Get current API key (masked for security)\r\n  getApiKeyMask(): string {\r\n    if (!this.apiKey) return \"\"\r\n    return this.apiKey.substring(0, 7) + \"...\" + this.apiKey.substring(this.apiKey.length - 4)\r\n  }\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1056, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/providers/elevenlabs-provider.ts"],"sourcesContent":["import type { AIVoiceProvider, VoiceOptions, AIVoiceProfile } from \"../ai-voice-types\"\r\nimport { AIVoiceError, RateLimitError, AuthenticationError, ServiceUnavailableError } from \"../ai-voice-types\"\r\nimport { PROVIDER_COSTS } from \"../ai-voice-constants\"\r\n\r\nexport class ElevenLabsProvider implements AIVoiceProvider {\r\n  name = \"ElevenLabs\"\r\n  private apiKey: string\r\n  private baseUrl = \"https://api.elevenlabs.io/v1\"\r\n\r\n  constructor(apiKey: string) {\r\n    this.apiKey = apiKey\r\n  }\r\n\r\n  async generateSpeech(text: string, options: VoiceOptions): Promise<AudioBuffer> {\r\n    if (!this.apiKey) {\r\n      throw new AuthenticationError(\"ElevenLabs\")\r\n    }\r\n\r\n    const voiceId = this.mapVoiceId(options.voice)\r\n    const requestBody = {\r\n      text: text,\r\n      model_id: \"eleven_monolingual_v1\", // Use multilingual for other languages\r\n      voice_settings: {\r\n        stability: options.stability || 0.5,\r\n        similarity_boost: options.clarity || 0.75,\r\n        style: 0.0,\r\n        use_speaker_boost: true\r\n      }\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/text-to-speech/${voiceId}`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Accept\": \"audio/mpeg\",\r\n          \"Content-Type\": \"application/json\",\r\n          \"xi-api-key\": this.apiKey\r\n        },\r\n        body: JSON.stringify(requestBody)\r\n      })\r\n\r\n      if (!response.ok) {\r\n        await this.handleErrorResponse(response)\r\n      }\r\n\r\n      const arrayBuffer = await response.arrayBuffer()\r\n      return await this.convertMp3ToAudioBuffer(arrayBuffer)\r\n    } catch (error) {\r\n      if (error instanceof AIVoiceError) {\r\n        throw error\r\n      }\r\n      throw new ServiceUnavailableError(\"ElevenLabs\")\r\n    }\r\n  }\r\n\r\n  async getAvailableVoices(): Promise<AIVoiceProfile[]> {\r\n    if (!this.apiKey) {\r\n      // Return default voices if no API key\r\n      return this.getDefaultVoices()\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/voices`, {\r\n        headers: {\r\n          \"xi-api-key\": this.apiKey\r\n        }\r\n      })\r\n\r\n      if (!response.ok) {\r\n        // Fallback to default voices if API call fails\r\n        return this.getDefaultVoices()\r\n      }\r\n\r\n      const data = await response.json()\r\n      return this.mapElevenLabsVoices(data.voices || [])\r\n    } catch (error) {\r\n      // Fallback to default voices\r\n      return this.getDefaultVoices()\r\n    }\r\n  }\r\n\r\n  async validateCredentials(): Promise<boolean> {\r\n    if (!this.apiKey) {\r\n      return false\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/user`, {\r\n        headers: {\r\n          \"xi-api-key\": this.apiKey\r\n        }\r\n      })\r\n\r\n      return response.ok\r\n    } catch (error) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  estimateCost(text: string, voice: string): number {\r\n    const characterCount = text.length\r\n    return (characterCount / 1000) * PROVIDER_COSTS.elevenlabs\r\n  }\r\n\r\n  private getDefaultVoices(): AIVoiceProfile[] {\r\n    return [\r\n      {\r\n        id: \"elevenlabs-rachel\",\r\n        name: \"Rachel\",\r\n        language: \"english\",\r\n        gender: \"female\",\r\n        accent: \"american\",\r\n        category: \"standard\",\r\n        provider: \"elevenlabs\"\r\n      },\r\n      {\r\n        id: \"elevenlabs-drew\",\r\n        name: \"Drew\",\r\n        language: \"english\",\r\n        gender: \"male\",\r\n        accent: \"american\",\r\n        category: \"announcement\",\r\n        provider: \"elevenlabs\"\r\n      },\r\n      {\r\n        id: \"elevenlabs-clyde\",\r\n        name: \"Clyde\",\r\n        language: \"english\",\r\n        gender: \"male\",\r\n        accent: \"american\",\r\n        category: \"standard\",\r\n        provider: \"elevenlabs\"\r\n      },\r\n      {\r\n        id: \"elevenlabs-paul\",\r\n        name: \"Paul\",\r\n        language: \"english\",\r\n        gender: \"male\",\r\n        accent: \"american\",\r\n        category: \"announcement\",\r\n        provider: \"elevenlabs\"\r\n      },\r\n      {\r\n        id: \"elevenlabs-domi\",\r\n        name: \"Domi\",\r\n        language: \"english\",\r\n        gender: \"female\",\r\n        accent: \"american\",\r\n        category: \"standard\",\r\n        provider: \"elevenlabs\"\r\n      },\r\n      {\r\n        id: \"elevenlabs-dave\",\r\n        name: \"Dave\",\r\n        language: \"english\",\r\n        gender: \"male\",\r\n        accent: \"british\",\r\n        category: \"announcement\",\r\n        provider: \"elevenlabs\"\r\n      }\r\n    ]\r\n  }\r\n\r\n  private mapElevenLabsVoices(voices: any[]): AIVoiceProfile[] {\r\n    return voices.map(voice => ({\r\n      id: `elevenlabs-${voice.voice_id}`,\r\n      name: voice.name,\r\n      language: this.detectLanguage(voice.labels || {}),\r\n      gender: this.detectGender(voice.labels || {}),\r\n      accent: this.detectAccent(voice.labels || {}),\r\n      category: this.detectCategory(voice.labels || {}),\r\n      provider: \"elevenlabs\",\r\n      previewUrl: voice.preview_url\r\n    }))\r\n  }\r\n\r\n  private detectLanguage(labels: any): string {\r\n    const language = labels.language || labels.accent || \"english\"\r\n    return language.toLowerCase()\r\n  }\r\n\r\n  private detectGender(labels: any): \"male\" | \"female\" | \"neutral\" {\r\n    const gender = labels.gender || labels.sex || \"\"\r\n    if (gender.toLowerCase().includes(\"male\")) return \"male\"\r\n    if (gender.toLowerCase().includes(\"female\")) return \"female\"\r\n    return \"neutral\"\r\n  }\r\n\r\n  private detectAccent(labels: any): string | undefined {\r\n    return labels.accent || labels.region || undefined\r\n  }\r\n\r\n  private detectCategory(labels: any): \"standard\" | \"religious\" | \"announcement\" | \"bell\" {\r\n    const description = (labels.description || \"\").toLowerCase()\r\n    const useCase = (labels.use_case || \"\").toLowerCase()\r\n    \r\n    if (description.includes(\"announcement\") || useCase.includes(\"announcement\")) {\r\n      return \"announcement\"\r\n    }\r\n    if (description.includes(\"religious\") || useCase.includes(\"religious\")) {\r\n      return \"religious\"\r\n    }\r\n    if (description.includes(\"bell\") || useCase.includes(\"bell\")) {\r\n      return \"bell\"\r\n    }\r\n    return \"standard\"\r\n  }\r\n\r\n  private mapVoiceId(voiceId: string): string {\r\n    // Map our voice IDs to ElevenLabs voice IDs\r\n    const voiceMap: Record<string, string> = {\r\n      \"elevenlabs-rachel\": \"21m00Tcm4TlvDq8ikWAM\",\r\n      \"elevenlabs-drew\": \"29vD33N1CtxCmqQRPOHJ\",\r\n      \"elevenlabs-clyde\": \"2EiwWnXFnvU5JabPnv8n\",\r\n      \"elevenlabs-paul\": \"5Q0t7uMcjvnagumLfvZi\",\r\n      \"elevenlabs-domi\": \"AZnzlk1XvdvUeBnXmlld\",\r\n      \"elevenlabs-dave\": \"CYw3kZ02Hs0563khs1Fj\"\r\n    }\r\n\r\n    // If it's already a direct voice ID (from API), use it\r\n    if (voiceId.length === 20 && !voiceId.includes(\"-\")) {\r\n      return voiceId\r\n    }\r\n\r\n    return voiceMap[voiceId] || \"21m00Tcm4TlvDq8ikWAM\" // Default to Rachel\r\n  }\r\n\r\n  private async handleErrorResponse(response: Response): Promise<never> {\r\n    const errorText = await response.text()\r\n    let errorData: any = {}\r\n    \r\n    try {\r\n      errorData = JSON.parse(errorText)\r\n    } catch {\r\n      // If JSON parsing fails, use the raw text\r\n    }\r\n\r\n    switch (response.status) {\r\n      case 401:\r\n        throw new AuthenticationError(\"ElevenLabs\")\r\n      case 429:\r\n        const retryAfter = response.headers.get(\"retry-after\")\r\n        throw new RateLimitError(\"ElevenLabs\", retryAfter ? parseInt(retryAfter) : undefined)\r\n      case 500:\r\n      case 502:\r\n      case 503:\r\n      case 504:\r\n        throw new ServiceUnavailableError(\"ElevenLabs\")\r\n      default:\r\n        throw new AIVoiceError(\r\n          errorData.detail?.message || errorData.message || `ElevenLabs API error: ${response.status}`,\r\n          \"ElevenLabs\",\r\n          `HTTP_${response.status}`,\r\n          response.status >= 500\r\n        )\r\n    }\r\n  }\r\n\r\n  private async convertMp3ToAudioBuffer(mp3ArrayBuffer: ArrayBuffer): Promise<AudioBuffer> {\r\n    // Create AudioContext\r\n    const AudioContext = window.AudioContext || (window as any).webkitAudioContext\r\n    const audioContext = new AudioContext()\r\n\r\n    try {\r\n      // Decode the MP3 data\r\n      const audioBuffer = await audioContext.decodeAudioData(mp3ArrayBuffer.slice(0))\r\n      return audioBuffer\r\n    } catch (error) {\r\n      throw new AIVoiceError(\r\n        \"Failed to decode audio data from ElevenLabs\",\r\n        \"ElevenLabs\",\r\n        \"DECODE_ERROR\",\r\n        false\r\n      )\r\n    }\r\n  }\r\n\r\n  // Utility method to check if a language is supported\r\n  isLanguageSupported(language: string): boolean {\r\n    const supportedLanguages = [\r\n      \"english\", \"spanish\", \"french\", \"german\", \"italian\", \"portuguese\", \r\n      \"polish\", \"hindi\", \"arabic\", \"japanese\", \"korean\", \"chinese\"\r\n    ]\r\n    return supportedLanguages.includes(language.toLowerCase())\r\n  }\r\n\r\n  // Get the maximum character limit for ElevenLabs\r\n  getMaxCharacters(): number {\r\n    return 5000\r\n  }\r\n\r\n  // Get supported audio formats\r\n  getSupportedFormats(): string[] {\r\n    return [\"mp3\", \"wav\", \"ogg\"]\r\n  }\r\n\r\n  // Update API key\r\n  updateApiKey(apiKey: string): void {\r\n    this.apiKey = apiKey\r\n  }\r\n\r\n  // Get current API key (masked for security)\r\n  getApiKeyMask(): string {\r\n    if (!this.apiKey) return \"\"\r\n    return this.apiKey.substring(0, 7) + \"...\" + this.apiKey.substring(this.apiKey.length - 4)\r\n  }\r\n\r\n  // ElevenLabs specific methods\r\n  async getVoiceSettings(voiceId: string): Promise<any> {\r\n    if (!this.apiKey) {\r\n      throw new AuthenticationError(\"ElevenLabs\")\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/voices/${voiceId}/settings`, {\r\n        headers: {\r\n          \"xi-api-key\": this.apiKey\r\n        }\r\n      })\r\n\r\n      if (!response.ok) {\r\n        throw new AIVoiceError(\"Failed to get voice settings\", \"ElevenLabs\", \"SETTINGS_ERROR\", false)\r\n      }\r\n\r\n      return await response.json()\r\n    } catch (error) {\r\n      if (error instanceof AIVoiceError) {\r\n        throw error\r\n      }\r\n      throw new ServiceUnavailableError(\"ElevenLabs\")\r\n    }\r\n  }\r\n\r\n  async getUserInfo(): Promise<any> {\r\n    if (!this.apiKey) {\r\n      throw new AuthenticationError(\"ElevenLabs\")\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/user`, {\r\n        headers: {\r\n          \"xi-api-key\": this.apiKey\r\n        }\r\n      })\r\n\r\n      if (!response.ok) {\r\n        throw new AIVoiceError(\"Failed to get user info\", \"ElevenLabs\", \"USER_INFO_ERROR\", false)\r\n      }\r\n\r\n      return await response.json()\r\n    } catch (error) {\r\n      if (error instanceof AIVoiceError) {\r\n        throw error\r\n      }\r\n      throw new ServiceUnavailableError(\"ElevenLabs\")\r\n    }\r\n  }\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1385, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/providers/azure-provider.ts"],"sourcesContent":["import type { AIVoiceProvider, VoiceOptions, AIVoiceProfile } from \"../ai-voice-types\"\r\nimport { AIVoiceError, RateLimitError, AuthenticationError, ServiceUnavailableError } from \"../ai-voice-types\"\r\nimport { PROVIDER_COSTS } from \"../ai-voice-constants\"\r\n\r\nexport class AzureProvider implements AIVoiceProvider {\r\n  name = \"Azure Cognitive Services\"\r\n  private apiKey: string\r\n  private region: string\r\n  private baseUrl: string\r\n\r\n  constructor(apiKey: string, endpoint?: string) {\r\n    this.apiKey = apiKey\r\n    \r\n    // Extract region from endpoint or use default\r\n    if (endpoint) {\r\n      const match = endpoint.match(/https:\\/\\/([^.]+)\\.tts\\.speech\\.microsoft\\.com/)\r\n      this.region = match ? match[1] : \"eastus\"\r\n      this.baseUrl = endpoint\r\n    } else {\r\n      this.region = \"eastus\"\r\n      this.baseUrl = `https://${this.region}.tts.speech.microsoft.com`\r\n    }\r\n  }\r\n\r\n  async generateSpeech(text: string, options: VoiceOptions): Promise<AudioBuffer> {\r\n    if (!this.apiKey) {\r\n      throw new AuthenticationError(\"Azure\")\r\n    }\r\n\r\n    // Get access token first\r\n    const accessToken = await this.getAccessToken()\r\n    \r\n    const voiceInfo = this.mapVoiceId(options.voice)\r\n    const ssml = this.generateSSML(text, voiceInfo, options)\r\n\r\n    try {\r\n      const response = await fetch(`${this.baseUrl}/cognitiveservices/v1`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Authorization\": `Bearer ${accessToken}`,\r\n          \"Content-Type\": \"application/ssml+xml\",\r\n          \"X-Microsoft-OutputFormat\": \"audio-16khz-128kbitrate-mono-mp3\",\r\n          \"User-Agent\": \"SchoolBellSystem\"\r\n        },\r\n        body: ssml\r\n      })\r\n\r\n      if (!response.ok) {\r\n        await this.handleErrorResponse(response)\r\n      }\r\n\r\n      const arrayBuffer = await response.arrayBuffer()\r\n      return await this.convertMp3ToAudioBuffer(arrayBuffer)\r\n    } catch (error) {\r\n      if (error instanceof AIVoiceError) {\r\n        throw error\r\n      }\r\n      throw new ServiceUnavailableError(\"Azure\")\r\n    }\r\n  }\r\n\r\n  async getAvailableVoices(): Promise<AIVoiceProfile[]> {\r\n    if (!this.apiKey) {\r\n      return this.getDefaultVoices()\r\n    }\r\n\r\n    try {\r\n      const accessToken = await this.getAccessToken()\r\n      const response = await fetch(`${this.baseUrl}/cognitiveservices/voices/list`, {\r\n        headers: {\r\n          \"Authorization\": `Bearer ${accessToken}`\r\n        }\r\n      })\r\n\r\n      if (!response.ok) {\r\n        return this.getDefaultVoices()\r\n      }\r\n\r\n      const voices = await response.json()\r\n      return this.mapAzureVoices(voices)\r\n    } catch (error) {\r\n      return this.getDefaultVoices()\r\n    }\r\n  }\r\n\r\n  async validateCredentials(): Promise<boolean> {\r\n    if (!this.apiKey) {\r\n      return false\r\n    }\r\n\r\n    try {\r\n      const accessToken = await this.getAccessToken()\r\n      return !!accessToken\r\n    } catch (error) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  estimateCost(text: string, voice: string): number {\r\n    const characterCount = text.length\r\n    return (characterCount / 1000) * PROVIDER_COSTS.azure\r\n  }\r\n\r\n  private async getAccessToken(): Promise<string> {\r\n    const tokenUrl = `https://${this.region}.api.cognitive.microsoft.com/sts/v1.0/issueToken`\r\n    \r\n    try {\r\n      const response = await fetch(tokenUrl, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Ocp-Apim-Subscription-Key\": this.apiKey,\r\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n        },\r\n        body: \"\"\r\n      })\r\n\r\n      if (!response.ok) {\r\n        if (response.status === 401 || response.status === 403) {\r\n          throw new AuthenticationError(\"Azure\")\r\n        }\r\n        throw new ServiceUnavailableError(\"Azure\")\r\n      }\r\n\r\n      return await response.text()\r\n    } catch (error) {\r\n      if (error instanceof AIVoiceError) {\r\n        throw error\r\n      }\r\n      throw new ServiceUnavailableError(\"Azure\")\r\n    }\r\n  }\r\n\r\n  private generateSSML(text: string, voiceInfo: any, options: VoiceOptions): string {\r\n    const rate = this.mapSpeedToRate(options.speed)\r\n    const pitch = this.mapPitchToSSML(options.pitch)\r\n    \r\n    return `\r\n      <speak version=\"1.0\" xmlns=\"http://www.w3.org/2001/10/synthesis\" xml:lang=\"${voiceInfo.locale}\">\r\n        <voice name=\"${voiceInfo.name}\">\r\n          <prosody rate=\"${rate}\" pitch=\"${pitch}\">\r\n            ${this.escapeXML(text)}\r\n          </prosody>\r\n        </voice>\r\n      </speak>\r\n    `.trim()\r\n  }\r\n\r\n  private mapSpeedToRate(speed: number): string {\r\n    // Convert speed (0.25-4.0) to Azure rate format\r\n    if (speed <= 0.5) return \"x-slow\"\r\n    if (speed <= 0.75) return \"slow\"\r\n    if (speed <= 1.25) return \"medium\"\r\n    if (speed <= 1.5) return \"fast\"\r\n    return \"x-fast\"\r\n  }\r\n\r\n  private mapPitchToSSML(pitch: number): string {\r\n    // Convert pitch (0.5-2.0) to Azure pitch format\r\n    if (pitch <= 0.75) return \"low\"\r\n    if (pitch <= 1.25) return \"medium\"\r\n    return \"high\"\r\n  }\r\n\r\n  private escapeXML(text: string): string {\r\n    return text\r\n      .replace(/&/g, \"&amp;\")\r\n      .replace(/</g, \"&lt;\")\r\n      .replace(/>/g, \"&gt;\")\r\n      .replace(/\"/g, \"&quot;\")\r\n      .replace(/'/g, \"&apos;\")\r\n  }\r\n\r\n  private getDefaultVoices(): AIVoiceProfile[] {\r\n    return [\r\n      {\r\n        id: \"azure-jenny\",\r\n        name: \"Jenny\",\r\n        language: \"english\",\r\n        gender: \"female\",\r\n        accent: \"american\",\r\n        category: \"standard\",\r\n        provider: \"azure\"\r\n      },\r\n      {\r\n        id: \"azure-guy\",\r\n        name: \"Guy\",\r\n        language: \"english\",\r\n        gender: \"male\",\r\n        accent: \"american\",\r\n        category: \"announcement\",\r\n        provider: \"azure\"\r\n      },\r\n      {\r\n        id: \"azure-aria\",\r\n        name: \"Aria\",\r\n        language: \"english\",\r\n        gender: \"female\",\r\n        accent: \"american\",\r\n        category: \"announcement\",\r\n        provider: \"azure\"\r\n      },\r\n      {\r\n        id: \"azure-davis\",\r\n        name: \"Davis\",\r\n        language: \"english\",\r\n        gender: \"male\",\r\n        accent: \"american\",\r\n        category: \"standard\",\r\n        provider: \"azure\"\r\n      },\r\n      {\r\n        id: \"azure-jane\",\r\n        name: \"Jane\",\r\n        language: \"english\",\r\n        gender: \"female\",\r\n        accent: \"american\",\r\n        category: \"standard\",\r\n        provider: \"azure\"\r\n      },\r\n      {\r\n        id: \"azure-jason\",\r\n        name: \"Jason\",\r\n        language: \"english\",\r\n        gender: \"male\",\r\n        accent: \"american\",\r\n        category: \"announcement\",\r\n        provider: \"azure\"\r\n      }\r\n    ]\r\n  }\r\n\r\n  private mapAzureVoices(voices: any[]): AIVoiceProfile[] {\r\n    return voices\r\n      .filter(voice => voice.VoiceType === \"Neural\") // Only use neural voices\r\n      .map(voice => ({\r\n        id: `azure-${voice.ShortName.toLowerCase().replace(/[^a-z0-9]/g, '-')}`,\r\n        name: voice.DisplayName,\r\n        language: this.mapLocaleToLanguage(voice.Locale),\r\n        gender: voice.Gender.toLowerCase() as \"male\" | \"female\" | \"neutral\",\r\n        accent: this.extractAccent(voice.LocaleName),\r\n        category: this.categorizeVoice(voice.StyleList || []),\r\n        provider: \"azure\"\r\n      }))\r\n      .slice(0, 20) // Limit to first 20 voices to avoid overwhelming UI\r\n  }\r\n\r\n  private mapLocaleToLanguage(locale: string): string {\r\n    const languageMap: Record<string, string> = {\r\n      \"en-US\": \"english\",\r\n      \"en-GB\": \"english\",\r\n      \"en-AU\": \"english\",\r\n      \"en-CA\": \"english\",\r\n      \"es-ES\": \"spanish\",\r\n      \"es-MX\": \"spanish\",\r\n      \"fr-FR\": \"french\",\r\n      \"fr-CA\": \"french\",\r\n      \"de-DE\": \"german\",\r\n      \"it-IT\": \"italian\",\r\n      \"pt-BR\": \"portuguese\",\r\n      \"pt-PT\": \"portuguese\",\r\n      \"ru-RU\": \"russian\",\r\n      \"ja-JP\": \"japanese\",\r\n      \"ko-KR\": \"korean\",\r\n      \"zh-CN\": \"chinese\",\r\n      \"ar-SA\": \"arabic\",\r\n      \"hi-IN\": \"hindi\",\r\n      \"nl-NL\": \"dutch\",\r\n      \"sv-SE\": \"swedish\"\r\n    }\r\n    \r\n    return languageMap[locale] || \"english\"\r\n  }\r\n\r\n  private extractAccent(localeName: string): string | undefined {\r\n    if (localeName.includes(\"United States\")) return \"american\"\r\n    if (localeName.includes(\"United Kingdom\")) return \"british\"\r\n    if (localeName.includes(\"Australia\")) return \"australian\"\r\n    if (localeName.includes(\"Canada\")) return \"canadian\"\r\n    return undefined\r\n  }\r\n\r\n  private categorizeVoice(styleList: string[]): \"standard\" | \"religious\" | \"announcement\" | \"bell\" {\r\n    const styles = styleList.join(\" \").toLowerCase()\r\n    \r\n    if (styles.includes(\"newscast\") || styles.includes(\"announcement\")) {\r\n      return \"announcement\"\r\n    }\r\n    if (styles.includes(\"religious\") || styles.includes(\"prayer\")) {\r\n      return \"religious\"\r\n    }\r\n    return \"standard\"\r\n  }\r\n\r\n  private mapVoiceId(voiceId: string): { name: string; locale: string } {\r\n    // Map our voice IDs to Azure voice names\r\n    const voiceMap: Record<string, { name: string; locale: string }> = {\r\n      \"azure-jenny\": { name: \"en-US-JennyNeural\", locale: \"en-US\" },\r\n      \"azure-guy\": { name: \"en-US-GuyNeural\", locale: \"en-US\" },\r\n      \"azure-aria\": { name: \"en-US-AriaNeural\", locale: \"en-US\" },\r\n      \"azure-davis\": { name: \"en-US-DavisNeural\", locale: \"en-US\" },\r\n      \"azure-jane\": { name: \"en-US-JaneNeural\", locale: \"en-US\" },\r\n      \"azure-jason\": { name: \"en-US-JasonNeural\", locale: \"en-US\" }\r\n    }\r\n\r\n    return voiceMap[voiceId] || { name: \"en-US-JennyNeural\", locale: \"en-US\" }\r\n  }\r\n\r\n  private async handleErrorResponse(response: Response): Promise<never> {\r\n    const errorText = await response.text()\r\n    let errorData: any = {}\r\n    \r\n    try {\r\n      errorData = JSON.parse(errorText)\r\n    } catch {\r\n      // If JSON parsing fails, use the raw text\r\n    }\r\n\r\n    switch (response.status) {\r\n      case 401:\r\n      case 403:\r\n        throw new AuthenticationError(\"Azure\")\r\n      case 429:\r\n        const retryAfter = response.headers.get(\"retry-after\")\r\n        throw new RateLimitError(\"Azure\", retryAfter ? parseInt(retryAfter) : undefined)\r\n      case 500:\r\n      case 502:\r\n      case 503:\r\n      case 504:\r\n        throw new ServiceUnavailableError(\"Azure\")\r\n      default:\r\n        throw new AIVoiceError(\r\n          errorData.error?.message || `Azure API error: ${response.status}`,\r\n          \"Azure\",\r\n          `HTTP_${response.status}`,\r\n          response.status >= 500\r\n        )\r\n    }\r\n  }\r\n\r\n  private async convertMp3ToAudioBuffer(mp3ArrayBuffer: ArrayBuffer): Promise<AudioBuffer> {\r\n    // Create AudioContext\r\n    const AudioContext = window.AudioContext || (window as any).webkitAudioContext\r\n    const audioContext = new AudioContext()\r\n\r\n    try {\r\n      // Decode the MP3 data\r\n      const audioBuffer = await audioContext.decodeAudioData(mp3ArrayBuffer.slice(0))\r\n      return audioBuffer\r\n    } catch (error) {\r\n      throw new AIVoiceError(\r\n        \"Failed to decode audio data from Azure\",\r\n        \"Azure\",\r\n        \"DECODE_ERROR\",\r\n        false\r\n      )\r\n    }\r\n  }\r\n\r\n  // Utility method to check if a language is supported\r\n  isLanguageSupported(language: string): boolean {\r\n    const supportedLanguages = [\r\n      \"english\", \"spanish\", \"french\", \"german\", \"italian\", \"portuguese\", \r\n      \"russian\", \"japanese\", \"korean\", \"chinese\", \"arabic\", \"hindi\", \r\n      \"dutch\", \"swedish\", \"norwegian\", \"danish\", \"finnish\"\r\n    ]\r\n    return supportedLanguages.includes(language.toLowerCase())\r\n  }\r\n\r\n  // Get the maximum character limit for Azure\r\n  getMaxCharacters(): number {\r\n    return 10000\r\n  }\r\n\r\n  // Get supported audio formats\r\n  getSupportedFormats(): string[] {\r\n    return [\"mp3\", \"wav\", \"ogg\", \"webm\"]\r\n  }\r\n\r\n  // Update API key and region\r\n  updateCredentials(apiKey: string, endpoint?: string): void {\r\n    this.apiKey = apiKey\r\n    \r\n    if (endpoint) {\r\n      const match = endpoint.match(/https:\\/\\/([^.]+)\\.tts\\.speech\\.microsoft\\.com/)\r\n      this.region = match ? match[1] : \"eastus\"\r\n      this.baseUrl = endpoint\r\n    }\r\n  }\r\n\r\n  // Get current API key (masked for security)\r\n  getApiKeyMask(): string {\r\n    if (!this.apiKey) return \"\"\r\n    return this.apiKey.substring(0, 7) + \"...\" + this.apiKey.substring(this.apiKey.length - 4)\r\n  }\r\n\r\n  // Get current region\r\n  getRegion(): string {\r\n    return this.region\r\n  }\r\n\r\n  // Azure specific methods\r\n  async getVoiceStyles(voiceName: string): Promise<string[]> {\r\n    // This would require additional API calls to get voice styles\r\n    // For now, return common styles\r\n    return [\"default\", \"newscast\", \"customerservice\", \"chat\", \"cheerful\", \"empathetic\"]\r\n  }\r\n\r\n  async getSpeechSynthesisMarkup(text: string, voiceName: string, options?: {\r\n    rate?: string\r\n    pitch?: string\r\n    volume?: string\r\n    style?: string\r\n  }): Promise<string> {\r\n    const rate = options?.rate || \"medium\"\r\n    const pitch = options?.pitch || \"medium\"\r\n    const volume = options?.volume || \"medium\"\r\n    const style = options?.style || \"default\"\r\n    \r\n    return `\r\n      <speak version=\"1.0\" xmlns=\"http://www.w3.org/2001/10/synthesis\" xml:lang=\"en-US\">\r\n        <voice name=\"${voiceName}\">\r\n          <mstts:express-as style=\"${style}\">\r\n            <prosody rate=\"${rate}\" pitch=\"${pitch}\" volume=\"${volume}\">\r\n              ${this.escapeXML(text)}\r\n            </prosody>\r\n          </mstts:express-as>\r\n        </voice>\r\n      </speak>\r\n    `.trim()\r\n  }\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1802, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/providers/provider-factory.ts"],"sourcesContent":["import type { AIVoiceProvider, ProviderConfig, AIVoiceProviderType } from \"../ai-voice-types\"\r\nimport { OpenAIProvider } from \"./openai-provider\"\r\nimport { ElevenLabsProvider } from \"./elevenlabs-provider\"\r\nimport { AzureProvider } from \"./azure-provider\"\r\n\r\nexport class ProviderFactory {\r\n  private static providers: Map<string, AIVoiceProvider> = new Map()\r\n\r\n  static createProvider(\r\n    type: AIVoiceProviderType,\r\n    config: ProviderConfig\r\n  ): AIVoiceProvider {\r\n    const key = `${type}-${config.apiKey.substring(0, 8)}`\r\n    \r\n    // Return existing provider if already created with same config\r\n    if (this.providers.has(key)) {\r\n      const existingProvider = this.providers.get(key)!\r\n      return existingProvider\r\n    }\r\n\r\n    let provider: AIVoiceProvider\r\n\r\n    switch (type) {\r\n      case \"openai\":\r\n        provider = new OpenAIProvider(config.apiKey)\r\n        break\r\n      case \"elevenlabs\":\r\n        provider = new ElevenLabsProvider(config.apiKey)\r\n        break\r\n      case \"azure\":\r\n        provider = new AzureProvider(config.apiKey, config.endpoint)\r\n        break\r\n      default:\r\n        throw new Error(`Unknown provider type: ${type}`)\r\n    }\r\n\r\n    this.providers.set(key, provider)\r\n    return provider\r\n  }\r\n\r\n  static getProvider(\r\n    type: AIVoiceProviderType,\r\n    config: ProviderConfig\r\n  ): AIVoiceProvider | null {\r\n    const key = `${type}-${config.apiKey.substring(0, 8)}`\r\n    return this.providers.get(key) || null\r\n  }\r\n\r\n  static removeProvider(\r\n    type: AIVoiceProviderType,\r\n    config: ProviderConfig\r\n  ): void {\r\n    const key = `${type}-${config.apiKey.substring(0, 8)}`\r\n    this.providers.delete(key)\r\n  }\r\n\r\n  static clearAllProviders(): void {\r\n    this.providers.clear()\r\n  }\r\n\r\n  static getActiveProviders(): Array<{\r\n    type: AIVoiceProviderType\r\n    provider: AIVoiceProvider\r\n  }> {\r\n    const activeProviders: Array<{\r\n      type: AIVoiceProviderType\r\n      provider: AIVoiceProvider\r\n    }> = []\r\n\r\n    for (const [key, provider] of this.providers.entries()) {\r\n      const type = key.split(\"-\")[0] as AIVoiceProviderType\r\n      activeProviders.push({ type, provider })\r\n    }\r\n\r\n    return activeProviders\r\n  }\r\n\r\n  static async validateAllProviders(): Promise<Record<string, boolean>> {\r\n    const results: Record<string, boolean> = {}\r\n\r\n    for (const [key, provider] of this.providers.entries()) {\r\n      try {\r\n        results[key] = await provider.validateCredentials()\r\n      } catch (error) {\r\n        results[key] = false\r\n      }\r\n    }\r\n\r\n    return results\r\n  }\r\n\r\n  static getSupportedProviders(): AIVoiceProviderType[] {\r\n    return [\"openai\", \"elevenlabs\", \"azure\"]\r\n  }\r\n\r\n  static isProviderSupported(type: AIVoiceProviderType): boolean {\r\n    return this.getSupportedProviders().includes(type)\r\n  }\r\n}\r\n\r\n// Utility function to create provider with error handling\r\nexport const createProviderSafely = async (\r\n  type: AIVoiceProviderType,\r\n  config: ProviderConfig\r\n): Promise<{\r\n  provider: AIVoiceProvider | null\r\n  error: string | null\r\n}> => {\r\n  try {\r\n    if (!ProviderFactory.isProviderSupported(type)) {\r\n      return {\r\n        provider: null,\r\n        error: `Provider ${type} is not yet supported`\r\n      }\r\n    }\r\n\r\n    const provider = ProviderFactory.createProvider(type, config)\r\n    \r\n    // Validate credentials\r\n    const isValid = await provider.validateCredentials()\r\n    if (!isValid) {\r\n      return {\r\n        provider: null,\r\n        error: `Invalid credentials for ${type} provider`\r\n      }\r\n    }\r\n\r\n    return {\r\n      provider,\r\n      error: null\r\n    }\r\n  } catch (error) {\r\n    return {\r\n      provider: null,\r\n      error: error instanceof Error ? error.message : `Failed to create ${type} provider`\r\n    }\r\n  }\r\n}"],"names":[],"mappings":";;;;;;AACA;AACA;AACA;;;;AAEO,MAAM;IACX,OAAe,YAA0C,IAAI,MAAK;IAElE,OAAO,eACL,IAAyB,EACzB,MAAsB,EACL;QACjB,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,OAAO,MAAM,CAAC,SAAS,CAAC,GAAG,IAAI;QAEtD,+DAA+D;QAC/D,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM;YAC3B,MAAM,mBAAmB,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;YAC5C,OAAO;QACT;QAEA,IAAI;QAEJ,OAAQ;YACN,KAAK;gBACH,WAAW,IAAI,iMAAc,CAAC,OAAO,MAAM;gBAC3C;YACF,KAAK;gBACH,WAAW,IAAI,yMAAkB,CAAC,OAAO,MAAM;gBAC/C;YACF,KAAK;gBACH,WAAW,IAAI,+LAAa,CAAC,OAAO,MAAM,EAAE,OAAO,QAAQ;gBAC3D;YACF;gBACE,MAAM,IAAI,MAAM,CAAC,uBAAuB,EAAE,MAAM;QACpD;QAEA,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK;QACxB,OAAO;IACT;IAEA,OAAO,YACL,IAAyB,EACzB,MAAsB,EACE;QACxB,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,OAAO,MAAM,CAAC,SAAS,CAAC,GAAG,IAAI;QACtD,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ;IACpC;IAEA,OAAO,eACL,IAAyB,EACzB,MAAsB,EAChB;QACN,MAAM,MAAM,GAAG,KAAK,CAAC,EAAE,OAAO,MAAM,CAAC,SAAS,CAAC,GAAG,IAAI;QACtD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;IACxB;IAEA,OAAO,oBAA0B;QAC/B,IAAI,CAAC,SAAS,CAAC,KAAK;IACtB;IAEA,OAAO,qBAGJ;QACD,MAAM,kBAGD,EAAE;QAEP,KAAK,MAAM,CAAC,KAAK,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,OAAO,GAAI;YACtD,MAAM,OAAO,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE;YAC9B,gBAAgB,IAAI,CAAC;gBAAE;gBAAM;YAAS;QACxC;QAEA,OAAO;IACT;IAEA,aAAa,uBAAyD;QACpE,MAAM,UAAmC,CAAC;QAE1C,KAAK,MAAM,CAAC,KAAK,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,OAAO,GAAI;YACtD,IAAI;gBACF,OAAO,CAAC,IAAI,GAAG,MAAM,SAAS,mBAAmB;YACnD,EAAE,OAAO,OAAO;gBACd,OAAO,CAAC,IAAI,GAAG;YACjB;QACF;QAEA,OAAO;IACT;IAEA,OAAO,wBAA+C;QACpD,OAAO;YAAC;YAAU;YAAc;SAAQ;IAC1C;IAEA,OAAO,oBAAoB,IAAyB,EAAW;QAC7D,OAAO,IAAI,CAAC,qBAAqB,GAAG,QAAQ,CAAC;IAC/C;AACF;AAGO,MAAM,uBAAuB,OAClC,MACA;IAKA,IAAI;QACF,IAAI,CAAC,gBAAgB,mBAAmB,CAAC,OAAO;YAC9C,OAAO;gBACL,UAAU;gBACV,OAAO,CAAC,SAAS,EAAE,KAAK,qBAAqB,CAAC;YAChD;QACF;QAEA,MAAM,WAAW,gBAAgB,cAAc,CAAC,MAAM;QAEtD,uBAAuB;QACvB,MAAM,UAAU,MAAM,SAAS,mBAAmB;QAClD,IAAI,CAAC,SAAS;YACZ,OAAO;gBACL,UAAU;gBACV,OAAO,CAAC,wBAAwB,EAAE,KAAK,SAAS,CAAC;YACnD;QACF;QAEA,OAAO;YACL;YACA,OAAO;QACT;IACF,EAAE,OAAO,OAAO;QACd,OAAO;YACL,UAAU;YACV,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG,CAAC,iBAAiB,EAAE,KAAK,SAAS,CAAC;QACrF;IACF;AACF"}},
    {"offset": {"line": 1916, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/audio-cache.ts"],"sourcesContent":["import type { AudioCacheManager, CacheMetadata, CacheStats } from \"./ai-voice-types\"\r\nimport { generateCacheKey } from \"./ai-voice-constants\"\r\n\r\n// IndexedDB database configuration\r\nconst DB_NAME = \"AIVoiceCache\"\r\nconst DB_VERSION = 1\r\nconst AUDIO_STORE = \"audioFiles\"\r\nconst METADATA_STORE = \"metadata\"\r\n\r\ninterface StoredAudioData {\r\n  key: string\r\n  audioBuffer: ArrayBuffer\r\n  metadata: CacheMetadata\r\n}\r\n\r\ninterface StoredMetadata extends CacheMetadata {\r\n  key: string\r\n}\r\n\r\nexport class IndexedDBAudioCache implements AudioCacheManager {\r\n  private db: IDBDatabase | null = null\r\n  private initPromise: Promise<void> | null = null\r\n\r\n  constructor() {\r\n    this.initPromise = this.initializeDB()\r\n  }\r\n\r\n  private async initializeDB(): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      if (typeof window === \"undefined\" || !window.indexedDB) {\r\n        reject(new Error(\"IndexedDB not available\"))\r\n        return\r\n      }\r\n\r\n      const request = indexedDB.open(DB_NAME, DB_VERSION)\r\n\r\n      request.onerror = () => {\r\n        reject(new Error(\"Failed to open IndexedDB\"))\r\n      }\r\n\r\n      request.onsuccess = () => {\r\n        this.db = request.result\r\n        resolve()\r\n      }\r\n\r\n      request.onupgradeneeded = (event) => {\r\n        const db = (event.target as IDBOpenDBRequest).result\r\n\r\n        // Create audio files store\r\n        if (!db.objectStoreNames.contains(AUDIO_STORE)) {\r\n          const audioStore = db.createObjectStore(AUDIO_STORE, { keyPath: \"key\" })\r\n          audioStore.createIndex(\"timestamp\", \"metadata.timestamp\", { unique: false })\r\n          audioStore.createIndex(\"provider\", \"metadata.provider\", { unique: false })\r\n          audioStore.createIndex(\"usage\", \"metadata.usage\", { unique: false })\r\n        }\r\n\r\n        // Create metadata store for quick queries\r\n        if (!db.objectStoreNames.contains(METADATA_STORE)) {\r\n          const metadataStore = db.createObjectStore(METADATA_STORE, { keyPath: \"key\" })\r\n          metadataStore.createIndex(\"timestamp\", \"timestamp\", { unique: false })\r\n          metadataStore.createIndex(\"provider\", \"provider\", { unique: false })\r\n          metadataStore.createIndex(\"size\", \"size\", { unique: false })\r\n          metadataStore.createIndex(\"usage\", \"usage\", { unique: false })\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  private async ensureDB(): Promise<IDBDatabase> {\r\n    if (!this.initPromise) {\r\n      this.initPromise = this.initializeDB()\r\n    }\r\n    await this.initPromise\r\n\r\n    if (!this.db) {\r\n      throw new Error(\"Database not initialized\")\r\n    }\r\n    return this.db\r\n  }\r\n\r\n  async store(key: string, audio: AudioBuffer, metadata: CacheMetadata): Promise<void> {\r\n    const db = await this.ensureDB()\r\n\r\n    // Convert AudioBuffer to ArrayBuffer for storage\r\n    const arrayBuffer = this.audioBufferToArrayBuffer(audio)\r\n\r\n    const audioData: StoredAudioData = {\r\n      key,\r\n      audioBuffer: arrayBuffer,\r\n      metadata: {\r\n        ...metadata,\r\n        timestamp: Date.now(),\r\n        size: arrayBuffer.byteLength\r\n      }\r\n    }\r\n\r\n    const metadataRecord: StoredMetadata = {\r\n      key,\r\n      ...audioData.metadata\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction([AUDIO_STORE, METADATA_STORE], \"readwrite\")\r\n      \r\n      transaction.onerror = () => {\r\n        reject(new Error(\"Failed to store audio data\"))\r\n      }\r\n\r\n      transaction.oncomplete = () => {\r\n        resolve()\r\n      }\r\n\r\n      // Store audio data\r\n      const audioStore = transaction.objectStore(AUDIO_STORE)\r\n      audioStore.put(audioData)\r\n\r\n      // Store metadata separately for quick queries\r\n      const metadataStore = transaction.objectStore(METADATA_STORE)\r\n      metadataStore.put(metadataRecord)\r\n    })\r\n  }\r\n\r\n  async retrieve(key: string): Promise<AudioBuffer | null> {\r\n    const db = await this.ensureDB()\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction([AUDIO_STORE, METADATA_STORE], \"readwrite\")\r\n      const audioStore = transaction.objectStore(AUDIO_STORE)\r\n      const metadataStore = transaction.objectStore(METADATA_STORE)\r\n\r\n      const request = audioStore.get(key)\r\n\r\n      request.onerror = () => {\r\n        reject(new Error(\"Failed to retrieve audio data\"))\r\n      }\r\n\r\n      request.onsuccess = () => {\r\n        const result = request.result as StoredAudioData | undefined\r\n\r\n        if (!result) {\r\n          resolve(null)\r\n          return\r\n        }\r\n\r\n        try {\r\n          // Convert ArrayBuffer back to AudioBuffer\r\n          const audioBuffer = this.arrayBufferToAudioBuffer(result.audioBuffer)\r\n          \r\n          // Update usage count\r\n          const updateRequest = metadataStore.get(key)\r\n          updateRequest.onsuccess = () => {\r\n            const metadata = updateRequest.result as StoredMetadata\r\n            if (metadata) {\r\n              metadata.usage += 1\r\n              metadataStore.put(metadata)\r\n              \r\n              // Also update in audio store\r\n              result.metadata.usage += 1\r\n              audioStore.put(result)\r\n            }\r\n          }\r\n\r\n          resolve(audioBuffer)\r\n        } catch (error) {\r\n          reject(new Error(\"Failed to convert stored data to AudioBuffer\"))\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  async exists(key: string): Promise<boolean> {\r\n    const db = await this.ensureDB()\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(METADATA_STORE, \"readonly\")\r\n      const store = transaction.objectStore(METADATA_STORE)\r\n      const request = store.count(key)\r\n\r\n      request.onerror = () => {\r\n        reject(new Error(\"Failed to check if key exists\"))\r\n      }\r\n\r\n      request.onsuccess = () => {\r\n        resolve(request.result > 0)\r\n      }\r\n    })\r\n  }\r\n\r\n  async clear(pattern?: string): Promise<void> {\r\n    const db = await this.ensureDB()\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction([AUDIO_STORE, METADATA_STORE], \"readwrite\")\r\n      \r\n      transaction.onerror = () => {\r\n        reject(new Error(\"Failed to clear cache\"))\r\n      }\r\n\r\n      transaction.oncomplete = () => {\r\n        resolve()\r\n      }\r\n\r\n      if (!pattern) {\r\n        // Clear all data\r\n        transaction.objectStore(AUDIO_STORE).clear()\r\n        transaction.objectStore(METADATA_STORE).clear()\r\n      } else {\r\n        // Clear data matching pattern\r\n        this.clearByPattern(transaction, pattern)\r\n      }\r\n    })\r\n  }\r\n\r\n  private clearByPattern(transaction: IDBTransaction, pattern: string): void {\r\n    const metadataStore = transaction.objectStore(METADATA_STORE)\r\n    const audioStore = transaction.objectStore(AUDIO_STORE)\r\n    \r\n    const request = metadataStore.openCursor()\r\n    \r\n    request.onsuccess = (event) => {\r\n      const cursor = (event.target as IDBRequest).result as IDBCursorWithValue\r\n      \r\n      if (cursor) {\r\n        const metadata = cursor.value as StoredMetadata\r\n        \r\n        // Simple pattern matching - check if key contains pattern\r\n        if (metadata.key.includes(pattern) || \r\n            metadata.provider.includes(pattern) ||\r\n            metadata.voice.includes(pattern)) {\r\n          \r\n          // Delete from both stores\r\n          audioStore.delete(metadata.key)\r\n          metadataStore.delete(metadata.key)\r\n        }\r\n        \r\n        cursor.continue()\r\n      }\r\n    }\r\n  }\r\n\r\n  async getUsageStats(): Promise<CacheStats> {\r\n    const db = await this.ensureDB()\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction(METADATA_STORE, \"readonly\")\r\n      const store = transaction.objectStore(METADATA_STORE)\r\n      const request = store.openCursor()\r\n\r\n      let totalSize = 0\r\n      let totalFiles = 0\r\n      let totalUsage = 0\r\n      let oldestFile = Date.now()\r\n      let newestFile = 0\r\n\r\n      request.onerror = () => {\r\n        reject(new Error(\"Failed to get usage stats\"))\r\n      }\r\n\r\n      request.onsuccess = (event) => {\r\n        const cursor = (event.target as IDBRequest).result as IDBCursorWithValue\r\n\r\n        if (cursor) {\r\n          const metadata = cursor.value as StoredMetadata\r\n          \r\n          totalSize += metadata.size\r\n          totalFiles += 1\r\n          totalUsage += metadata.usage\r\n          \r\n          if (metadata.timestamp < oldestFile) {\r\n            oldestFile = metadata.timestamp\r\n          }\r\n          \r\n          if (metadata.timestamp > newestFile) {\r\n            newestFile = metadata.timestamp\r\n          }\r\n\r\n          cursor.continue()\r\n        } else {\r\n          // Calculate hit rate (simplified - based on average usage)\r\n          const hitRate = totalFiles > 0 ? (totalUsage / totalFiles) * 100 : 0\r\n\r\n          resolve({\r\n            totalSize,\r\n            totalFiles,\r\n            hitRate: Math.min(hitRate, 100), // Cap at 100%\r\n            oldestFile: totalFiles > 0 ? oldestFile : 0,\r\n            newestFile: totalFiles > 0 ? newestFile : 0\r\n          })\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  async cleanup(): Promise<void> {\r\n    const stats = await this.getUsageStats()\r\n    const maxSize = 100 * 1024 * 1024 // 100MB default\r\n    const maxAge = 30 * 24 * 60 * 60 * 1000 // 30 days in milliseconds\r\n\r\n    if (stats.totalSize <= maxSize) {\r\n      // Only clean up old files if not over size limit\r\n      await this.cleanupOldFiles(maxAge)\r\n      return\r\n    }\r\n\r\n    // If over size limit, clean up least used files first\r\n    await this.cleanupLeastUsedFiles(maxSize)\r\n  }\r\n\r\n  private async cleanupOldFiles(maxAge: number): Promise<void> {\r\n    const db = await this.ensureDB()\r\n    const cutoffTime = Date.now() - maxAge\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction([AUDIO_STORE, METADATA_STORE], \"readwrite\")\r\n      \r\n      transaction.onerror = () => {\r\n        reject(new Error(\"Failed to cleanup old files\"))\r\n      }\r\n\r\n      transaction.oncomplete = () => {\r\n        resolve()\r\n      }\r\n\r\n      const metadataStore = transaction.objectStore(METADATA_STORE)\r\n      const audioStore = transaction.objectStore(AUDIO_STORE)\r\n      const index = metadataStore.index(\"timestamp\")\r\n      \r\n      const request = index.openCursor(IDBKeyRange.upperBound(cutoffTime))\r\n      \r\n      request.onsuccess = (event) => {\r\n        const cursor = (event.target as IDBRequest).result as IDBCursorWithValue\r\n        \r\n        if (cursor) {\r\n          const metadata = cursor.value as StoredMetadata\r\n          \r\n          // Delete old files\r\n          audioStore.delete(metadata.key)\r\n          metadataStore.delete(metadata.key)\r\n          \r\n          cursor.continue()\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  private async cleanupLeastUsedFiles(maxSize: number): Promise<void> {\r\n    const db = await this.ensureDB()\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = db.transaction([AUDIO_STORE, METADATA_STORE], \"readwrite\")\r\n      \r\n      transaction.onerror = () => {\r\n        reject(new Error(\"Failed to cleanup least used files\"))\r\n      }\r\n\r\n      transaction.oncomplete = () => {\r\n        resolve()\r\n      }\r\n\r\n      const metadataStore = transaction.objectStore(METADATA_STORE)\r\n      const audioStore = transaction.objectStore(AUDIO_STORE)\r\n      const index = metadataStore.index(\"usage\")\r\n      \r\n      let currentSize = 0\r\n      const request = index.openCursor() // Opens in ascending order (least used first)\r\n      \r\n      request.onsuccess = (event) => {\r\n        const cursor = (event.target as IDBRequest).result as IDBCursorWithValue\r\n        \r\n        if (cursor && currentSize < maxSize) {\r\n          const metadata = cursor.value as StoredMetadata\r\n          currentSize += metadata.size\r\n          \r\n          if (currentSize > maxSize) {\r\n            // Delete this file to get under the limit\r\n            audioStore.delete(metadata.key)\r\n            metadataStore.delete(metadata.key)\r\n          }\r\n          \r\n          cursor.continue()\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  // Utility methods for AudioBuffer conversion\r\n  private audioBufferToArrayBuffer(audioBuffer: AudioBuffer): ArrayBuffer {\r\n    const numberOfChannels = audioBuffer.numberOfChannels\r\n    const length = audioBuffer.length\r\n    const sampleRate = audioBuffer.sampleRate\r\n\r\n    // Create a simple format: [numberOfChannels, length, sampleRate, ...channelData]\r\n    const headerSize = 3 * 4 // 3 32-bit integers\r\n    const dataSize = numberOfChannels * length * 4 // 32-bit floats\r\n    const arrayBuffer = new ArrayBuffer(headerSize + dataSize)\r\n    \r\n    const headerView = new Int32Array(arrayBuffer, 0, 3)\r\n    headerView[0] = numberOfChannels\r\n    headerView[1] = length\r\n    headerView[2] = sampleRate\r\n\r\n    let offset = headerSize\r\n    for (let channel = 0; channel < numberOfChannels; channel++) {\r\n      const channelData = audioBuffer.getChannelData(channel)\r\n      const channelView = new Float32Array(arrayBuffer, offset, length)\r\n      channelView.set(channelData)\r\n      offset += length * 4\r\n    }\r\n\r\n    return arrayBuffer\r\n  }\r\n\r\n  private arrayBufferToAudioBuffer(arrayBuffer: ArrayBuffer): AudioBuffer {\r\n    const headerView = new Int32Array(arrayBuffer, 0, 3)\r\n    const numberOfChannels = headerView[0]\r\n    const length = headerView[1]\r\n    const sampleRate = headerView[2]\r\n\r\n    // Create AudioContext if not available (for Node.js environments)\r\n    const AudioContext = window.AudioContext || (window as any).webkitAudioContext\r\n    const audioContext = new AudioContext()\r\n    \r\n    const audioBuffer = audioContext.createBuffer(numberOfChannels, length, sampleRate)\r\n\r\n    let offset = 3 * 4 // Skip header\r\n    for (let channel = 0; channel < numberOfChannels; channel++) {\r\n      const channelView = new Float32Array(arrayBuffer, offset, length)\r\n      const channelData = audioBuffer.getChannelData(channel)\r\n      channelData.set(channelView)\r\n      offset += length * 4\r\n    }\r\n\r\n    return audioBuffer\r\n  }\r\n}\r\n\r\n// Factory function to create cache instance\r\nexport const createAudioCache = (): AudioCacheManager => {\r\n  return new IndexedDBAudioCache()\r\n}\r\n\r\n// Singleton instance for global use\r\nlet cacheInstance: AudioCacheManager | null = null\r\n\r\nexport const getAudioCache = (): AudioCacheManager => {\r\n  if (!cacheInstance) {\r\n    cacheInstance = createAudioCache()\r\n  }\r\n  return cacheInstance\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2267, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/cache-manager.ts"],"sourcesContent":["import type { AudioCacheManager, CacheMetadata, CacheStats, AIVoiceSettings } from \"./ai-voice-types\"\r\nimport { getAudioCache } from \"./audio-cache\"\r\nimport { generateCacheKey } from \"./ai-voice-constants\"\r\n\r\nexport class CacheManager {\r\n  private cache: AudioCacheManager\r\n  private settings: AIVoiceSettings | null = null\r\n\r\n  constructor(cache?: AudioCacheManager) {\r\n    this.cache = cache || getAudioCache()\r\n  }\r\n\r\n  updateSettings(settings: AIVoiceSettings): void {\r\n    this.settings = settings\r\n  }\r\n\r\n  async storeAudio(\r\n    text: string,\r\n    voice: string,\r\n    provider: string,\r\n    audioBuffer: AudioBuffer\r\n  ): Promise<void> {\r\n    if (!this.settings?.cacheSettings.enabled) {\r\n      return\r\n    }\r\n\r\n    const key = generateCacheKey(text, voice, provider)\r\n    const metadata: CacheMetadata = {\r\n      text: text.substring(0, 100), // Store first 100 chars for reference\r\n      voice,\r\n      provider,\r\n      timestamp: Date.now(),\r\n      size: this.estimateAudioBufferSize(audioBuffer),\r\n      usage: 0\r\n    }\r\n\r\n    await this.cache.store(key, audioBuffer, metadata)\r\n    \r\n    // Check if cleanup is needed after storing\r\n    await this.performMaintenanceIfNeeded()\r\n  }\r\n\r\n  async retrieveAudio(\r\n    text: string,\r\n    voice: string,\r\n    provider: string\r\n  ): Promise<AudioBuffer | null> {\r\n    if (!this.settings?.cacheSettings.enabled) {\r\n      return null\r\n    }\r\n\r\n    const key = generateCacheKey(text, voice, provider)\r\n    return await this.cache.retrieve(key)\r\n  }\r\n\r\n  async hasAudio(\r\n    text: string,\r\n    voice: string,\r\n    provider: string\r\n  ): Promise<boolean> {\r\n    if (!this.settings?.cacheSettings.enabled) {\r\n      return false\r\n    }\r\n\r\n    const key = generateCacheKey(text, voice, provider)\r\n    return await this.cache.exists(key)\r\n  }\r\n\r\n  async clearProviderCache(provider: string): Promise<void> {\r\n    await this.cache.clear(provider)\r\n  }\r\n\r\n  async clearVoiceCache(voice: string): Promise<void> {\r\n    await this.cache.clear(voice)\r\n  }\r\n\r\n  async clearAllCache(): Promise<void> {\r\n    await this.cache.clear()\r\n  }\r\n\r\n  async getCacheStats(): Promise<CacheStats> {\r\n    return await this.cache.getUsageStats()\r\n  }\r\n\r\n  async getCacheHealth(): Promise<{\r\n    healthy: boolean\r\n    issues: string[]\r\n    recommendations: string[]\r\n  }> {\r\n    const stats = await this.getCacheStats()\r\n    const issues: string[] = []\r\n    const recommendations: string[] = []\r\n    \r\n    const maxSize = (this.settings?.cacheSettings.maxSize || 100) * 1024 * 1024 // Convert MB to bytes\r\n    const maxAge = (this.settings?.cacheSettings.maxAge || 30) * 24 * 60 * 60 * 1000 // Convert days to ms\r\n\r\n    // Check size\r\n    if (stats.totalSize > maxSize * 0.9) {\r\n      issues.push(\"Cache is approaching size limit\")\r\n      recommendations.push(\"Consider increasing cache size or cleaning up old files\")\r\n    }\r\n\r\n    // Check age of oldest files\r\n    const oldestAge = Date.now() - stats.oldestFile\r\n    if (oldestAge > maxAge) {\r\n      issues.push(\"Cache contains very old files\")\r\n      recommendations.push(\"Run cache cleanup to remove expired files\")\r\n    }\r\n\r\n    // Check hit rate\r\n    if (stats.hitRate < 20) {\r\n      issues.push(\"Low cache hit rate\")\r\n      recommendations.push(\"Consider adjusting voice generation patterns or cache settings\")\r\n    }\r\n\r\n    // Check file count\r\n    if (stats.totalFiles > 1000) {\r\n      issues.push(\"Large number of cached files\")\r\n      recommendations.push(\"Consider more aggressive cleanup policies\")\r\n    }\r\n\r\n    return {\r\n      healthy: issues.length === 0,\r\n      issues,\r\n      recommendations\r\n    }\r\n  }\r\n\r\n  async performMaintenance(): Promise<{\r\n    filesRemoved: number\r\n    spaceSaved: number\r\n    errors: string[]\r\n  }> {\r\n    const beforeStats = await this.getCacheStats()\r\n    const errors: string[] = []\r\n\r\n    try {\r\n      await this.cache.cleanup()\r\n    } catch (error) {\r\n      errors.push(`Cleanup failed: ${error instanceof Error ? error.message : 'Unknown error'}`)\r\n    }\r\n\r\n    const afterStats = await this.getCacheStats()\r\n    \r\n    return {\r\n      filesRemoved: beforeStats.totalFiles - afterStats.totalFiles,\r\n      spaceSaved: beforeStats.totalSize - afterStats.totalSize,\r\n      errors\r\n    }\r\n  }\r\n\r\n  private async performMaintenanceIfNeeded(): Promise<void> {\r\n    if (!this.settings) return\r\n\r\n    const stats = await this.getCacheStats()\r\n    const maxSize = this.settings.cacheSettings.maxSize * 1024 * 1024 // Convert MB to bytes\r\n\r\n    // Perform maintenance if over 90% of max size\r\n    if (stats.totalSize > maxSize * 0.9) {\r\n      try {\r\n        await this.cache.cleanup()\r\n      } catch (error) {\r\n        console.warn(\"Cache maintenance failed:\", error)\r\n      }\r\n    }\r\n  }\r\n\r\n  private estimateAudioBufferSize(audioBuffer: AudioBuffer): number {\r\n    // Estimate size: numberOfChannels * length * 4 bytes per sample + overhead\r\n    return audioBuffer.numberOfChannels * audioBuffer.length * 4 + 100\r\n  }\r\n\r\n  // Utility methods for cache optimization\r\n  async getTopUsedVoices(limit: number = 10): Promise<Array<{\r\n    voice: string\r\n    provider: string\r\n    usage: number\r\n    size: number\r\n  }>> {\r\n    // This would require extending the cache interface to support more complex queries\r\n    // For now, return empty array - can be implemented later if needed\r\n    return []\r\n  }\r\n\r\n  async getCacheUsageByProvider(): Promise<Record<string, {\r\n    files: number\r\n    size: number\r\n    usage: number\r\n  }>> {\r\n    // This would require extending the cache interface to support aggregation queries\r\n    // For now, return empty object - can be implemented later if needed\r\n    return {}\r\n  }\r\n\r\n  async optimizeCache(): Promise<{\r\n    duplicatesRemoved: number\r\n    spaceSaved: number\r\n    optimizationApplied: string[]\r\n  }> {\r\n    const optimizationApplied: string[] = []\r\n    let duplicatesRemoved = 0\r\n    let spaceSaved = 0\r\n\r\n    // Future optimization strategies:\r\n    // 1. Remove duplicate content with different keys\r\n    // 2. Compress old audio files\r\n    // 3. Convert to more efficient formats\r\n    // 4. Merge similar content\r\n\r\n    optimizationApplied.push(\"Basic cleanup performed\")\r\n\r\n    try {\r\n      const maintenanceResult = await this.performMaintenance()\r\n      spaceSaved = maintenanceResult.spaceSaved\r\n      optimizationApplied.push(\"Expired files removed\")\r\n    } catch (error) {\r\n      console.warn(\"Cache optimization failed:\", error)\r\n    }\r\n\r\n    return {\r\n      duplicatesRemoved,\r\n      spaceSaved,\r\n      optimizationApplied\r\n    }\r\n  }\r\n}\r\n\r\n// Global cache manager instance\r\nlet cacheManagerInstance: CacheManager | null = null\r\n\r\nexport const getCacheManager = (): CacheManager => {\r\n  if (!cacheManagerInstance) {\r\n    cacheManagerInstance = new CacheManager()\r\n  }\r\n  return cacheManagerInstance\r\n}\r\n\r\nexport const initializeCacheManager = (settings: AIVoiceSettings): CacheManager => {\r\n  const manager = getCacheManager()\r\n  manager.updateSettings(settings)\r\n  return manager\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2451, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/rate-limiter.ts"],"sourcesContent":["import type { AIVoiceProviderType, ProviderConfig, AudioGenerationRequest } from \"./ai-voice-types\"\r\n\r\ninterface RateLimitState {\r\n  requests: number[]\r\n  characters: number[]\r\n  lastReset: number\r\n}\r\n\r\ninterface QueuedRequest {\r\n  id: string\r\n  request: AudioGenerationRequest\r\n  resolve: (value: any) => void\r\n  reject: (error: any) => void\r\n  timestamp: number\r\n  retryCount: number\r\n}\r\n\r\nexport class RateLimiter {\r\n  private limits: Map<AIVoiceProviderType, ProviderConfig['rateLimit']> = new Map()\r\n  private state: Map<AIVoiceProviderType, RateLimitState> = new Map()\r\n  private queues: Map<AIVoiceProviderType, QueuedRequest[]> = new Map()\r\n  private processing: Map<AIVoiceProviderType, boolean> = new Map()\r\n  \r\n  private readonly MINUTE_MS = 60 * 1000\r\n  private readonly DAY_MS = 24 * 60 * 60 * 1000\r\n  private readonly MAX_QUEUE_SIZE = 100\r\n  private readonly MAX_RETRY_COUNT = 3\r\n  private readonly RETRY_DELAY_BASE = 1000 // 1 second\r\n\r\n  constructor() {\r\n    // Start queue processing\r\n    this.startQueueProcessor()\r\n  }\r\n\r\n  updateProviderLimits(provider: AIVoiceProviderType, limits: ProviderConfig['rateLimit']): void {\r\n    this.limits.set(provider, limits)\r\n    \r\n    if (!this.state.has(provider)) {\r\n      this.state.set(provider, {\r\n        requests: [],\r\n        characters: [],\r\n        lastReset: Date.now()\r\n      })\r\n    }\r\n    \r\n    if (!this.queues.has(provider)) {\r\n      this.queues.set(provider, [])\r\n    }\r\n    \r\n    if (!this.processing.has(provider)) {\r\n      this.processing.set(provider, false)\r\n    }\r\n  }\r\n\r\n  async executeWithRateLimit<T>(\r\n    provider: AIVoiceProviderType,\r\n    request: AudioGenerationRequest,\r\n    executor: () => Promise<T>\r\n  ): Promise<T> {\r\n    return new Promise((resolve, reject) => {\r\n      const queuedRequest: QueuedRequest = {\r\n        id: request.id,\r\n        request,\r\n        resolve,\r\n        reject,\r\n        timestamp: Date.now(),\r\n        retryCount: 0\r\n      }\r\n\r\n      this.enqueueRequest(provider, queuedRequest, executor)\r\n    })\r\n  }\r\n\r\n  private enqueueRequest<T>(\r\n    provider: AIVoiceProviderType,\r\n    queuedRequest: QueuedRequest,\r\n    executor: () => Promise<T>\r\n  ): void {\r\n    const queue = this.queues.get(provider)\r\n    if (!queue) {\r\n      queuedRequest.reject(new Error(`Provider ${provider} not configured`))\r\n      return\r\n    }\r\n\r\n    // Check queue size limit\r\n    if (queue.length >= this.MAX_QUEUE_SIZE) {\r\n      queuedRequest.reject(new Error(`Queue full for provider ${provider}`))\r\n      return\r\n    }\r\n\r\n    // Add executor to the request\r\n    (queuedRequest as any).executor = executor\r\n\r\n    // Priority queue: high priority requests go first\r\n    if (queuedRequest.request.priority === 'high') {\r\n      queue.unshift(queuedRequest)\r\n    } else {\r\n      queue.push(queuedRequest)\r\n    }\r\n\r\n    // Start processing if not already running\r\n    this.processQueue(provider)\r\n  }\r\n\r\n  private async processQueue(provider: AIVoiceProviderType): Promise<void> {\r\n    if (this.processing.get(provider)) {\r\n      return // Already processing\r\n    }\r\n\r\n    this.processing.set(provider, true)\r\n\r\n    const queue = this.queues.get(provider)\r\n    if (!queue) {\r\n      this.processing.set(provider, false)\r\n      return\r\n    }\r\n\r\n    while (queue.length > 0) {\r\n      const queuedRequest = queue.shift()!\r\n      \r\n      try {\r\n        // Check if request has expired (older than 5 minutes)\r\n        if (Date.now() - queuedRequest.timestamp > 5 * 60 * 1000) {\r\n          queuedRequest.reject(new Error(\"Request expired\"))\r\n          continue\r\n        }\r\n\r\n        // Wait for rate limit availability\r\n        await this.waitForRateLimit(provider, queuedRequest.request)\r\n\r\n        // Execute the request\r\n        const executor = (queuedRequest as any).executor\r\n        const result = await executor()\r\n        \r\n        // Record the request\r\n        this.recordRequest(provider, queuedRequest.request)\r\n        \r\n        queuedRequest.resolve(result)\r\n      } catch (error) {\r\n        // Handle retries\r\n        if (queuedRequest.retryCount < this.MAX_RETRY_COUNT && this.isRetryableError(error)) {\r\n          queuedRequest.retryCount++\r\n          \r\n          // Exponential backoff\r\n          const delay = this.RETRY_DELAY_BASE * Math.pow(2, queuedRequest.retryCount - 1)\r\n          \r\n          setTimeout(() => {\r\n            queue.push(queuedRequest) // Re-queue for retry\r\n          }, delay)\r\n        } else {\r\n          queuedRequest.reject(error)\r\n        }\r\n      }\r\n    }\r\n\r\n    this.processing.set(provider, false)\r\n  }\r\n\r\n  private async waitForRateLimit(\r\n    provider: AIVoiceProviderType,\r\n    request: AudioGenerationRequest\r\n  ): Promise<void> {\r\n    const limits = this.limits.get(provider)\r\n    if (!limits) return\r\n\r\n    while (true) {\r\n      if (this.canMakeRequest(provider, request)) {\r\n        return\r\n      }\r\n\r\n      // Wait before checking again\r\n      await this.sleep(1000) // Wait 1 second\r\n    }\r\n  }\r\n\r\n  private canMakeRequest(\r\n    provider: AIVoiceProviderType,\r\n    request: AudioGenerationRequest\r\n  ): boolean {\r\n    const limits = this.limits.get(provider)\r\n    const state = this.state.get(provider)\r\n    \r\n    if (!limits || !state) return true\r\n\r\n    const now = Date.now()\r\n    \r\n    // Clean up old entries\r\n    this.cleanupOldEntries(state, now)\r\n\r\n    // Check requests per minute limit\r\n    if (state.requests.length >= limits.requestsPerMinute) {\r\n      return false\r\n    }\r\n\r\n    // Check characters per day limit\r\n    const todayCharacters = state.characters.reduce((sum, chars) => sum + chars, 0)\r\n    if (todayCharacters + request.text.length > limits.charactersPerDay) {\r\n      return false\r\n    }\r\n\r\n    return true\r\n  }\r\n\r\n  private cleanupOldEntries(state: RateLimitState, now: number): void {\r\n    // Remove requests older than 1 minute\r\n    const minuteAgo = now - this.MINUTE_MS\r\n    state.requests = state.requests.filter(timestamp => timestamp > minuteAgo)\r\n\r\n    // Reset daily counters if it's a new day\r\n    if (now - state.lastReset > this.DAY_MS) {\r\n      state.characters = []\r\n      state.lastReset = now\r\n    }\r\n  }\r\n\r\n  private recordRequest(provider: AIVoiceProviderType, request: AudioGenerationRequest): void {\r\n    const state = this.state.get(provider)\r\n    if (!state) return\r\n\r\n    const now = Date.now()\r\n    \r\n    // Record request timestamp\r\n    state.requests.push(now)\r\n    \r\n    // Record character count\r\n    state.characters.push(request.text.length)\r\n  }\r\n\r\n  private isRetryableError(error: any): boolean {\r\n    // Retry on rate limits and temporary service issues\r\n    return error?.code === 'RATE_LIMIT' || \r\n           error?.code === 'SERVICE_UNAVAILABLE' ||\r\n           error?.retryable === true\r\n  }\r\n\r\n  private sleep(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms))\r\n  }\r\n\r\n  private startQueueProcessor(): void {\r\n    // Process queues every second\r\n    setInterval(() => {\r\n      for (const provider of this.queues.keys()) {\r\n        if (!this.processing.get(provider)) {\r\n          this.processQueue(provider)\r\n        }\r\n      }\r\n    }, 1000)\r\n  }\r\n\r\n  // Public methods for monitoring\r\n  getQueueStatus(): Record<AIVoiceProviderType, {\r\n    queueLength: number\r\n    processing: boolean\r\n    oldestRequest?: number\r\n  }> {\r\n    const status: Record<string, any> = {}\r\n\r\n    for (const [provider, queue] of this.queues.entries()) {\r\n      const oldestRequest = queue.length > 0 ? queue[0].timestamp : undefined\r\n      \r\n      status[provider] = {\r\n        queueLength: queue.length,\r\n        processing: this.processing.get(provider) || false,\r\n        oldestRequest\r\n      }\r\n    }\r\n\r\n    return status as Record<AIVoiceProviderType, {\r\n      queueLength: number\r\n      processing: boolean\r\n      oldestRequest?: number\r\n    }>\r\n  }\r\n\r\n  getRateLimitStatus(): Record<AIVoiceProviderType, {\r\n    requestsInLastMinute: number\r\n    charactersToday: number\r\n    requestsPerMinuteLimit: number\r\n    charactersPerDayLimit: number\r\n    utilizationPercent: number\r\n  }> {\r\n    const status: Record<string, any> = {}\r\n\r\n    for (const [provider, state] of this.state.entries()) {\r\n      const limits = this.limits.get(provider)\r\n      if (!limits) continue\r\n\r\n      const now = Date.now()\r\n      this.cleanupOldEntries(state, now)\r\n\r\n      const requestsInLastMinute = state.requests.length\r\n      const charactersToday = state.characters.reduce((sum, chars) => sum + chars, 0)\r\n      \r\n      const requestUtilization = (requestsInLastMinute / limits.requestsPerMinute) * 100\r\n      const characterUtilization = (charactersToday / limits.charactersPerDay) * 100\r\n      const utilizationPercent = Math.max(requestUtilization, characterUtilization)\r\n\r\n      status[provider] = {\r\n        requestsInLastMinute,\r\n        charactersToday,\r\n        requestsPerMinuteLimit: limits.requestsPerMinute,\r\n        charactersPerDayLimit: limits.charactersPerDay,\r\n        utilizationPercent: Math.round(utilizationPercent)\r\n      }\r\n    }\r\n\r\n    return status as Record<AIVoiceProviderType, {\r\n      requestsInLastMinute: number\r\n      charactersToday: number\r\n      requestsPerMinuteLimit: number\r\n      charactersPerDayLimit: number\r\n      utilizationPercent: number\r\n    }>\r\n  }\r\n\r\n  clearQueue(provider: AIVoiceProviderType): void {\r\n    const queue = this.queues.get(provider)\r\n    if (queue) {\r\n      // Reject all pending requests\r\n      for (const request of queue) {\r\n        request.reject(new Error(\"Queue cleared\"))\r\n      }\r\n      queue.length = 0\r\n    }\r\n  }\r\n\r\n  clearAllQueues(): void {\r\n    for (const provider of this.queues.keys()) {\r\n      this.clearQueue(provider)\r\n    }\r\n  }\r\n\r\n  getEstimatedWaitTime(provider: AIVoiceProviderType): number {\r\n    const queue = this.queues.get(provider)\r\n    const limits = this.limits.get(provider)\r\n    \r\n    if (!queue || !limits || queue.length === 0) {\r\n      return 0\r\n    }\r\n\r\n    // Simple estimation: queue length / requests per minute * 60 seconds\r\n    return Math.ceil((queue.length / limits.requestsPerMinute) * 60)\r\n  }\r\n}\r\n\r\n// Global rate limiter instance\r\nlet rateLimiterInstance: RateLimiter | null = null\r\n\r\nexport const getRateLimiter = (): RateLimiter => {\r\n  if (!rateLimiterInstance) {\r\n    rateLimiterInstance = new RateLimiter()\r\n  }\r\n  return rateLimiterInstance\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2702, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/ai-voice-service.ts"],"sourcesContent":["import type {\r\n  AIVoiceProvider,\r\n  VoiceOptions,\r\n  AIVoiceProfile,\r\n  AIVoiceSettings,\r\n  AudioGenerationRequest,\r\n  AIVoiceProviderType\r\n} from \"./ai-voice-types\"\r\nimport {\r\n  AIVoiceError,\r\n  RateLimitError,\r\n  AuthenticationError,\r\n  ServiceUnavailableError\r\n} from \"./ai-voice-types\"\r\nimport { ProviderFactory, createProviderSafely } from \"./providers/provider-factory\"\r\nimport { getCacheManager } from \"./cache-manager\"\r\nimport { getRateLimiter } from \"./rate-limiter\"\r\n\r\nexport class AIVoiceService {\r\n  private settings: AIVoiceSettings\r\n  private providers: Map<AIVoiceProviderType, AIVoiceProvider> = new Map()\r\n  private providerHealth: Map<AIVoiceProviderType, {\r\n    healthy: boolean\r\n    lastCheck: number\r\n    consecutiveFailures: number\r\n    nextRetry: number\r\n  }> = new Map()\r\n\r\n  private readonly HEALTH_CHECK_INTERVAL = 5 * 60 * 1000 // 5 minutes\r\n  private readonly MAX_CONSECUTIVE_FAILURES = 3\r\n  private readonly RETRY_BACKOFF_BASE = 2 * 60 * 1000 // 2 minutes\r\n\r\n  constructor(settings: AIVoiceSettings) {\r\n    this.settings = settings\r\n    this.initializeProviders()\r\n  }\r\n\r\n  async updateSettings(settings: AIVoiceSettings): Promise<void> {\r\n    this.settings = settings\r\n    await this.initializeProviders()\r\n\r\n    // Update cache manager settings\r\n    const cacheManager = getCacheManager()\r\n    cacheManager.updateSettings(settings)\r\n\r\n    // Update rate limiter settings\r\n    const rateLimiter = getRateLimiter()\r\n    for (const [providerType, config] of Object.entries(settings.providerConfigs)) {\r\n      if (config.enabled) {\r\n        rateLimiter.updateProviderLimits(providerType as AIVoiceProviderType, config.rateLimit)\r\n      }\r\n    }\r\n  }\r\n\r\n  private async initializeProviders(): Promise<void> {\r\n    this.providers.clear()\r\n    this.providerHealth.clear()\r\n\r\n    for (const [providerType, config] of Object.entries(this.settings.providerConfigs)) {\r\n      if (!config.enabled) continue\r\n\r\n      const type = providerType as AIVoiceProviderType\r\n      const result = await createProviderSafely(type, config)\r\n\r\n      if (result.provider) {\r\n        this.providers.set(type, result.provider)\r\n        this.providerHealth.set(type, {\r\n          healthy: true,\r\n          lastCheck: Date.now(),\r\n          consecutiveFailures: 0,\r\n          nextRetry: 0\r\n        })\r\n      } else {\r\n        console.warn(`Failed to initialize ${type} provider:`, result.error)\r\n        this.providerHealth.set(type, {\r\n          healthy: false,\r\n          lastCheck: Date.now(),\r\n          consecutiveFailures: 1,\r\n          nextRetry: Date.now() + this.RETRY_BACKOFF_BASE\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  async generateSpeech(\r\n    text: string,\r\n    type: 'announcement' | 'prayer' | 'bell' | 'general',\r\n    options?: Partial<VoiceOptions>\r\n  ): Promise<AudioBuffer> {\r\n    if (!this.settings.aiVoiceEnabled) {\r\n      throw new AIVoiceError(\"AI voice generation is disabled\", \"System\", \"DISABLED\", false)\r\n    }\r\n\r\n    // Get voice profile for the type\r\n    const voiceProfile = this.settings.voiceProfiles[type]\r\n    if (!voiceProfile) {\r\n      throw new AIVoiceError(`No voice profile configured for type: ${type}`, \"System\", \"CONFIG_ERROR\", false)\r\n    }\r\n\r\n    // Build voice options\r\n    const voiceOptions: VoiceOptions = {\r\n      voice: options?.voice || voiceProfile.id,\r\n      language: options?.language || voiceProfile.language,\r\n      speed: options?.speed || 1.0,\r\n      pitch: options?.pitch || 1.0,\r\n      stability: options?.stability,\r\n      clarity: options?.clarity\r\n    }\r\n\r\n    // Check cache first\r\n    const cacheManager = getCacheManager()\r\n    const cachedAudio = await cacheManager.retrieveAudio(text, voiceProfile.id, voiceProfile.provider)\r\n    if (cachedAudio) {\r\n      return cachedAudio\r\n    }\r\n\r\n    // Generate with provider failover\r\n    const audioBuffer = await this.generateWithFailover(text, voiceOptions, voiceProfile)\r\n\r\n    // Cache the result\r\n    await cacheManager.storeAudio(text, voiceProfile.id, voiceProfile.provider, audioBuffer)\r\n\r\n    return audioBuffer\r\n  }\r\n\r\n  private async generateWithFailover(\r\n    text: string,\r\n    options: VoiceOptions,\r\n    voiceProfile: AIVoiceProfile\r\n  ): Promise<AudioBuffer> {\r\n    const providers = this.getOrderedProviders(voiceProfile.provider)\r\n    let lastError: AIVoiceError | null = null\r\n    const rateLimiter = getRateLimiter()\r\n\r\n    for (const { type, provider } of providers) {\r\n      try {\r\n        // Check if provider is healthy\r\n        if (!await this.isProviderHealthy(type)) {\r\n          continue\r\n        }\r\n\r\n        // Create generation request\r\n        const request: AudioGenerationRequest = {\r\n          id: `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n          text,\r\n          type: 'general', // Will be set properly by caller\r\n          voice: voiceProfile,\r\n          options,\r\n          priority: 'normal',\r\n          timestamp: Date.now(),\r\n          status: 'pending',\r\n          retryCount: 0,\r\n          estimatedCost: provider.estimateCost(text, options.voice)\r\n        }\r\n\r\n        // Execute with rate limiting\r\n        const audioBuffer = await rateLimiter.executeWithRateLimit(\r\n          type,\r\n          request,\r\n          () => provider.generateSpeech(text, options)\r\n        )\r\n\r\n        // Mark provider as healthy on success\r\n        this.markProviderHealthy(type)\r\n\r\n        return audioBuffer\r\n      } catch (error) {\r\n        lastError = error instanceof AIVoiceError ? error :\r\n          new ServiceUnavailableError(type)\r\n\r\n        // Handle different error types\r\n        if (error instanceof RateLimitError) {\r\n          this.handleRateLimit(type, error.retryAfter)\r\n        } else if (error instanceof AuthenticationError) {\r\n          this.markProviderUnhealthy(type)\r\n        } else if (error instanceof ServiceUnavailableError) {\r\n          this.markProviderUnhealthy(type)\r\n        }\r\n\r\n        console.warn(`Provider ${type} failed:`, error)\r\n      }\r\n    }\r\n\r\n    // All providers failed\r\n    throw lastError || new AIVoiceError(\r\n      \"All voice providers failed\",\r\n      \"System\",\r\n      \"ALL_PROVIDERS_FAILED\",\r\n      true\r\n    )\r\n  }\r\n\r\n  private getOrderedProviders(preferredProvider: string): Array<{\r\n    type: AIVoiceProviderType\r\n    provider: AIVoiceProvider\r\n  }> {\r\n    const providers: Array<{\r\n      type: AIVoiceProviderType\r\n      provider: AIVoiceProvider\r\n      priority: number\r\n    }> = []\r\n\r\n    // Add all available providers with their priorities\r\n    for (const [type, provider] of this.providers.entries()) {\r\n      const config = this.settings.providerConfigs[type]\r\n      if (config?.enabled) {\r\n        let priority = config.priority\r\n\r\n        // Boost priority for preferred provider\r\n        if (type === preferredProvider) {\r\n          priority -= 100 // Lower number = higher priority\r\n        }\r\n\r\n        providers.push({ type, provider, priority })\r\n      }\r\n    }\r\n\r\n    // Sort by priority (lower number = higher priority)\r\n    providers.sort((a, b) => a.priority - b.priority)\r\n\r\n    return providers.map(({ type, provider }) => ({ type, provider }))\r\n  }\r\n\r\n  private async isProviderHealthy(type: AIVoiceProviderType): Promise<boolean> {\r\n    const health = this.providerHealth.get(type)\r\n    if (!health) return false\r\n\r\n    // If marked unhealthy and retry time hasn't passed, skip\r\n    if (!health.healthy && Date.now() < health.nextRetry) {\r\n      return false\r\n    }\r\n\r\n    // If it's been a while since last check, do a health check\r\n    if (Date.now() - health.lastCheck > this.HEALTH_CHECK_INTERVAL) {\r\n      await this.performHealthCheck(type)\r\n    }\r\n\r\n    return this.providerHealth.get(type)?.healthy || false\r\n  }\r\n\r\n  private async performHealthCheck(type: AIVoiceProviderType): Promise<void> {\r\n    const provider = this.providers.get(type)\r\n    const health = this.providerHealth.get(type)\r\n\r\n    if (!provider || !health) return\r\n\r\n    try {\r\n      const isValid = await provider.validateCredentials()\r\n\r\n      if (isValid) {\r\n        this.markProviderHealthy(type)\r\n      } else {\r\n        this.markProviderUnhealthy(type)\r\n      }\r\n    } catch (error) {\r\n      this.markProviderUnhealthy(type)\r\n    }\r\n  }\r\n\r\n  private markProviderHealthy(type: AIVoiceProviderType): void {\r\n    const health = this.providerHealth.get(type)\r\n    if (health) {\r\n      health.healthy = true\r\n      health.lastCheck = Date.now()\r\n      health.consecutiveFailures = 0\r\n      health.nextRetry = 0\r\n    }\r\n  }\r\n\r\n  private markProviderUnhealthy(type: AIVoiceProviderType): void {\r\n    const health = this.providerHealth.get(type)\r\n    if (health) {\r\n      health.healthy = false\r\n      health.lastCheck = Date.now()\r\n      health.consecutiveFailures += 1\r\n\r\n      // Exponential backoff for retry\r\n      const backoffMultiplier = Math.pow(2, Math.min(health.consecutiveFailures - 1, 5))\r\n      health.nextRetry = Date.now() + (this.RETRY_BACKOFF_BASE * backoffMultiplier)\r\n    }\r\n  }\r\n\r\n  private handleRateLimit(type: AIVoiceProviderType, retryAfter?: number): void {\r\n    const health = this.providerHealth.get(type)\r\n    if (health) {\r\n      health.healthy = false\r\n      health.lastCheck = Date.now()\r\n      health.nextRetry = Date.now() + (retryAfter ? retryAfter * 1000 : this.RETRY_BACKOFF_BASE)\r\n    }\r\n  }\r\n\r\n  async getAvailableVoices(): Promise<Record<AIVoiceProviderType, AIVoiceProfile[]>> {\r\n    const voices: Record<string, AIVoiceProfile[]> = {}\r\n\r\n    for (const [type, provider] of this.providers.entries()) {\r\n      try {\r\n        if (await this.isProviderHealthy(type)) {\r\n          voices[type] = await provider.getAvailableVoices()\r\n        }\r\n      } catch (error) {\r\n        console.warn(`Failed to get voices from ${type}:`, error)\r\n        voices[type] = []\r\n      }\r\n    }\r\n\r\n    return voices as Record<AIVoiceProviderType, AIVoiceProfile[]>\r\n  }\r\n\r\n  async validateAllProviders(): Promise<Record<AIVoiceProviderType, {\r\n    valid: boolean\r\n    error?: string\r\n  }>> {\r\n    const results: Record<string, { valid: boolean; error?: string }> = {}\r\n\r\n    for (const [type, provider] of this.providers.entries()) {\r\n      try {\r\n        const isValid = await provider.validateCredentials()\r\n        results[type] = { valid: isValid }\r\n\r\n        if (isValid) {\r\n          this.markProviderHealthy(type)\r\n        } else {\r\n          this.markProviderUnhealthy(type)\r\n          results[type].error = \"Invalid credentials\"\r\n        }\r\n      } catch (error) {\r\n        this.markProviderUnhealthy(type)\r\n        results[type] = {\r\n          valid: false,\r\n          error: error instanceof Error ? error.message : \"Unknown error\"\r\n        }\r\n      }\r\n    }\r\n\r\n    return results as Record<AIVoiceProviderType, { valid: boolean; error?: string }>\r\n  }\r\n\r\n  getProviderHealth(): Record<AIVoiceProviderType, {\r\n    healthy: boolean\r\n    lastCheck: number\r\n    consecutiveFailures: number\r\n    nextRetry: number\r\n  }> {\r\n    const health: Record<string, any> = {}\r\n\r\n    for (const [type, healthInfo] of this.providerHealth.entries()) {\r\n      health[type] = { ...healthInfo }\r\n    }\r\n\r\n    return health as Record<AIVoiceProviderType, {\r\n      healthy: boolean\r\n      lastCheck: number\r\n      consecutiveFailures: number\r\n      nextRetry: number\r\n    }>\r\n  }\r\n\r\n  async estimateCost(text: string, type: 'announcement' | 'prayer' | 'bell' | 'general'): Promise<{\r\n    provider: string\r\n    cost: number\r\n    cached: boolean\r\n  }> {\r\n    const voiceProfile = this.settings.voiceProfiles[type]\r\n    if (!voiceProfile) {\r\n      return { provider: \"unknown\", cost: 0, cached: false }\r\n    }\r\n\r\n    // Check if already cached\r\n    const cacheManager = getCacheManager()\r\n    const isCached = await cacheManager.hasAudio(text, voiceProfile.id, voiceProfile.provider)\r\n\r\n    if (isCached) {\r\n      return { provider: voiceProfile.provider, cost: 0, cached: true }\r\n    }\r\n\r\n    // Get provider and estimate cost\r\n    const provider = this.providers.get(voiceProfile.provider as AIVoiceProviderType)\r\n    if (!provider) {\r\n      return { provider: voiceProfile.provider, cost: 0, cached: false }\r\n    }\r\n\r\n    const cost = provider.estimateCost(text, voiceProfile.id)\r\n    return { provider: voiceProfile.provider, cost, cached: false }\r\n  }\r\n\r\n  getSettings(): AIVoiceSettings {\r\n    return { ...this.settings }\r\n  }\r\n\r\n  isEnabled(): boolean {\r\n    return this.settings.aiVoiceEnabled\r\n  }\r\n\r\n  hasHealthyProviders(): boolean {\r\n    for (const health of this.providerHealth.values()) {\r\n      if (health.healthy) return true\r\n    }\r\n    return false\r\n  }\r\n\r\n  getRateLimitStatus(): Record<AIVoiceProviderType, {\r\n    requestsInLastMinute: number\r\n    charactersToday: number\r\n    requestsPerMinuteLimit: number\r\n    charactersPerDayLimit: number\r\n    utilizationPercent: number\r\n  }> {\r\n    const rateLimiter = getRateLimiter()\r\n    return rateLimiter.getRateLimitStatus()\r\n  }\r\n\r\n  getQueueStatus(): Record<AIVoiceProviderType, {\r\n    queueLength: number\r\n    processing: boolean\r\n    oldestRequest?: number\r\n  }> {\r\n    const rateLimiter = getRateLimiter()\r\n    return rateLimiter.getQueueStatus()\r\n  }\r\n\r\n  getEstimatedWaitTime(provider: AIVoiceProviderType): number {\r\n    const rateLimiter = getRateLimiter()\r\n    return rateLimiter.getEstimatedWaitTime(provider)\r\n  }\r\n}\r\n\r\n// Global service instance\r\nlet aiVoiceServiceInstance: AIVoiceService | null = null\r\n\r\nexport const getAIVoiceService = (): AIVoiceService | null => {\r\n  return aiVoiceServiceInstance\r\n}\r\n\r\nexport const initializeAIVoiceService = (settings: AIVoiceSettings): AIVoiceService => {\r\n  aiVoiceServiceInstance = new AIVoiceService(settings)\r\n  return aiVoiceServiceInstance\r\n}\r\n\r\nexport const updateAIVoiceService = async (settings: AIVoiceSettings): Promise<void> => {\r\n  if (aiVoiceServiceInstance) {\r\n    await aiVoiceServiceInstance.updateSettings(settings)\r\n  } else {\r\n    initializeAIVoiceService(settings)\r\n  }\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3057, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/voice-fallback.ts"],"sourcesContent":["import type { Language, VoiceType } from \"./store\"\r\nimport { getAIVoiceService } from \"./ai-voice-service\"\r\nimport { AIVoiceError } from \"./ai-voice-types\"\r\nimport { playBrowserTTS, playAudioBuffer, generateAIVoice } from \"./voice-utils\"\r\n\r\nexport interface VoiceFallbackOptions {\r\n  maxRetries?: number\r\n  retryDelay?: number\r\n  preferAI?: boolean\r\n  fallbackToTTS?: boolean\r\n  logErrors?: boolean\r\n}\r\n\r\nexport interface VoicePlaybackResult {\r\n  success: boolean\r\n  method: 'ai' | 'tts' | 'none'\r\n  provider?: string\r\n  error?: string\r\n  retries: number\r\n  duration?: number\r\n}\r\n\r\nexport class VoiceFallbackHandler {\r\n  private defaultOptions: Required<VoiceFallbackOptions> = {\r\n    maxRetries: 2,\r\n    retryDelay: 1000,\r\n    preferAI: true,\r\n    fallbackToTTS: true,\r\n    logErrors: true\r\n  }\r\n\r\n  async playWithFallback(\r\n    text: string,\r\n    voice: VoiceType,\r\n    language: Language = \"english\",\r\n    type: 'announcement' | 'prayer' | 'bell' | 'general' = 'general',\r\n    options?: VoiceFallbackOptions\r\n  ): Promise<VoicePlaybackResult> {\r\n    const opts = { ...this.defaultOptions, ...options }\r\n    const startTime = Date.now()\r\n    let retries = 0\r\n    let lastError: string | undefined\r\n\r\n    // Determine playback strategy\r\n    const strategies = this.getPlaybackStrategies(opts)\r\n\r\n    for (const strategy of strategies) {\r\n      for (let attempt = 0; attempt <= opts.maxRetries; attempt++) {\r\n        try {\r\n          const success = await this.executeStrategy(strategy, text, voice, language, type)\r\n          \r\n          if (success) {\r\n            const duration = Date.now() - startTime\r\n            return {\r\n              success: true,\r\n              method: strategy,\r\n              provider: strategy === 'ai' ? await this.getActiveProvider(type) : undefined,\r\n              retries: attempt,\r\n              duration\r\n            }\r\n          }\r\n        } catch (error) {\r\n          lastError = error instanceof Error ? error.message : 'Unknown error'\r\n          retries = attempt + 1\r\n          \r\n          if (opts.logErrors) {\r\n            console.warn(`[VoiceFallback] ${strategy} attempt ${attempt + 1} failed:`, lastError)\r\n          }\r\n\r\n          // Wait before retry (except on last attempt)\r\n          if (attempt < opts.maxRetries) {\r\n            await this.sleep(opts.retryDelay * (attempt + 1)) // Exponential backoff\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // All strategies failed\r\n    const duration = Date.now() - startTime\r\n    return {\r\n      success: false,\r\n      method: 'none',\r\n      error: lastError || 'All playback methods failed',\r\n      retries,\r\n      duration\r\n    }\r\n  }\r\n\r\n  private getPlaybackStrategies(options: VoiceFallbackOptions): Array<'ai' | 'tts'> {\r\n    const strategies: Array<'ai' | 'tts'> = []\r\n\r\n    if (options.preferAI) {\r\n      strategies.push('ai')\r\n      if (options.fallbackToTTS) {\r\n        strategies.push('tts')\r\n      }\r\n    } else {\r\n      strategies.push('tts')\r\n      if (options.preferAI) {\r\n        strategies.push('ai')\r\n      }\r\n    }\r\n\r\n    return strategies\r\n  }\r\n\r\n  private async executeStrategy(\r\n    strategy: 'ai' | 'tts',\r\n    text: string,\r\n    voice: VoiceType,\r\n    language: Language,\r\n    type: 'announcement' | 'prayer' | 'bell' | 'general'\r\n  ): Promise<boolean> {\r\n    switch (strategy) {\r\n      case 'ai':\r\n        return await this.tryAIVoice(text, type, { voice, language })\r\n      case 'tts':\r\n        return await this.tryBrowserTTS(text, voice, language)\r\n      default:\r\n        throw new Error(`Unknown strategy: ${strategy}`)\r\n    }\r\n  }\r\n\r\n  private async tryAIVoice(\r\n    text: string,\r\n    type: 'announcement' | 'prayer' | 'bell' | 'general',\r\n    options: { voice?: VoiceType; language?: Language }\r\n  ): Promise<boolean> {\r\n    const aiVoiceService = getAIVoiceService()\r\n    \r\n    // Quick availability check\r\n    if (!aiVoiceService || !aiVoiceService.isEnabled()) {\r\n      throw new AIVoiceError(\"AI voice service not available\", \"System\", \"SERVICE_UNAVAILABLE\", false)\r\n    }\r\n\r\n    if (!aiVoiceService.hasHealthyProviders()) {\r\n      throw new AIVoiceError(\"No healthy AI voice providers\", \"System\", \"NO_PROVIDERS\", true)\r\n    }\r\n\r\n    // Generate and play AI voice\r\n    const audioBuffer = await generateAIVoice(text, type, options)\r\n    if (!audioBuffer) {\r\n      throw new AIVoiceError(\"AI voice generation returned null\", \"System\", \"GENERATION_FAILED\", true)\r\n    }\r\n\r\n    await playAudioBuffer(audioBuffer)\r\n    return true\r\n  }\r\n\r\n  private async tryBrowserTTS(\r\n    text: string,\r\n    voice: VoiceType,\r\n    language: Language\r\n  ): Promise<boolean> {\r\n    // Check TTS availability\r\n    if (typeof window === \"undefined\" || !(\"speechSynthesis\" in window) || !window.speechSynthesis) {\r\n      throw new Error(\"Browser TTS not available\")\r\n    }\r\n\r\n    const result = await playBrowserTTS(text, voice, language)\r\n    if (!result) {\r\n      throw new Error(\"Browser TTS playback failed\")\r\n    }\r\n\r\n    return true\r\n  }\r\n\r\n  private async getActiveProvider(type: 'announcement' | 'prayer' | 'bell' | 'general'): Promise<string | undefined> {\r\n    const aiVoiceService = getAIVoiceService()\r\n    if (!aiVoiceService) return undefined\r\n\r\n    const settings = aiVoiceService.getSettings()\r\n    const voiceProfile = settings.voiceProfiles[type]\r\n    return voiceProfile?.provider\r\n  }\r\n\r\n  private sleep(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms))\r\n  }\r\n\r\n  // Utility methods for system health checking\r\n  async checkSystemHealth(): Promise<{\r\n    ai: { available: boolean; providers: string[]; error?: string }\r\n    tts: { available: boolean; error?: string }\r\n    recommendation: 'ai' | 'tts' | 'both' | 'none'\r\n  }> {\r\n    const aiStatus = await this.checkAIVoiceHealth()\r\n    const ttsStatus = this.checkTTSHealth()\r\n\r\n    let recommendation: 'ai' | 'tts' | 'both' | 'none' = 'none'\r\n    \r\n    if (aiStatus.available && ttsStatus.available) {\r\n      recommendation = 'both'\r\n    } else if (aiStatus.available) {\r\n      recommendation = 'ai'\r\n    } else if (ttsStatus.available) {\r\n      recommendation = 'tts'\r\n    }\r\n\r\n    return {\r\n      ai: aiStatus,\r\n      tts: ttsStatus,\r\n      recommendation\r\n    }\r\n  }\r\n\r\n  private async checkAIVoiceHealth(): Promise<{\r\n    available: boolean\r\n    providers: string[]\r\n    error?: string\r\n  }> {\r\n    try {\r\n      const aiVoiceService = getAIVoiceService()\r\n      \r\n      if (!aiVoiceService) {\r\n        return { available: false, providers: [], error: \"AI voice service not initialized\" }\r\n      }\r\n\r\n      if (!aiVoiceService.isEnabled()) {\r\n        return { available: false, providers: [], error: \"AI voice disabled in settings\" }\r\n      }\r\n\r\n      const health = aiVoiceService.getProviderHealth()\r\n      const healthyProviders = Object.entries(health)\r\n        .filter(([_, status]) => status.healthy)\r\n        .map(([provider, _]) => provider)\r\n\r\n      if (healthyProviders.length === 0) {\r\n        return { available: false, providers: [], error: \"No healthy providers available\" }\r\n      }\r\n\r\n      return { available: true, providers: healthyProviders }\r\n    } catch (error) {\r\n      return {\r\n        available: false,\r\n        providers: [],\r\n        error: error instanceof Error ? error.message : \"Unknown error\"\r\n      }\r\n    }\r\n  }\r\n\r\n  private checkTTSHealth(): { available: boolean; error?: string } {\r\n    if (typeof window === \"undefined\") {\r\n      return { available: false, error: \"Not in browser environment\" }\r\n    }\r\n\r\n    if (!(\"speechSynthesis\" in window)) {\r\n      return { available: false, error: \"Speech Synthesis API not supported\" }\r\n    }\r\n\r\n    if (!window.speechSynthesis) {\r\n      return { available: false, error: \"Speech Synthesis API not available\" }\r\n    }\r\n\r\n    return { available: true }\r\n  }\r\n\r\n  // Performance monitoring\r\n  async measurePerformance(\r\n    text: string,\r\n    voice: VoiceType,\r\n    language: Language,\r\n    type: 'announcement' | 'prayer' | 'bell' | 'general',\r\n    iterations: number = 3\r\n  ): Promise<{\r\n    ai: { avgTime: number; successRate: number; errors: string[] }\r\n    tts: { avgTime: number; successRate: number; errors: string[] }\r\n  }> {\r\n    const aiResults: { time: number; success: boolean; error?: string }[] = []\r\n    const ttsResults: { time: number; success: boolean; error?: string }[] = []\r\n\r\n    // Test AI voice performance\r\n    for (let i = 0; i < iterations; i++) {\r\n      const startTime = Date.now()\r\n      try {\r\n        await this.tryAIVoice(text, type, { voice, language })\r\n        aiResults.push({ time: Date.now() - startTime, success: true })\r\n      } catch (error) {\r\n        aiResults.push({\r\n          time: Date.now() - startTime,\r\n          success: false,\r\n          error: error instanceof Error ? error.message : 'Unknown error'\r\n        })\r\n      }\r\n      \r\n      // Small delay between tests\r\n      await this.sleep(500)\r\n    }\r\n\r\n    // Test TTS performance\r\n    for (let i = 0; i < iterations; i++) {\r\n      const startTime = Date.now()\r\n      try {\r\n        await this.tryBrowserTTS(text, voice, language)\r\n        ttsResults.push({ time: Date.now() - startTime, success: true })\r\n      } catch (error) {\r\n        ttsResults.push({\r\n          time: Date.now() - startTime,\r\n          success: false,\r\n          error: error instanceof Error ? error.message : 'Unknown error'\r\n        })\r\n      }\r\n      \r\n      // Small delay between tests\r\n      await this.sleep(500)\r\n    }\r\n\r\n    return {\r\n      ai: {\r\n        avgTime: aiResults.reduce((sum, r) => sum + r.time, 0) / aiResults.length,\r\n        successRate: (aiResults.filter(r => r.success).length / aiResults.length) * 100,\r\n        errors: aiResults.filter(r => !r.success).map(r => r.error || 'Unknown')\r\n      },\r\n      tts: {\r\n        avgTime: ttsResults.reduce((sum, r) => sum + r.time, 0) / ttsResults.length,\r\n        successRate: (ttsResults.filter(r => r.success).length / ttsResults.length) * 100,\r\n        errors: ttsResults.filter(r => !r.success).map(r => r.error || 'Unknown')\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Global fallback handler instance\r\nlet fallbackHandlerInstance: VoiceFallbackHandler | null = null\r\n\r\nexport const getVoiceFallbackHandler = (): VoiceFallbackHandler => {\r\n  if (!fallbackHandlerInstance) {\r\n    fallbackHandlerInstance = new VoiceFallbackHandler()\r\n  }\r\n  return fallbackHandlerInstance\r\n}\r\n\r\n// Convenience functions for common use cases\r\nexport const playWithSmartFallback = async (\r\n  text: string,\r\n  voice: VoiceType,\r\n  language: Language = \"english\",\r\n  type: 'announcement' | 'prayer' | 'bell' | 'general' = 'general'\r\n): Promise<boolean> => {\r\n  const handler = getVoiceFallbackHandler()\r\n  const result = await handler.playWithFallback(text, voice, language, type)\r\n  return result.success\r\n}\r\n\r\nexport const playAnnouncementWithFallback = async (text: string): Promise<boolean> => {\r\n  return playWithSmartFallback(text, \"standard-male\", \"english\", \"announcement\")\r\n}\r\n\r\nexport const playPrayerCallWithFallback = async (prayerName: string): Promise<boolean> => {\r\n  const prayerText = `${prayerName} prayer time. Come and pray.`\r\n  return playWithSmartFallback(prayerText, \"azan-islamic\", \"arabic\", \"prayer\")\r\n}\r\n\r\nexport const playBellWithFallback = async (eventName: string): Promise<boolean> => {\r\n  const bellText = `Bell ring for ${eventName}`\r\n  return playWithSmartFallback(bellText, \"standard-female\", \"english\", \"bell\")\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;AACA;AACA;AACA;;;;AAmBO,MAAM;IACH,iBAAiD;QACvD,YAAY;QACZ,YAAY;QACZ,UAAU;QACV,eAAe;QACf,WAAW;IACb,EAAC;IAED,MAAM,iBACJ,IAAY,EACZ,KAAgB,EAChB,WAAqB,SAAS,EAC9B,OAAuD,SAAS,EAChE,OAA8B,EACA;QAC9B,MAAM,OAAO;YAAE,GAAG,IAAI,CAAC,cAAc;YAAE,GAAG,OAAO;QAAC;QAClD,MAAM,YAAY,KAAK,GAAG;QAC1B,IAAI,UAAU;QACd,IAAI;QAEJ,8BAA8B;QAC9B,MAAM,aAAa,IAAI,CAAC,qBAAqB,CAAC;QAE9C,KAAK,MAAM,YAAY,WAAY;YACjC,IAAK,IAAI,UAAU,GAAG,WAAW,KAAK,UAAU,EAAE,UAAW;gBAC3D,IAAI;oBACF,MAAM,UAAU,MAAM,IAAI,CAAC,eAAe,CAAC,UAAU,MAAM,OAAO,UAAU;oBAE5E,IAAI,SAAS;wBACX,MAAM,WAAW,KAAK,GAAG,KAAK;wBAC9B,OAAO;4BACL,SAAS;4BACT,QAAQ;4BACR,UAAU,aAAa,OAAO,MAAM,IAAI,CAAC,iBAAiB,CAAC,QAAQ;4BACnE,SAAS;4BACT;wBACF;oBACF;gBACF,EAAE,OAAO,OAAO;oBACd,YAAY,iBAAiB,QAAQ,MAAM,OAAO,GAAG;oBACrD,UAAU,UAAU;oBAEpB,IAAI,KAAK,SAAS,EAAE;wBAClB,QAAQ,IAAI,CAAC,CAAC,gBAAgB,EAAE,SAAS,SAAS,EAAE,UAAU,EAAE,QAAQ,CAAC,EAAE;oBAC7E;oBAEA,6CAA6C;oBAC7C,IAAI,UAAU,KAAK,UAAU,EAAE;wBAC7B,MAAM,IAAI,CAAC,KAAK,CAAC,KAAK,UAAU,GAAG,CAAC,UAAU,CAAC,IAAG,sBAAsB;oBAC1E;gBACF;YACF;QACF;QAEA,wBAAwB;QACxB,MAAM,WAAW,KAAK,GAAG,KAAK;QAC9B,OAAO;YACL,SAAS;YACT,QAAQ;YACR,OAAO,aAAa;YACpB;YACA;QACF;IACF;IAEQ,sBAAsB,OAA6B,EAAuB;QAChF,MAAM,aAAkC,EAAE;QAE1C,IAAI,QAAQ,QAAQ,EAAE;YACpB,WAAW,IAAI,CAAC;YAChB,IAAI,QAAQ,aAAa,EAAE;gBACzB,WAAW,IAAI,CAAC;YAClB;QACF,OAAO;YACL,WAAW,IAAI,CAAC;YAChB,IAAI,QAAQ,QAAQ,EAAE;gBACpB,WAAW,IAAI,CAAC;YAClB;QACF;QAEA,OAAO;IACT;IAEA,MAAc,gBACZ,QAAsB,EACtB,IAAY,EACZ,KAAgB,EAChB,QAAkB,EAClB,IAAoD,EAClC;QAClB,OAAQ;YACN,KAAK;gBACH,OAAO,MAAM,IAAI,CAAC,UAAU,CAAC,MAAM,MAAM;oBAAE;oBAAO;gBAAS;YAC7D,KAAK;gBACH,OAAO,MAAM,IAAI,CAAC,aAAa,CAAC,MAAM,OAAO;YAC/C;gBACE,MAAM,IAAI,MAAM,CAAC,kBAAkB,EAAE,UAAU;QACnD;IACF;IAEA,MAAc,WACZ,IAAY,EACZ,IAAoD,EACpD,OAAmD,EACjC;QAClB,MAAM,iBAAiB,IAAA,2LAAiB;QAExC,2BAA2B;QAC3B,IAAI,CAAC,kBAAkB,CAAC,eAAe,SAAS,IAAI;YAClD,MAAM,IAAI,oLAAY,CAAC,kCAAkC,UAAU,uBAAuB;QAC5F;QAEA,IAAI,CAAC,eAAe,mBAAmB,IAAI;YACzC,MAAM,IAAI,oLAAY,CAAC,iCAAiC,UAAU,gBAAgB;QACpF;QAEA,6BAA6B;QAC7B,MAAM,cAAc,MAAM,IAAA,iLAAe,EAAC,MAAM,MAAM;QACtD,IAAI,CAAC,aAAa;YAChB,MAAM,IAAI,oLAAY,CAAC,qCAAqC,UAAU,qBAAqB;QAC7F;QAEA,MAAM,IAAA,iLAAe,EAAC;QACtB,OAAO;IACT;IAEA,MAAc,cACZ,IAAY,EACZ,KAAgB,EAChB,QAAkB,EACA;QAClB,yBAAyB;QACzB,IAAI,kDAAkB,eAAe,CAAC,CAAC,qBAAqB,MAAM,KAAK,CAAC,OAAO,eAAe,EAAE;YAC9F,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,SAAS,MAAM,IAAA,gLAAc,EAAC,MAAM,OAAO;QACjD,IAAI,CAAC,QAAQ;YACX,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO;IACT;IAEA,MAAc,kBAAkB,IAAoD,EAA+B;QACjH,MAAM,iBAAiB,IAAA,2LAAiB;QACxC,IAAI,CAAC,gBAAgB,OAAO;QAE5B,MAAM,WAAW,eAAe,WAAW;QAC3C,MAAM,eAAe,SAAS,aAAa,CAAC,KAAK;QACjD,OAAO,cAAc;IACvB;IAEQ,MAAM,EAAU,EAAiB;QACvC,OAAO,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;IACpD;IAEA,6CAA6C;IAC7C,MAAM,oBAIH;QACD,MAAM,WAAW,MAAM,IAAI,CAAC,kBAAkB;QAC9C,MAAM,YAAY,IAAI,CAAC,cAAc;QAErC,IAAI,iBAAiD;QAErD,IAAI,SAAS,SAAS,IAAI,UAAU,SAAS,EAAE;YAC7C,iBAAiB;QACnB,OAAO,IAAI,SAAS,SAAS,EAAE;YAC7B,iBAAiB;QACnB,OAAO,IAAI,UAAU,SAAS,EAAE;YAC9B,iBAAiB;QACnB;QAEA,OAAO;YACL,IAAI;YACJ,KAAK;YACL;QACF;IACF;IAEA,MAAc,qBAIX;QACD,IAAI;YACF,MAAM,iBAAiB,IAAA,2LAAiB;YAExC,IAAI,CAAC,gBAAgB;gBACnB,OAAO;oBAAE,WAAW;oBAAO,WAAW,EAAE;oBAAE,OAAO;gBAAmC;YACtF;YAEA,IAAI,CAAC,eAAe,SAAS,IAAI;gBAC/B,OAAO;oBAAE,WAAW;oBAAO,WAAW,EAAE;oBAAE,OAAO;gBAAgC;YACnF;YAEA,MAAM,SAAS,eAAe,iBAAiB;YAC/C,MAAM,mBAAmB,OAAO,OAAO,CAAC,QACrC,MAAM,CAAC,CAAC,CAAC,GAAG,OAAO,GAAK,OAAO,OAAO,EACtC,GAAG,CAAC,CAAC,CAAC,UAAU,EAAE,GAAK;YAE1B,IAAI,iBAAiB,MAAM,KAAK,GAAG;gBACjC,OAAO;oBAAE,WAAW;oBAAO,WAAW,EAAE;oBAAE,OAAO;gBAAiC;YACpF;YAEA,OAAO;gBAAE,WAAW;gBAAM,WAAW;YAAiB;QACxD,EAAE,OAAO,OAAO;YACd,OAAO;gBACL,WAAW;gBACX,WAAW,EAAE;gBACb,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YAClD;QACF;IACF;IAEQ,iBAAyD;QAC/D,wCAAmC;YACjC,OAAO;gBAAE,WAAW;gBAAO,OAAO;YAA6B;QACjE;;;IAWF;IAEA,yBAAyB;IACzB,MAAM,mBACJ,IAAY,EACZ,KAAgB,EAChB,QAAkB,EAClB,IAAoD,EACpD,aAAqB,CAAC,EAIrB;QACD,MAAM,YAAkE,EAAE;QAC1E,MAAM,aAAmE,EAAE;QAE3E,4BAA4B;QAC5B,IAAK,IAAI,IAAI,GAAG,IAAI,YAAY,IAAK;YACnC,MAAM,YAAY,KAAK,GAAG;YAC1B,IAAI;gBACF,MAAM,IAAI,CAAC,UAAU,CAAC,MAAM,MAAM;oBAAE;oBAAO;gBAAS;gBACpD,UAAU,IAAI,CAAC;oBAAE,MAAM,KAAK,GAAG,KAAK;oBAAW,SAAS;gBAAK;YAC/D,EAAE,OAAO,OAAO;gBACd,UAAU,IAAI,CAAC;oBACb,MAAM,KAAK,GAAG,KAAK;oBACnB,SAAS;oBACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;gBAClD;YACF;YAEA,4BAA4B;YAC5B,MAAM,IAAI,CAAC,KAAK,CAAC;QACnB;QAEA,uBAAuB;QACvB,IAAK,IAAI,IAAI,GAAG,IAAI,YAAY,IAAK;YACnC,MAAM,YAAY,KAAK,GAAG;YAC1B,IAAI;gBACF,MAAM,IAAI,CAAC,aAAa,CAAC,MAAM,OAAO;gBACtC,WAAW,IAAI,CAAC;oBAAE,MAAM,KAAK,GAAG,KAAK;oBAAW,SAAS;gBAAK;YAChE,EAAE,OAAO,OAAO;gBACd,WAAW,IAAI,CAAC;oBACd,MAAM,KAAK,GAAG,KAAK;oBACnB,SAAS;oBACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;gBAClD;YACF;YAEA,4BAA4B;YAC5B,MAAM,IAAI,CAAC,KAAK,CAAC;QACnB;QAEA,OAAO;YACL,IAAI;gBACF,SAAS,UAAU,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,IAAI,EAAE,KAAK,UAAU,MAAM;gBACzE,aAAa,AAAC,UAAU,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO,EAAE,MAAM,GAAG,UAAU,MAAM,GAAI;gBAC5E,QAAQ,UAAU,MAAM,CAAC,CAAA,IAAK,CAAC,EAAE,OAAO,EAAE,GAAG,CAAC,CAAA,IAAK,EAAE,KAAK,IAAI;YAChE;YACA,KAAK;gBACH,SAAS,WAAW,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,IAAI,EAAE,KAAK,WAAW,MAAM;gBAC3E,aAAa,AAAC,WAAW,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO,EAAE,MAAM,GAAG,WAAW,MAAM,GAAI;gBAC9E,QAAQ,WAAW,MAAM,CAAC,CAAA,IAAK,CAAC,EAAE,OAAO,EAAE,GAAG,CAAC,CAAA,IAAK,EAAE,KAAK,IAAI;YACjE;QACF;IACF;AACF;AAEA,mCAAmC;AACnC,IAAI,0BAAuD;AAEpD,MAAM,0BAA0B;IACrC,IAAI,CAAC,yBAAyB;QAC5B,0BAA0B,IAAI;IAChC;IACA,OAAO;AACT;AAGO,MAAM,wBAAwB,OACnC,MACA,OACA,WAAqB,SAAS,EAC9B,OAAuD,SAAS;IAEhE,MAAM,UAAU;IAChB,MAAM,SAAS,MAAM,QAAQ,gBAAgB,CAAC,MAAM,OAAO,UAAU;IACrE,OAAO,OAAO,OAAO;AACvB;AAEO,MAAM,+BAA+B,OAAO;IACjD,OAAO,sBAAsB,MAAM,iBAAiB,WAAW;AACjE;AAEO,MAAM,6BAA6B,OAAO;IAC/C,MAAM,aAAa,GAAG,WAAW,4BAA4B,CAAC;IAC9D,OAAO,sBAAsB,YAAY,gBAAgB,UAAU;AACrE;AAEO,MAAM,uBAAuB,OAAO;IACzC,MAAM,WAAW,CAAC,cAAc,EAAE,WAAW;IAC7C,OAAO,sBAAsB,UAAU,mBAAmB,WAAW;AACvE"}},
    {"offset": {"line": 3351, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/prayer-call-generator.ts"],"sourcesContent":["import { PRAYER_PHRASES } from \"./ai-voice-constants\"\r\n\r\nexport interface PrayerCallOptions {\r\n  includeArabic?: boolean\r\n  includeTransliteration?: boolean\r\n  includeEnglish?: boolean\r\n  includeBasmala?: boolean\r\n  includeTakbir?: boolean\r\n  customMessage?: string\r\n  voiceStyle?: 'traditional' | 'modern' | 'simple'\r\n}\r\n\r\nexport interface PrayerCallContent {\r\n  arabic: string\r\n  transliteration: string\r\n  english: string\r\n  combined: string\r\n  metadata: {\r\n    prayer: string\r\n    timestamp: number\r\n    style: string\r\n    components: string[]\r\n  }\r\n}\r\n\r\nexport class PrayerCallGenerator {\r\n  private readonly TAKBIR = \"الله أكبر الله أكبر\" // Allahu Akbar Allahu Akbar\r\n  private readonly TAKBIR_TRANSLITERATION = \"Allahu Akbar Allahu Akbar\"\r\n  private readonly TAKBIR_ENGLISH = \"Allah is the Greatest, Allah is the Greatest\"\r\n\r\n  private readonly BASMALA = \"بسم الله الرحمن الرحيم\" // Bismillah ar-Rahman ar-Raheem\r\n  private readonly BASMALA_TRANSLITERATION = \"Bismillah ar-Rahman ar-Raheem\"\r\n  private readonly BASMALA_ENGLISH = \"In the name of Allah, the Most Gracious, the Most Merciful\"\r\n\r\n  private readonly SHAHADA = \"أشهد أن لا إله إلا الله، أشهد أن محمداً رسول الله\"\r\n  private readonly SHAHADA_TRANSLITERATION = \"Ashhadu an la ilaha illa Allah, Ashhadu anna Muhammadan rasul Allah\"\r\n  private readonly SHAHADA_ENGLISH = \"I bear witness that there is no god but Allah, I bear witness that Muhammad is the messenger of Allah\"\r\n\r\n  generatePrayerCall(\r\n    prayerName: string,\r\n    options: PrayerCallOptions = {}\r\n  ): PrayerCallContent {\r\n    const defaultOptions: Required<PrayerCallOptions> = {\r\n      includeArabic: true,\r\n      includeTransliteration: true,\r\n      includeEnglish: true,\r\n      includeBasmala: false,\r\n      includeTakbir: true,\r\n      customMessage: '',\r\n      voiceStyle: 'traditional'\r\n    }\r\n\r\n    const opts = { ...defaultOptions, ...options }\r\n    const prayer = prayerName.toLowerCase()\r\n    const components: string[] = []\r\n\r\n    let arabicText = ''\r\n    let transliterationText = ''\r\n    let englishText = ''\r\n\r\n    // Add Basmala if requested\r\n    if (opts.includeBasmala) {\r\n      if (opts.includeArabic) arabicText += this.BASMALA + '. '\r\n      if (opts.includeTransliteration) transliterationText += this.BASMALA_TRANSLITERATION + '. '\r\n      if (opts.includeEnglish) englishText += this.BASMALA_ENGLISH + '. '\r\n      components.push('basmala')\r\n    }\r\n\r\n    // Add Takbir if requested\r\n    if (opts.includeTakbir) {\r\n      if (opts.includeArabic) arabicText += this.TAKBIR + '. '\r\n      if (opts.includeTransliteration) transliterationText += this.TAKBIR_TRANSLITERATION + '. '\r\n      if (opts.includeEnglish) englishText += this.TAKBIR_ENGLISH + '. '\r\n      components.push('takbir')\r\n    }\r\n\r\n    // Add prayer-specific content\r\n    const prayerContent = this.getPrayerSpecificContent(prayer)\r\n    if (prayerContent) {\r\n      if (opts.includeArabic) arabicText += prayerContent.arabic + '. '\r\n      if (opts.includeTransliteration) transliterationText += prayerContent.transliteration + '. '\r\n      if (opts.includeEnglish) englishText += prayerContent.english + '. '\r\n      components.push('prayer-call')\r\n    }\r\n\r\n    // Add Shahada for traditional style\r\n    if (opts.voiceStyle === 'traditional') {\r\n      if (opts.includeArabic) arabicText += this.SHAHADA + '. '\r\n      if (opts.includeTransliteration) transliterationText += this.SHAHADA_TRANSLITERATION + '. '\r\n      if (opts.includeEnglish) englishText += this.SHAHADA_ENGLISH + '. '\r\n      components.push('shahada')\r\n    }\r\n\r\n    // Add prayer time announcement\r\n    const timeAnnouncement = this.getPrayerTimeAnnouncement(prayer)\r\n    if (opts.includeEnglish) englishText += timeAnnouncement + '. '\r\n    components.push('time-announcement')\r\n\r\n    // Add custom message if provided\r\n    if (opts.customMessage) {\r\n      if (opts.includeEnglish) englishText += opts.customMessage + '. '\r\n      components.push('custom-message')\r\n    }\r\n\r\n    // Create combined text based on style\r\n    const combined = this.createCombinedText(\r\n      arabicText.trim(),\r\n      transliterationText.trim(),\r\n      englishText.trim(),\r\n      opts.voiceStyle\r\n    )\r\n\r\n    return {\r\n      arabic: arabicText.trim(),\r\n      transliteration: transliterationText.trim(),\r\n      english: englishText.trim(),\r\n      combined,\r\n      metadata: {\r\n        prayer: prayerName,\r\n        timestamp: Date.now(),\r\n        style: opts.voiceStyle,\r\n        components\r\n      }\r\n    }\r\n  }\r\n\r\n  private getPrayerSpecificContent(prayer: string): {\r\n    arabic: string\r\n    transliteration: string\r\n    english: string\r\n  } | null {\r\n    const prayerData = PRAYER_PHRASES[prayer as keyof typeof PRAYER_PHRASES]\r\n    if (!prayerData) return null\r\n\r\n    return {\r\n      arabic: prayerData.arabic,\r\n      transliteration: prayerData.transliteration,\r\n      english: prayerData.english\r\n    }\r\n  }\r\n\r\n  private getPrayerTimeAnnouncement(prayer: string): string {\r\n    const prayerNames: Record<string, string> = {\r\n      fajr: \"Fajr prayer time\",\r\n      dhuhr: \"Dhuhr prayer time\", \r\n      asr: \"Asr prayer time\",\r\n      maghrib: \"Maghrib prayer time\",\r\n      isha: \"Isha prayer time\"\r\n    }\r\n\r\n    return prayerNames[prayer] || `${prayer.charAt(0).toUpperCase() + prayer.slice(1)} prayer time`\r\n  }\r\n\r\n  private createCombinedText(\r\n    arabic: string,\r\n    transliteration: string,\r\n    english: string,\r\n    style: 'traditional' | 'modern' | 'simple'\r\n  ): string {\r\n    switch (style) {\r\n      case 'traditional':\r\n        // Arabic first, then transliteration, then English\r\n        return [arabic, transliteration, english].filter(Boolean).join(' ')\r\n      \r\n      case 'modern':\r\n        // Mix Arabic and English for modern audiences\r\n        return [arabic, english].filter(Boolean).join(' ')\r\n      \r\n      case 'simple':\r\n        // English only for simplicity\r\n        return english\r\n      \r\n      default:\r\n        return [arabic, english].filter(Boolean).join(' ')\r\n    }\r\n  }\r\n\r\n  // Generate prayer call for specific times with contextual content\r\n  generateContextualPrayerCall(\r\n    prayerName: string,\r\n    currentTime: Date,\r\n    options: PrayerCallOptions = {}\r\n  ): PrayerCallContent {\r\n    const hour = currentTime.getHours()\r\n    const contextualOptions = { ...options }\r\n\r\n    // Add contextual elements based on time\r\n    switch (prayerName.toLowerCase()) {\r\n      case 'fajr':\r\n        // Dawn prayer - emphasize waking up\r\n        contextualOptions.customMessage = \"Wake up for the dawn prayer. Prayer is better than sleep.\"\r\n        break\r\n      \r\n      case 'dhuhr':\r\n        // Noon prayer - during work/school hours\r\n        contextualOptions.customMessage = \"Take a break from your activities for the noon prayer.\"\r\n        break\r\n      \r\n      case 'asr':\r\n        // Afternoon prayer\r\n        contextualOptions.customMessage = \"Time for the afternoon prayer before sunset.\"\r\n        break\r\n      \r\n      case 'maghrib':\r\n        // Sunset prayer - end of day\r\n        contextualOptions.customMessage = \"The sun has set. Time for Maghrib prayer.\"\r\n        break\r\n      \r\n      case 'isha':\r\n        // Night prayer\r\n        contextualOptions.customMessage = \"Complete your day with the night prayer.\"\r\n        break\r\n    }\r\n\r\n    return this.generatePrayerCall(prayerName, contextualOptions)\r\n  }\r\n\r\n  // Generate prayer call with school-specific context\r\n  generateSchoolPrayerCall(\r\n    prayerName: string,\r\n    schoolContext: {\r\n      isSchoolHours?: boolean\r\n      hasStudents?: boolean\r\n      location?: string\r\n    } = {},\r\n    options: PrayerCallOptions = {}\r\n  ): PrayerCallContent {\r\n    const contextualOptions = { ...options }\r\n\r\n    if (schoolContext.isSchoolHours && schoolContext.hasStudents) {\r\n      // School-specific messaging\r\n      const schoolMessages: Record<string, string> = {\r\n        fajr: \"Students and staff, it's time for Fajr prayer before school begins.\",\r\n        dhuhr: \"Students and staff, please proceed to the prayer area for Dhuhr prayer.\",\r\n        asr: \"Students and staff, time for Asr prayer. Classes will resume after prayer.\",\r\n        maghrib: \"Students and staff, Maghrib prayer time. School day is ending.\",\r\n        isha: \"Students and staff, time for Isha prayer before going home.\"\r\n      }\r\n\r\n      const schoolMessage = schoolMessages[prayerName.toLowerCase()]\r\n      if (schoolMessage) {\r\n        contextualOptions.customMessage = schoolMessage\r\n      }\r\n    }\r\n\r\n    if (schoolContext.location) {\r\n      contextualOptions.customMessage = \r\n        (contextualOptions.customMessage || '') + \r\n        ` Please gather at ${schoolContext.location}.`\r\n    }\r\n\r\n    return this.generatePrayerCall(prayerName, contextualOptions)\r\n  }\r\n\r\n  // Generate multiple language versions\r\n  generateMultilingualPrayerCall(\r\n    prayerName: string,\r\n    languages: Array<'arabic' | 'english' | 'hausa' | 'twi'>,\r\n    options: PrayerCallOptions = {}\r\n  ): Record<string, PrayerCallContent> {\r\n    const results: Record<string, PrayerCallContent> = {}\r\n\r\n    for (const language of languages) {\r\n      const langOptions = { ...options }\r\n      \r\n      switch (language) {\r\n        case 'arabic':\r\n          langOptions.includeArabic = true\r\n          langOptions.includeEnglish = false\r\n          langOptions.includeTransliteration = false\r\n          break\r\n        \r\n        case 'english':\r\n          langOptions.includeArabic = false\r\n          langOptions.includeEnglish = true\r\n          langOptions.includeTransliteration = true\r\n          break\r\n        \r\n        case 'hausa':\r\n        case 'twi':\r\n          // For local languages, include English and transliteration\r\n          langOptions.includeArabic = true\r\n          langOptions.includeEnglish = true\r\n          langOptions.includeTransliteration = true\r\n          // Add local language greeting\r\n          langOptions.customMessage = this.getLocalLanguageGreeting(language, prayerName)\r\n          break\r\n      }\r\n\r\n      results[language] = this.generatePrayerCall(prayerName, langOptions)\r\n    }\r\n\r\n    return results\r\n  }\r\n\r\n  private getLocalLanguageGreeting(language: 'hausa' | 'twi', prayerName: string): string {\r\n    const greetings: Record<string, Record<string, string>> = {\r\n      hausa: {\r\n        fajr: \"Lokacin sallah ta asuba ya yi. Ku zo mu yi sallah.\",\r\n        dhuhr: \"Lokacin sallah ta rana ya yi. Ku zo mu yi sallah.\",\r\n        asr: \"Lokacin sallah ta yamma ya yi. Ku zo mu yi sallah.\",\r\n        maghrib: \"Lokacin sallah ta magariba ya yi. Ku zo mu yi sallah.\",\r\n        isha: \"Lokacin sallah ta dare ya yi. Ku zo mu yi sallah.\"\r\n      },\r\n      twi: {\r\n        fajr: \"Anɔpa mpaebɔ berɛ aso. Mommra yɛn kɔ bɔ mpae.\",\r\n        dhuhr: \"Awia mpaebɔ berɛ aso. Mommra yɛn kɔ bɔ mpae.\",\r\n        asr: \"Anwummere mpaebɔ berɛ aso. Mommra yɛn kɔ bɔ mpae.\",\r\n        maghrib: \"Anwummere mpaebɔ berɛ aso. Mommra yɛn kɔ bɔ mpae.\",\r\n        isha: \"Anadwo mpaebɔ berɛ aso. Mommra yɛn kɔ bɔ mpae.\"\r\n      }\r\n    }\r\n\r\n    return greetings[language]?.[prayerName.toLowerCase()] || \r\n           `Time for ${prayerName} prayer. Come and pray.`\r\n  }\r\n\r\n  // Validate prayer call content\r\n  validatePrayerCall(content: PrayerCallContent): {\r\n    valid: boolean\r\n    errors: string[]\r\n    warnings: string[]\r\n  } {\r\n    const errors: string[] = []\r\n    const warnings: string[] = []\r\n\r\n    // Check if content is not empty\r\n    if (!content.combined.trim()) {\r\n      errors.push(\"Prayer call content is empty\")\r\n    }\r\n\r\n    // Check for minimum required components\r\n    if (!content.metadata.components.includes('prayer-call')) {\r\n      warnings.push(\"Prayer call does not include traditional prayer phrases\")\r\n    }\r\n\r\n    if (!content.metadata.components.includes('time-announcement')) {\r\n      warnings.push(\"Prayer call does not include time announcement\")\r\n    }\r\n\r\n    // Check Arabic content if included\r\n    if (content.arabic && !this.containsArabicText(content.arabic)) {\r\n      warnings.push(\"Arabic content may not contain proper Arabic text\")\r\n    }\r\n\r\n    // Check length (should not be too long for voice generation)\r\n    if (content.combined.length > 1000) {\r\n      warnings.push(\"Prayer call content is very long and may affect voice generation quality\")\r\n    }\r\n\r\n    return {\r\n      valid: errors.length === 0,\r\n      errors,\r\n      warnings\r\n    }\r\n  }\r\n\r\n  private containsArabicText(text: string): boolean {\r\n    // Check if text contains Arabic characters\r\n    const arabicRegex = /[\\u0600-\\u06FF]/\r\n    return arabicRegex.test(text)\r\n  }\r\n\r\n  // Get prayer call statistics\r\n  getContentStatistics(content: PrayerCallContent): {\r\n    totalLength: number\r\n    arabicLength: number\r\n    englishLength: number\r\n    wordCount: number\r\n    estimatedDuration: number // in seconds\r\n    components: string[]\r\n  } {\r\n    const words = content.combined.split(/\\s+/).filter(word => word.length > 0)\r\n    \r\n    return {\r\n      totalLength: content.combined.length,\r\n      arabicLength: content.arabic.length,\r\n      englishLength: content.english.length,\r\n      wordCount: words.length,\r\n      estimatedDuration: Math.ceil(words.length * 0.6), // ~0.6 seconds per word\r\n      components: content.metadata.components\r\n    }\r\n  }\r\n}\r\n\r\n// Global prayer call generator instance\r\nlet prayerCallGeneratorInstance: PrayerCallGenerator | null = null\r\n\r\nexport const getPrayerCallGenerator = (): PrayerCallGenerator => {\r\n  if (!prayerCallGeneratorInstance) {\r\n    prayerCallGeneratorInstance = new PrayerCallGenerator()\r\n  }\r\n  return prayerCallGeneratorInstance\r\n}\r\n\r\n// Convenience functions\r\nexport const generateSimplePrayerCall = (prayerName: string): string => {\r\n  const generator = getPrayerCallGenerator()\r\n  const content = generator.generatePrayerCall(prayerName, {\r\n    voiceStyle: 'simple',\r\n    includeArabic: false,\r\n    includeTransliteration: false,\r\n    includeEnglish: true\r\n  })\r\n  return content.combined\r\n}\r\n\r\nexport const generateTraditionalPrayerCall = (prayerName: string): string => {\r\n  const generator = getPrayerCallGenerator()\r\n  const content = generator.generatePrayerCall(prayerName, {\r\n    voiceStyle: 'traditional',\r\n    includeBasmala: true,\r\n    includeTakbir: true\r\n  })\r\n  return content.combined\r\n}\r\n\r\nexport const generateSchoolPrayerCall = (\r\n  prayerName: string,\r\n  isSchoolHours: boolean = true\r\n): string => {\r\n  const generator = getPrayerCallGenerator()\r\n  const content = generator.generateSchoolPrayerCall(prayerName, {\r\n    isSchoolHours,\r\n    hasStudents: true,\r\n    location: \"prayer area\"\r\n  })\r\n  return content.combined\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3686, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/voice-utils.ts"],"sourcesContent":["import type { Language, VoiceType } from \"./store\"\nimport { getAIVoiceService } from \"./ai-voice-service\"\nimport { AIVoiceError } from \"./ai-voice-types\"\nimport { getVoiceFallbackHandler } from \"./voice-fallback\"\n\nexport const VOICE_OPTIONS: Record<VoiceType, { name: string; language: Language; description: string }> = {\n  \"standard-male\": { name: \"Standard Male\", language: \"english\", description: \"Clear English voice\" },\n  \"standard-female\": { name: \"Standard Female\", language: \"english\", description: \"Clear English voice\" },\n  \"azan-islamic\": { name: \"Islamic Azan\", language: \"arabic\", description: \"Islamic prayer call (Azan)\" },\n  hausa: { name: \"Hausa\", language: \"hausa\", description: \"Native Hausa speaker\" },\n  twi: { name: \"Twi\", language: \"twi\", description: \"Native Twi speaker\" },\n  arabic: { name: \"Arabic\", language: \"arabic\", description: \"Native Arabic speaker\" },\n\n  // OpenAI Voices\n  \"openai-alloy\": { name: \"OpenAI Alloy\", language: \"english\", description: \"Neutral, balanced voice\" },\n  \"openai-echo\": { name: \"OpenAI Echo\", language: \"english\", description: \"Warm, rounded male voice\" },\n  \"openai-fable\": { name: \"OpenAI Fable\", language: \"english\", description: \"British accent, storytelling voice\" },\n  \"openai-onyx\": { name: \"OpenAI Onyx\", language: \"english\", description: \"Deep, authoritative male voice\" },\n  \"openai-nova\": { name: \"OpenAI Nova\", language: \"english\", description: \"Energetic female voice\" },\n  \"openai-shimmer\": { name: \"OpenAI Shimmer\", language: \"english\", description: \"Clear, bright female voice\" },\n\n  // ElevenLabs Voices\n  \"elevenlabs-rachel\": { name: \"ElevenLabs Rachel\", language: \"english\", description: \"American female, narrative\" },\n  \"elevenlabs-drew\": { name: \"ElevenLabs Drew\", language: \"english\", description: \"American male, news\" },\n  \"elevenlabs-clyde\": { name: \"ElevenLabs Clyde\", language: \"english\", description: \"American male, deep\" },\n  \"elevenlabs-paul\": { name: \"ElevenLabs Paul\", language: \"english\", description: \"American male, soft\" },\n\n  // Azure Voices\n  \"azure-jenny\": { name: \"Azure Jenny\", language: \"english\", description: \"American female, conversational\" },\n  \"azure-guy\": { name: \"Azure Guy\", language: \"english\", description: \"American male, conversational\" },\n  \"azure-aria\": { name: \"Azure Aria\", language: \"english\", description: \"American female, helpful\" },\n  \"azure-davis\": { name: \"Azure Davis\", language: \"english\", description: \"American male, casual\" },\n}\n\nexport const LANGUAGE_NAMES: Record<Language, string> = {\n  english: \"English\",\n  hausa: \"Hausa\",\n  twi: \"Twi\",\n  arabic: \"Arabic\",\n}\n\n// Voice configuration with pitch and rate adjustments\nconst VOICE_CONFIG: Record<VoiceType, { pitch: number; rate: number; volume: number }> = {\n  \"standard-male\": { pitch: 0.8, rate: 1.0, volume: 1 },\n  \"standard-female\": { pitch: 1.3, rate: 1.0, volume: 1 },\n  \"azan-islamic\": { pitch: 1.2, rate: 0.8, volume: 1 },\n  hausa: { pitch: 1.1, rate: 0.95, volume: 1 },\n  twi: { pitch: 1.05, rate: 0.95, volume: 1 },\n  arabic: { pitch: 1.2, rate: 0.9, volume: 1 },\n\n  // OpenAI Voices\n  \"openai-alloy\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"openai-echo\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"openai-fable\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"openai-onyx\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"openai-nova\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"openai-shimmer\": { pitch: 1.0, rate: 1.0, volume: 1 },\n\n  // ElevenLabs Voices\n  \"elevenlabs-rachel\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"elevenlabs-drew\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"elevenlabs-clyde\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"elevenlabs-paul\": { pitch: 1.0, rate: 1.0, volume: 1 },\n\n  // Azure Voices\n  \"azure-jenny\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"azure-guy\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"azure-aria\": { pitch: 1.0, rate: 1.0, volume: 1 },\n  \"azure-davis\": { pitch: 1.0, rate: 1.0, volume: 1 },\n}\n\nexport const playTextToSpeech = async (\n  text: string, \n  voice: VoiceType, \n  language: Language = \"english\",\n  repeatCount?: number\n) => {\n  // Get repeat count from store settings if not provided\n  const { useStore } = await import(\"./store\")\n  const settings = useStore.getState().settings\n  const timesToRepeat = repeatCount ?? settings.defaultRepeatCount ?? 1\n\n  console.log(`[v0] Playing text ${timesToRepeat} time(s): \"${text.substring(0, 50)}...\"`)\n\n  let allSuccessful = true\n\n  for (let i = 0; i < timesToRepeat; i++) {\n    console.log(`[v0] Playing repetition ${i + 1} of ${timesToRepeat}`)\n    \n    // Use the comprehensive fallback system\n    const fallbackHandler = getVoiceFallbackHandler()\n    const result = await fallbackHandler.playWithFallback(text, voice, language, 'general', {\n      maxRetries: 1,\n      retryDelay: 500,\n      preferAI: true,\n      fallbackToTTS: true,\n      logErrors: false // Keep console clean for regular usage\n    })\n\n    if (!result.success) {\n      allSuccessful = false\n      console.error(`[v0] Repetition ${i + 1} failed`)\n    }\n\n    // Add delay between repetitions (except for the last one)\n    if (i < timesToRepeat - 1) {\n      await new Promise(resolve => setTimeout(resolve, 1000)) // 1 second delay\n    }\n  }\n\n  console.log(`[v0] Completed ${timesToRepeat} repetitions. Success: ${allSuccessful}`)\n  return allSuccessful\n}\n\n// New AI voice generation function\nexport const generateAIVoice = async (\n  text: string,\n  type: 'announcement' | 'prayer' | 'bell' | 'general' = 'general',\n  options?: { voice?: VoiceType; language?: Language; speed?: number; pitch?: number }\n): Promise<AudioBuffer | null> => {\n  try {\n    const aiVoiceService = getAIVoiceService()\n    if (!aiVoiceService || !aiVoiceService.isEnabled()) {\n      return null\n    }\n\n    console.log(\"[v0] Generating AI voice - Text:\", text.substring(0, 50), \"Type:\", type)\n\n    const voiceOptions = {\n      voice: options?.voice,\n      language: options?.language,\n      speed: options?.speed || 1.0,\n      pitch: options?.pitch || 1.0\n    }\n\n    const audioBuffer = await aiVoiceService.generateSpeech(text, type, voiceOptions)\n    console.log(\"[v0] AI voice generation successful\")\n    return audioBuffer\n  } catch (error) {\n    if (error instanceof AIVoiceError) {\n      console.error(\"[v0] AI Voice Error:\", error.message, \"Provider:\", error.provider)\n    } else {\n      console.error(\"[v0] AI voice generation failed:\", error)\n    }\n    return null\n  }\n}\n\n// Play AudioBuffer using Web Audio API\nexport const playAudioBuffer = async (audioBuffer: AudioBuffer): Promise<void> => {\n  return new Promise((resolve, reject) => {\n    try {\n      const AudioContext = window.AudioContext || (window as any).webkitAudioContext\n      const audioContext = new AudioContext()\n\n      const source = audioContext.createBufferSource()\n      source.buffer = audioBuffer\n      source.connect(audioContext.destination)\n\n      source.onended = () => {\n        console.log(\"[v0] AI voice playback finished\")\n        resolve()\n      }\n\n      // Set up error handling with timeout as fallback\n      const timeoutId = setTimeout(() => {\n        console.error(\"[v0] Audio playback timeout\")\n        reject(new Error(\"Audio playback timeout\"))\n      }, audioBuffer.duration * 1000 + 5000) // Buffer duration + 5 seconds\n\n      source.onended = () => {\n        clearTimeout(timeoutId)\n        console.log(\"[v0] AI voice playback finished\")\n        resolve()\n      }\n\n      source.start(0)\n      console.log(\"[v0] AI voice playback started\")\n    } catch (error) {\n      console.error(\"[v0] Failed to play audio buffer:\", error)\n      reject(error)\n    }\n  })\n}\n\n// Original browser TTS function (renamed for clarity)\nexport const playBrowserTTS = async (text: string, voice: VoiceType, language: Language = \"english\") => {\n  return new Promise((resolve) => {\n    if (!(\"speechSynthesis\" in window)) {\n      console.error(\"[v0] Speech Synthesis not supported in this browser\")\n      // Provide user feedback for unsupported browsers\n      if (typeof window !== \"undefined\") {\n        console.warn(\"Text-to-Speech is not supported in this browser. Please use a modern browser like Chrome, Firefox, or Safari.\")\n      }\n      resolve(false)\n      return\n    }\n\n    // Check if speech synthesis is available and not disabled\n    if (!window.speechSynthesis) {\n      console.error(\"[v0] Speech Synthesis API is not available\")\n      resolve(false)\n      return\n    }\n\n    try {\n      // Only cancel if nothing is currently speaking\n      // This allows sequential playback for repetitions\n      if (!window.speechSynthesis.speaking) {\n        window.speechSynthesis.cancel()\n      }\n\n      const utterance = new SpeechSynthesisUtterance(text)\n      const config = VOICE_CONFIG[voice]\n      const langCode = getLanguageCode(language)\n\n      utterance.pitch = config.pitch\n      utterance.rate = config.rate\n      utterance.volume = config.volume\n      utterance.lang = langCode\n\n      console.log(\"[v0] Playing Browser TTS - Text:\", text.substring(0, 50), \"Voice:\", voice, \"Lang:\", langCode)\n\n      // Event handlers\n      utterance.onstart = () => {\n        console.log(\"[v0] Browser TTS started\")\n      }\n\n      utterance.onend = () => {\n        console.log(\"[v0] Browser TTS finished\")\n        resolve(true)\n      }\n\n      utterance.onerror = (event) => {\n        console.error(\"[v0] Browser TTS error:\", event.error)\n        resolve(false)\n      }\n\n      // Speak immediately\n      window.speechSynthesis.speak(utterance)\n    } catch (error) {\n      console.error(\"[v0] Browser TTS Error:\", error)\n      resolve(false)\n    }\n  })\n}\n\nexport const getLanguageCode = (language: Language): string => {\n  const codes: Record<Language, string> = {\n    english: \"en-US\",\n    hausa: \"ha\",\n    twi: \"ak\",\n    arabic: \"ar\",\n  }\n  return codes[language] || \"en-US\"\n}\n\nexport const translateMessage = (text: string, targetLanguage: Language): string => {\n  // Simple translation dictionary for common messages\n  const translations: Record<Language, Record<string, string>> = {\n    english: {},\n    hausa: {\n      \"should report to the office\": \"ya kamata ya je ofis\",\n      \"your parent is waiting at the gate\": \"mahaifiyar ku tana jira a baje\",\n      \"please come to the staff common room\": \"zo gida mai aiki da fushi\",\n      \"report to the headteacher's office now\": \"je ofis mai shugaba yanzu\",\n    },\n    twi: {\n      \"should report to the office\": \"forow kye ofis no\",\n      \"your parent is waiting at the gate\": \"wo/wo maame/papa retua wɔ apon no\",\n      \"please come to the staff common room\": \"ba stamfo no\",\n      \"report to the headteacher's office now\": \"kɔ ofis osofo mu\",\n    },\n    arabic: {\n      \"should report to the office\": \"يجب أن تتوجه إلى المكتب\",\n      \"your parent is waiting at the gate\": \"والدك ينتظر عند البوابة\",\n      \"please come to the staff common room\": \"يرجى الحضور إلى غرفة الموظفين\",\n      \"report to the headteacher's office now\": \"توجه إلى مكتب مدير المدرسة الآن\",\n    },\n  }\n\n  if (targetLanguage === \"english\") return text\n\n  let translated = text\n  const trans = translations[targetLanguage] || {}\n\n  Object.entries(trans).forEach(([en, local]) => {\n    translated = translated.replace(new RegExp(en, \"gi\"), local)\n  })\n\n  return translated\n}\n\nexport const isTTSAvailable = (): boolean => {\n  return typeof window !== \"undefined\" && \"speechSynthesis\" in window && !!window.speechSynthesis\n}\n\nexport const getTTSStatus = (): { available: boolean; message: string } => {\n  if (typeof window === \"undefined\") {\n    return { available: false, message: \"TTS not available in server environment\" }\n  }\n\n  if (!(\"speechSynthesis\" in window)) {\n    return { available: false, message: \"Speech Synthesis not supported in this browser\" }\n  }\n\n  if (!window.speechSynthesis) {\n    return { available: false, message: \"Speech Synthesis API is not available\" }\n  }\n\n  return { available: true, message: \"TTS is ready\" }\n}\n\n// Get comprehensive voice system status with fallback information\nexport const getVoiceSystemStatus = async (): Promise<{\n  aiVoice: { available: boolean; message: string; providers?: string[] }\n  browserTTS: { available: boolean; message: string }\n  fallback: { available: boolean; recommendation: 'ai' | 'tts' | 'both' | 'none' }\n  recommended: 'ai' | 'tts' | 'none'\n}> => {\n  const aiVoiceService = getAIVoiceService()\n  const ttsStatus = getTTSStatus()\n  const fallbackHandler = getVoiceFallbackHandler()\n\n  let aiVoiceStatus = { available: false, message: \"AI voice not initialized\" }\n  let providers: string[] = []\n\n  if (aiVoiceService) {\n    if (aiVoiceService.isEnabled()) {\n      const hasHealthy = aiVoiceService.hasHealthyProviders()\n      if (hasHealthy) {\n        aiVoiceStatus = { available: true, message: \"AI voice ready\" }\n        // Get available providers\n        const health = aiVoiceService.getProviderHealth()\n        providers = Object.entries(health)\n          .filter(([_, status]) => status.healthy)\n          .map(([provider, _]) => provider)\n      } else {\n        aiVoiceStatus = { available: false, message: \"No healthy AI voice providers\" }\n      }\n    } else {\n      aiVoiceStatus = { available: false, message: \"AI voice disabled\" }\n    }\n  }\n\n  // Get fallback system health\n  const fallbackHealth = await fallbackHandler.checkSystemHealth()\n\n  const recommended = aiVoiceStatus.available ? 'ai' :\n    ttsStatus.available ? 'tts' : 'none'\n\n  return {\n    aiVoice: { ...aiVoiceStatus, providers },\n    browserTTS: ttsStatus,\n    fallback: {\n      available: fallbackHealth.recommendation !== 'none',\n      recommendation: fallbackHealth.recommendation\n    },\n    recommended\n  }\n}\n\n// Check if AI voice is available for a specific type\nexport const isAIVoiceAvailable = (type: 'announcement' | 'prayer' | 'bell' | 'general' = 'general'): boolean => {\n  const aiVoiceService = getAIVoiceService()\n  if (!aiVoiceService || !aiVoiceService.isEnabled()) {\n    return false\n  }\n\n  const settings = aiVoiceService.getSettings()\n  const voiceProfile = settings.voiceProfiles[type]\n\n  if (!voiceProfile) {\n    return false\n  }\n\n  const health = aiVoiceService.getProviderHealth()\n  const providerHealth = health[voiceProfile.provider as keyof typeof health]\n\n  return providerHealth?.healthy || false\n}\n\n// Get cost estimate for text\nexport const estimateVoiceCost = async (\n  text: string,\n  type: 'announcement' | 'prayer' | 'bell' | 'general' = 'general'\n): Promise<{ cost: number; provider: string; cached: boolean } | null> => {\n  const aiVoiceService = getAIVoiceService()\n  if (!aiVoiceService || !aiVoiceService.isEnabled()) {\n    return null\n  }\n\n  try {\n    return await aiVoiceService.estimateCost(text, type)\n  } catch (error) {\n    console.error(\"[v0] Cost estimation failed:\", error)\n    return null\n  }\n}\n\n// Play announcement with repeat functionality\nexport const playAnnouncement = async (\n  text: string,\n  voice?: VoiceType,\n  language?: Language,\n  repeatCount?: number\n): Promise<boolean> => {\n  const { useStore } = await import(\"./store\")\n  const settings = useStore.getState().settings\n  \n  const selectedVoice = voice || settings.defaultVoice\n  const selectedLanguage = language || settings.defaultLanguage\n  const timesToRepeat = repeatCount ?? settings.defaultRepeatCount ?? 1\n\n  console.log(`[v0] Playing announcement ${timesToRepeat} time(s)`)\n\n  let allSuccessful = true\n\n  for (let i = 0; i < timesToRepeat; i++) {\n    console.log(`[v0] Announcement repetition ${i + 1} of ${timesToRepeat}`)\n    \n    const fallbackHandler = getVoiceFallbackHandler()\n    const result = await fallbackHandler.playWithFallback(text, selectedVoice, selectedLanguage, 'announcement', {\n      maxRetries: 2,\n      retryDelay: 1000,\n      preferAI: true,\n      fallbackToTTS: true,\n      logErrors: true\n    })\n\n    if (!result.success) {\n      allSuccessful = false\n      console.error(`[v0] Announcement repetition ${i + 1} failed`)\n    }\n\n    // Add delay between repetitions (except for the last one)\n    if (i < timesToRepeat - 1) {\n      await new Promise(resolve => setTimeout(resolve, 2000)) // 2 second delay for announcements\n    }\n  }\n\n  console.log(`[v0] Announcement completed. ${timesToRepeat} repetitions. Success: ${allSuccessful}`)\n  return allSuccessful\n}\n\nexport const playAzanCall = async (prayerName: string) => {\n  // Enhanced prayer call with traditional Islamic phrases\n  const azanText = generatePrayerCallText(prayerName)\n\n  // Use the comprehensive fallback system with prayer-specific settings\n  const fallbackHandler = getVoiceFallbackHandler()\n  const result = await fallbackHandler.playWithFallback(azanText, \"azan-islamic\", \"arabic\", 'prayer', {\n    maxRetries: 2, // More retries for important prayer calls\n    retryDelay: 1000,\n    preferAI: true,\n    fallbackToTTS: true,\n    logErrors: true // Log errors for prayer calls\n  })\n\n  if (result.success) {\n    console.log(`[v0] Prayer call played successfully using ${result.method} (${result.provider || 'browser'})`)\n  } else {\n    console.error(`[v0] Prayer call failed: ${result.error}`)\n  }\n\n  return result.success\n}\n\n// Generate traditional Islamic prayer call text using the comprehensive generator\nexport const generatePrayerCallText = (prayerName: string): string => {\n  // Import here to avoid circular dependencies\n  const { generateSchoolPrayerCall } = require(\"./prayer-call-generator\")\n\n  // Generate school-appropriate prayer call\n  return generateSchoolPrayerCall(prayerName, true)\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4266, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/bell-sounds.ts"],"sourcesContent":["/**\r\n * Bell Sound Generation using Web Audio API\r\n * Generates pleasant tones for different bell types\r\n */\r\n\r\nexport type BellType =\r\n    | 'bell'\r\n    | 'announcement'\r\n    | 'chime'\r\n    | 'electronic-bell'\r\n    | 'westminster-chimes'\r\n    | 'double-ring'\r\n    | 'triple-ring'\r\n    | 'long-ring'\r\n    | 'emergency-alert'\r\n    | 'dismissal-bell'\r\n    | 'adhan-call'\r\n    | 'islamic-chime'\r\n    | 'prayer-bell'\r\n\r\n/**\r\n * Play a bell sound based on the type\r\n */\r\nexport const playBellSound = (type: BellType): void => {\r\n    const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)()\r\n\r\n    switch (type) {\r\n        case 'bell':\r\n            playSchoolBell(audioContext)\r\n            break\r\n        case 'announcement':\r\n            playAnnouncementTone(audioContext)\r\n            break\r\n        case 'chime':\r\n            playChime(audioContext)\r\n            break\r\n        case 'electronic-bell':\r\n            playElectronicBell(audioContext)\r\n            break\r\n        case 'westminster-chimes':\r\n            playWestminsterChimes(audioContext)\r\n            break\r\n        case 'double-ring':\r\n            playDoubleRing(audioContext)\r\n            break\r\n        case 'triple-ring':\r\n            playTripleRing(audioContext)\r\n            break\r\n        case 'long-ring':\r\n            playLongRing(audioContext)\r\n            break\r\n        case 'emergency-alert':\r\n            playEmergencyAlert(audioContext)\r\n            break\r\n        case 'dismissal-bell':\r\n            playDismissalBell(audioContext)\r\n            break\r\n        case 'adhan-call':\r\n            playAdhanCall(audioContext)\r\n            break\r\n        case 'islamic-chime':\r\n            playIslamicChime(audioContext)\r\n            break\r\n        case 'prayer-bell':\r\n            playPrayerBell(audioContext)\r\n            break\r\n    }\r\n}\r\n\r\n/**\r\n * Traditional school bell sound\r\n * Multiple harmonics with decay for realistic bell tone\r\n */\r\nconst playSchoolBell = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const duration = 2.5\r\n\r\n    // Create multiple oscillators for rich bell sound\r\n    const frequencies = [800, 1000, 1200, 1600] // Harmonics\r\n    const gains = [0.3, 0.5, 0.2, 0.1]\r\n\r\n    frequencies.forEach((freq, index) => {\r\n        const oscillator = audioContext.createOscillator()\r\n        const gainNode = audioContext.createGain()\r\n\r\n        oscillator.type = 'sine'\r\n        oscillator.frequency.setValueAtTime(freq, now)\r\n\r\n        // Exponential decay for realistic bell\r\n        gainNode.gain.setValueAtTime(gains[index], now)\r\n        gainNode.gain.exponentialRampToValueAtTime(0.01, now + duration)\r\n\r\n        oscillator.connect(gainNode)\r\n        gainNode.connect(audioContext.destination)\r\n\r\n        oscillator.start(now)\r\n        oscillator.stop(now + duration)\r\n    })\r\n}\r\n\r\n/**\r\n * Modern electronic bell/buzzer\r\n * Sharp, clear electronic tone\r\n */\r\nconst playElectronicBell = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const beepDuration = 0.15\r\n    const beepCount = 3\r\n    const gap = 0.1\r\n\r\n    for (let i = 0; i < beepCount; i++) {\r\n        const startTime = now + (beepDuration + gap) * i\r\n        createTone(audioContext, 1200, startTime, beepDuration, 0.4, 'square')\r\n    }\r\n}\r\n\r\n/**\r\n * Westminster chimes (like Big Ben)\r\n * Classic four-note chime sequence\r\n */\r\nconst playWestminsterChimes = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const noteDuration = 0.6\r\n    const gap = 0.1\r\n\r\n    // Westminster quarter chime notes (E-C-D-G)\r\n    const notes = [659.25, 523.25, 587.33, 783.99]\r\n\r\n    notes.forEach((freq, index) => {\r\n        const startTime = now + (noteDuration + gap) * index\r\n        createChimeTone(audioContext, freq, startTime, noteDuration + 0.8, 0.3)\r\n    })\r\n}\r\n\r\n/**\r\n * Double ring - two quick rings\r\n */\r\nconst playDoubleRing = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const ringDuration = 0.8\r\n    const gap = 0.3\r\n\r\n    // First ring\r\n    playSchoolBellAtTime(audioContext, now, ringDuration)\r\n    // Second ring\r\n    playSchoolBellAtTime(audioContext, now + ringDuration + gap, ringDuration)\r\n}\r\n\r\n/**\r\n * Triple ring - three quick rings\r\n */\r\nconst playTripleRing = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const ringDuration = 0.6\r\n    const gap = 0.2\r\n\r\n    for (let i = 0; i < 3; i++) {\r\n        playSchoolBellAtTime(audioContext, now + (ringDuration + gap) * i, ringDuration)\r\n    }\r\n}\r\n\r\n/**\r\n * Long continuous ring\r\n */\r\nconst playLongRing = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const duration = 4.0\r\n\r\n    const frequencies = [800, 1000, 1200, 1600]\r\n    const gains = [0.25, 0.4, 0.15, 0.08]\r\n\r\n    frequencies.forEach((freq, index) => {\r\n        const oscillator = audioContext.createOscillator()\r\n        const gainNode = audioContext.createGain()\r\n\r\n        oscillator.type = 'sine'\r\n        oscillator.frequency.setValueAtTime(freq, now)\r\n\r\n        // Sustained with slow fade\r\n        gainNode.gain.setValueAtTime(gains[index], now)\r\n        gainNode.gain.setValueAtTime(gains[index], now + duration - 0.5)\r\n        gainNode.gain.exponentialRampToValueAtTime(0.01, now + duration)\r\n\r\n        oscillator.connect(gainNode)\r\n        gainNode.connect(audioContext.destination)\r\n\r\n        oscillator.start(now)\r\n        oscillator.stop(now + duration)\r\n    })\r\n}\r\n\r\n/**\r\n * Emergency alert - urgent siren-like sound\r\n */\r\nconst playEmergencyAlert = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const cycleDuration = 0.4\r\n    const cycles = 6\r\n\r\n    for (let i = 0; i < cycles; i++) {\r\n        const startTime = now + cycleDuration * i\r\n\r\n        const oscillator = audioContext.createOscillator()\r\n        const gainNode = audioContext.createGain()\r\n\r\n        oscillator.type = 'sawtooth'\r\n\r\n        // Sweep from high to low\r\n        oscillator.frequency.setValueAtTime(1400, startTime)\r\n        oscillator.frequency.exponentialRampToValueAtTime(700, startTime + cycleDuration)\r\n\r\n        gainNode.gain.setValueAtTime(0.5, startTime)\r\n        gainNode.gain.setValueAtTime(0.5, startTime + cycleDuration - 0.05)\r\n        gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + cycleDuration)\r\n\r\n        oscillator.connect(gainNode)\r\n        gainNode.connect(audioContext.destination)\r\n\r\n        oscillator.start(startTime)\r\n        oscillator.stop(startTime + cycleDuration)\r\n    }\r\n}\r\n\r\n/**\r\n * Dismissal bell - cheerful ascending melody\r\n */\r\nconst playDismissalBell = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const noteDuration = 0.3\r\n    const gap = 0.05\r\n\r\n    // Happy ascending scale (C-D-E-G-C)\r\n    const notes = [523.25, 587.33, 659.25, 783.99, 1046.50]\r\n\r\n    notes.forEach((freq, index) => {\r\n        const startTime = now + (noteDuration + gap) * index\r\n        createChimeTone(audioContext, freq, startTime, noteDuration + 0.4, 0.3)\r\n    })\r\n}\r\n\r\n/**\r\n * Attention-getting announcement tone\r\n * Two-tone alert sound\r\n */\r\nconst playAnnouncementTone = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const toneDuration = 0.3\r\n    const gap = 0.1\r\n\r\n    // First tone (higher)\r\n    createTone(audioContext, 1000, now, toneDuration, 0.4)\r\n\r\n    // Second tone (lower)\r\n    createTone(audioContext, 800, now + toneDuration + gap, toneDuration, 0.4)\r\n\r\n    // Repeat for emphasis\r\n    createTone(audioContext, 1000, now + (toneDuration + gap) * 2, toneDuration, 0.3)\r\n    createTone(audioContext, 800, now + (toneDuration + gap) * 3, toneDuration, 0.3)\r\n}\r\n\r\n/**\r\n * Soft melodic chime\r\n * Pleasant ascending notes\r\n */\r\nconst playChime = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const noteDuration = 0.4\r\n    const gap = 0.05\r\n\r\n    // Ascending melody (C-E-G chord)\r\n    const notes = [523.25, 659.25, 783.99] // C5, E5, G5\r\n\r\n    notes.forEach((freq, index) => {\r\n        const startTime = now + (noteDuration + gap) * index\r\n        createChimeTone(audioContext, freq, startTime, noteDuration + 0.5, 0.25)\r\n    })\r\n}\r\n\r\n/**\r\n * Helper function to play school bell at specific time\r\n */\r\nconst playSchoolBellAtTime = (audioContext: AudioContext, startTime: number, duration: number): void => {\r\n    const frequencies = [800, 1000, 1200, 1600]\r\n    const gains = [0.3, 0.5, 0.2, 0.1]\r\n\r\n    frequencies.forEach((freq, index) => {\r\n        const oscillator = audioContext.createOscillator()\r\n        const gainNode = audioContext.createGain()\r\n\r\n        oscillator.type = 'sine'\r\n        oscillator.frequency.setValueAtTime(freq, startTime)\r\n\r\n        gainNode.gain.setValueAtTime(gains[index], startTime)\r\n        gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + duration)\r\n\r\n        oscillator.connect(gainNode)\r\n        gainNode.connect(audioContext.destination)\r\n\r\n        oscillator.start(startTime)\r\n        oscillator.stop(startTime + duration)\r\n    })\r\n}\r\n\r\n/**\r\n * Helper function to create a simple tone\r\n */\r\nconst createTone = (\r\n    audioContext: AudioContext,\r\n    frequency: number,\r\n    startTime: number,\r\n    duration: number,\r\n    volume: number,\r\n    type: OscillatorType = 'sine'\r\n): void => {\r\n    const oscillator = audioContext.createOscillator()\r\n    const gainNode = audioContext.createGain()\r\n\r\n    oscillator.type = type\r\n    oscillator.frequency.setValueAtTime(frequency, startTime)\r\n\r\n    gainNode.gain.setValueAtTime(volume, startTime)\r\n    gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + duration)\r\n\r\n    oscillator.connect(gainNode)\r\n    gainNode.connect(audioContext.destination)\r\n\r\n    oscillator.start(startTime)\r\n    oscillator.stop(startTime + duration)\r\n}\r\n\r\n/**\r\n * Helper function to create a chime tone with harmonics\r\n */\r\nconst createChimeTone = (\r\n    audioContext: AudioContext,\r\n    frequency: number,\r\n    startTime: number,\r\n    duration: number,\r\n    volume: number\r\n): void => {\r\n    // Fundamental frequency\r\n    const oscillator1 = audioContext.createOscillator()\r\n    const gainNode1 = audioContext.createGain()\r\n\r\n    oscillator1.type = 'sine'\r\n    oscillator1.frequency.setValueAtTime(frequency, startTime)\r\n\r\n    gainNode1.gain.setValueAtTime(volume, startTime)\r\n    gainNode1.gain.exponentialRampToValueAtTime(0.01, startTime + duration)\r\n\r\n    oscillator1.connect(gainNode1)\r\n    gainNode1.connect(audioContext.destination)\r\n\r\n    // Add subtle harmonic for richness\r\n    const oscillator2 = audioContext.createOscillator()\r\n    const gainNode2 = audioContext.createGain()\r\n\r\n    oscillator2.type = 'sine'\r\n    oscillator2.frequency.setValueAtTime(frequency * 2, startTime)\r\n\r\n    gainNode2.gain.setValueAtTime(volume * 0.2, startTime)\r\n    gainNode2.gain.exponentialRampToValueAtTime(0.01, startTime + duration)\r\n\r\n    oscillator2.connect(gainNode2)\r\n    gainNode2.connect(audioContext.destination)\r\n\r\n    oscillator1.start(startTime)\r\n    oscillator1.stop(startTime + duration)\r\n    oscillator2.start(startTime)\r\n    oscillator2.stop(startTime + duration)\r\n}\r\n\r\n/**\r\n * Adhan Call - Islamic call to prayer tone\r\n * Reverent, melodic tone inspired by the call to prayer\r\n */\r\nconst playAdhanCall = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const noteDuration = 0.8\r\n    const gap = 0.15\r\n\r\n    // Melodic sequence inspired by traditional Adhan intervals\r\n    // Using maqam-like intervals (Middle Eastern scale)\r\n    const notes = [\r\n        440.00,  // A\r\n        493.88,  // B\r\n        523.25,  // C\r\n        587.33,  // D\r\n        523.25,  // C (return)\r\n        493.88,  // B\r\n        440.00   // A (return to root)\r\n    ]\r\n\r\n    notes.forEach((freq, index) => {\r\n        const startTime = now + (noteDuration + gap) * index\r\n        createPrayerTone(audioContext, freq, startTime, noteDuration + 1.0, 0.25)\r\n    })\r\n}\r\n\r\n/**\r\n * Islamic Chime - Gentle reminder for prayer times\r\n * Soft, respectful chime\r\n */\r\nconst playIslamicChime = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const noteDuration = 0.5\r\n    const gap = 0.1\r\n\r\n    // Peaceful descending pattern\r\n    const notes = [\r\n        783.99,  // G5\r\n        659.25,  // E5\r\n        523.25,  // C5\r\n        392.00   // G4\r\n    ]\r\n\r\n    notes.forEach((freq, index) => {\r\n        const startTime = now + (noteDuration + gap) * index\r\n        createPrayerTone(audioContext, freq, startTime, noteDuration + 0.8, 0.2)\r\n    })\r\n}\r\n\r\n/**\r\n * Prayer Bell - Simple, reverent bell for prayer time\r\n * Single sustained tone with gentle decay\r\n */\r\nconst playPrayerBell = (audioContext: AudioContext): void => {\r\n    const now = audioContext.currentTime\r\n    const duration = 3.0\r\n\r\n    // Lower, more reverent frequencies\r\n    const frequencies = [440, 550, 660]  // A, C#, E (harmonious triad)\r\n    const gains = [0.3, 0.2, 0.1]\r\n\r\n    frequencies.forEach((freq, index) => {\r\n        const oscillator = audioContext.createOscillator()\r\n        const gainNode = audioContext.createGain()\r\n\r\n        oscillator.type = 'sine'\r\n        oscillator.frequency.setValueAtTime(freq, now)\r\n\r\n        // Gentle, sustained tone with slow decay\r\n        gainNode.gain.setValueAtTime(gains[index], now)\r\n        gainNode.gain.setValueAtTime(gains[index] * 0.8, now + duration * 0.7)\r\n        gainNode.gain.exponentialRampToValueAtTime(0.01, now + duration)\r\n\r\n        oscillator.connect(gainNode)\r\n        gainNode.connect(audioContext.destination)\r\n\r\n        oscillator.start(now)\r\n        oscillator.stop(now + duration)\r\n    })\r\n}\r\n\r\n/**\r\n * Helper function to create prayer tones with warm character\r\n */\r\nconst createPrayerTone = (\r\n    audioContext: AudioContext,\r\n    frequency: number,\r\n    startTime: number,\r\n    duration: number,\r\n    volume: number\r\n): void => {\r\n    // Fundamental with warm character\r\n    const oscillator1 = audioContext.createOscillator()\r\n    const gainNode1 = audioContext.createGain()\r\n\r\n    oscillator1.type = 'sine'\r\n    oscillator1.frequency.setValueAtTime(frequency, startTime)\r\n\r\n    // Gentle attack and decay\r\n    gainNode1.gain.setValueAtTime(0.01, startTime)\r\n    gainNode1.gain.exponentialRampToValueAtTime(volume, startTime + 0.1)\r\n    gainNode1.gain.setValueAtTime(volume * 0.7, startTime + duration * 0.6)\r\n    gainNode1.gain.exponentialRampToValueAtTime(0.01, startTime + duration)\r\n\r\n    oscillator1.connect(gainNode1)\r\n    gainNode1.connect(audioContext.destination)\r\n\r\n    // Add subtle lower harmonic for warmth\r\n    const oscillator2 = audioContext.createOscillator()\r\n    const gainNode2 = audioContext.createGain()\r\n\r\n    oscillator2.type = 'sine'\r\n    oscillator2.frequency.setValueAtTime(frequency * 0.5, startTime)\r\n\r\n    gainNode2.gain.setValueAtTime(0.01, startTime)\r\n    gainNode2.gain.exponentialRampToValueAtTime(volume * 0.15, startTime + 0.1)\r\n    gainNode2.gain.exponentialRampToValueAtTime(0.01, startTime + duration)\r\n\r\n    oscillator2.connect(gainNode2)\r\n    gainNode2.connect(audioContext.destination)\r\n\r\n    oscillator1.start(startTime)\r\n    oscillator1.stop(startTime + duration)\r\n    oscillator2.start(startTime)\r\n    oscillator2.stop(startTime + duration)\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AAoBM,MAAM,gBAAgB,CAAC;IAC1B,MAAM,eAAe,IAAI,CAAC,OAAO,YAAY,IAAI,AAAC,OAAe,kBAAkB;IAEnF,OAAQ;QACJ,KAAK;YACD,eAAe;YACf;QACJ,KAAK;YACD,qBAAqB;YACrB;QACJ,KAAK;YACD,UAAU;YACV;QACJ,KAAK;YACD,mBAAmB;YACnB;QACJ,KAAK;YACD,sBAAsB;YACtB;QACJ,KAAK;YACD,eAAe;YACf;QACJ,KAAK;YACD,eAAe;YACf;QACJ,KAAK;YACD,aAAa;YACb;QACJ,KAAK;YACD,mBAAmB;YACnB;QACJ,KAAK;YACD,kBAAkB;YAClB;QACJ,KAAK;YACD,cAAc;YACd;QACJ,KAAK;YACD,iBAAiB;YACjB;QACJ,KAAK;YACD,eAAe;YACf;IACR;AACJ;AAEA;;;CAGC,GACD,MAAM,iBAAiB,CAAC;IACpB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,WAAW;IAEjB,kDAAkD;IAClD,MAAM,cAAc;QAAC;QAAK;QAAM;QAAM;KAAK,CAAC,YAAY;;IACxD,MAAM,QAAQ;QAAC;QAAK;QAAK;QAAK;KAAI;IAElC,YAAY,OAAO,CAAC,CAAC,MAAM;QACvB,MAAM,aAAa,aAAa,gBAAgB;QAChD,MAAM,WAAW,aAAa,UAAU;QAExC,WAAW,IAAI,GAAG;QAClB,WAAW,SAAS,CAAC,cAAc,CAAC,MAAM;QAE1C,uCAAuC;QACvC,SAAS,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,MAAM,EAAE;QAC3C,SAAS,IAAI,CAAC,4BAA4B,CAAC,MAAM,MAAM;QAEvD,WAAW,OAAO,CAAC;QACnB,SAAS,OAAO,CAAC,aAAa,WAAW;QAEzC,WAAW,KAAK,CAAC;QACjB,WAAW,IAAI,CAAC,MAAM;IAC1B;AACJ;AAEA;;;CAGC,GACD,MAAM,qBAAqB,CAAC;IACxB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,eAAe;IACrB,MAAM,YAAY;IAClB,MAAM,MAAM;IAEZ,IAAK,IAAI,IAAI,GAAG,IAAI,WAAW,IAAK;QAChC,MAAM,YAAY,MAAM,CAAC,eAAe,GAAG,IAAI;QAC/C,WAAW,cAAc,MAAM,WAAW,cAAc,KAAK;IACjE;AACJ;AAEA;;;CAGC,GACD,MAAM,wBAAwB,CAAC;IAC3B,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,eAAe;IACrB,MAAM,MAAM;IAEZ,4CAA4C;IAC5C,MAAM,QAAQ;QAAC;QAAQ;QAAQ;QAAQ;KAAO;IAE9C,MAAM,OAAO,CAAC,CAAC,MAAM;QACjB,MAAM,YAAY,MAAM,CAAC,eAAe,GAAG,IAAI;QAC/C,gBAAgB,cAAc,MAAM,WAAW,eAAe,KAAK;IACvE;AACJ;AAEA;;CAEC,GACD,MAAM,iBAAiB,CAAC;IACpB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,eAAe;IACrB,MAAM,MAAM;IAEZ,aAAa;IACb,qBAAqB,cAAc,KAAK;IACxC,cAAc;IACd,qBAAqB,cAAc,MAAM,eAAe,KAAK;AACjE;AAEA;;CAEC,GACD,MAAM,iBAAiB,CAAC;IACpB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,eAAe;IACrB,MAAM,MAAM;IAEZ,IAAK,IAAI,IAAI,GAAG,IAAI,GAAG,IAAK;QACxB,qBAAqB,cAAc,MAAM,CAAC,eAAe,GAAG,IAAI,GAAG;IACvE;AACJ;AAEA;;CAEC,GACD,MAAM,eAAe,CAAC;IAClB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,WAAW;IAEjB,MAAM,cAAc;QAAC;QAAK;QAAM;QAAM;KAAK;IAC3C,MAAM,QAAQ;QAAC;QAAM;QAAK;QAAM;KAAK;IAErC,YAAY,OAAO,CAAC,CAAC,MAAM;QACvB,MAAM,aAAa,aAAa,gBAAgB;QAChD,MAAM,WAAW,aAAa,UAAU;QAExC,WAAW,IAAI,GAAG;QAClB,WAAW,SAAS,CAAC,cAAc,CAAC,MAAM;QAE1C,2BAA2B;QAC3B,SAAS,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,MAAM,EAAE;QAC3C,SAAS,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,MAAM,EAAE,MAAM,WAAW;QAC5D,SAAS,IAAI,CAAC,4BAA4B,CAAC,MAAM,MAAM;QAEvD,WAAW,OAAO,CAAC;QACnB,SAAS,OAAO,CAAC,aAAa,WAAW;QAEzC,WAAW,KAAK,CAAC;QACjB,WAAW,IAAI,CAAC,MAAM;IAC1B;AACJ;AAEA;;CAEC,GACD,MAAM,qBAAqB,CAAC;IACxB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,gBAAgB;IACtB,MAAM,SAAS;IAEf,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,IAAK;QAC7B,MAAM,YAAY,MAAM,gBAAgB;QAExC,MAAM,aAAa,aAAa,gBAAgB;QAChD,MAAM,WAAW,aAAa,UAAU;QAExC,WAAW,IAAI,GAAG;QAElB,yBAAyB;QACzB,WAAW,SAAS,CAAC,cAAc,CAAC,MAAM;QAC1C,WAAW,SAAS,CAAC,4BAA4B,CAAC,KAAK,YAAY;QAEnE,SAAS,IAAI,CAAC,cAAc,CAAC,KAAK;QAClC,SAAS,IAAI,CAAC,cAAc,CAAC,KAAK,YAAY,gBAAgB;QAC9D,SAAS,IAAI,CAAC,4BAA4B,CAAC,MAAM,YAAY;QAE7D,WAAW,OAAO,CAAC;QACnB,SAAS,OAAO,CAAC,aAAa,WAAW;QAEzC,WAAW,KAAK,CAAC;QACjB,WAAW,IAAI,CAAC,YAAY;IAChC;AACJ;AAEA;;CAEC,GACD,MAAM,oBAAoB,CAAC;IACvB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,eAAe;IACrB,MAAM,MAAM;IAEZ,oCAAoC;IACpC,MAAM,QAAQ;QAAC;QAAQ;QAAQ;QAAQ;QAAQ;KAAQ;IAEvD,MAAM,OAAO,CAAC,CAAC,MAAM;QACjB,MAAM,YAAY,MAAM,CAAC,eAAe,GAAG,IAAI;QAC/C,gBAAgB,cAAc,MAAM,WAAW,eAAe,KAAK;IACvE;AACJ;AAEA;;;CAGC,GACD,MAAM,uBAAuB,CAAC;IAC1B,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,eAAe;IACrB,MAAM,MAAM;IAEZ,sBAAsB;IACtB,WAAW,cAAc,MAAM,KAAK,cAAc;IAElD,sBAAsB;IACtB,WAAW,cAAc,KAAK,MAAM,eAAe,KAAK,cAAc;IAEtE,sBAAsB;IACtB,WAAW,cAAc,MAAM,MAAM,CAAC,eAAe,GAAG,IAAI,GAAG,cAAc;IAC7E,WAAW,cAAc,KAAK,MAAM,CAAC,eAAe,GAAG,IAAI,GAAG,cAAc;AAChF;AAEA;;;CAGC,GACD,MAAM,YAAY,CAAC;IACf,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,eAAe;IACrB,MAAM,MAAM;IAEZ,iCAAiC;IACjC,MAAM,QAAQ;QAAC;QAAQ;QAAQ;KAAO,CAAC,aAAa;;IAEpD,MAAM,OAAO,CAAC,CAAC,MAAM;QACjB,MAAM,YAAY,MAAM,CAAC,eAAe,GAAG,IAAI;QAC/C,gBAAgB,cAAc,MAAM,WAAW,eAAe,KAAK;IACvE;AACJ;AAEA;;CAEC,GACD,MAAM,uBAAuB,CAAC,cAA4B,WAAmB;IACzE,MAAM,cAAc;QAAC;QAAK;QAAM;QAAM;KAAK;IAC3C,MAAM,QAAQ;QAAC;QAAK;QAAK;QAAK;KAAI;IAElC,YAAY,OAAO,CAAC,CAAC,MAAM;QACvB,MAAM,aAAa,aAAa,gBAAgB;QAChD,MAAM,WAAW,aAAa,UAAU;QAExC,WAAW,IAAI,GAAG;QAClB,WAAW,SAAS,CAAC,cAAc,CAAC,MAAM;QAE1C,SAAS,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,MAAM,EAAE;QAC3C,SAAS,IAAI,CAAC,4BAA4B,CAAC,MAAM,YAAY;QAE7D,WAAW,OAAO,CAAC;QACnB,SAAS,OAAO,CAAC,aAAa,WAAW;QAEzC,WAAW,KAAK,CAAC;QACjB,WAAW,IAAI,CAAC,YAAY;IAChC;AACJ;AAEA;;CAEC,GACD,MAAM,aAAa,CACf,cACA,WACA,WACA,UACA,QACA,OAAuB,MAAM;IAE7B,MAAM,aAAa,aAAa,gBAAgB;IAChD,MAAM,WAAW,aAAa,UAAU;IAExC,WAAW,IAAI,GAAG;IAClB,WAAW,SAAS,CAAC,cAAc,CAAC,WAAW;IAE/C,SAAS,IAAI,CAAC,cAAc,CAAC,QAAQ;IACrC,SAAS,IAAI,CAAC,4BAA4B,CAAC,MAAM,YAAY;IAE7D,WAAW,OAAO,CAAC;IACnB,SAAS,OAAO,CAAC,aAAa,WAAW;IAEzC,WAAW,KAAK,CAAC;IACjB,WAAW,IAAI,CAAC,YAAY;AAChC;AAEA;;CAEC,GACD,MAAM,kBAAkB,CACpB,cACA,WACA,WACA,UACA;IAEA,wBAAwB;IACxB,MAAM,cAAc,aAAa,gBAAgB;IACjD,MAAM,YAAY,aAAa,UAAU;IAEzC,YAAY,IAAI,GAAG;IACnB,YAAY,SAAS,CAAC,cAAc,CAAC,WAAW;IAEhD,UAAU,IAAI,CAAC,cAAc,CAAC,QAAQ;IACtC,UAAU,IAAI,CAAC,4BAA4B,CAAC,MAAM,YAAY;IAE9D,YAAY,OAAO,CAAC;IACpB,UAAU,OAAO,CAAC,aAAa,WAAW;IAE1C,mCAAmC;IACnC,MAAM,cAAc,aAAa,gBAAgB;IACjD,MAAM,YAAY,aAAa,UAAU;IAEzC,YAAY,IAAI,GAAG;IACnB,YAAY,SAAS,CAAC,cAAc,CAAC,YAAY,GAAG;IAEpD,UAAU,IAAI,CAAC,cAAc,CAAC,SAAS,KAAK;IAC5C,UAAU,IAAI,CAAC,4BAA4B,CAAC,MAAM,YAAY;IAE9D,YAAY,OAAO,CAAC;IACpB,UAAU,OAAO,CAAC,aAAa,WAAW;IAE1C,YAAY,KAAK,CAAC;IAClB,YAAY,IAAI,CAAC,YAAY;IAC7B,YAAY,KAAK,CAAC;IAClB,YAAY,IAAI,CAAC,YAAY;AACjC;AAEA;;;CAGC,GACD,MAAM,gBAAgB,CAAC;IACnB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,eAAe;IACrB,MAAM,MAAM;IAEZ,2DAA2D;IAC3D,oDAAoD;IACpD,MAAM,QAAQ;QACV;QACA;QACA;QACA;QACA;QACA;QACA,OAAS,qBAAqB;KACjC;IAED,MAAM,OAAO,CAAC,CAAC,MAAM;QACjB,MAAM,YAAY,MAAM,CAAC,eAAe,GAAG,IAAI;QAC/C,iBAAiB,cAAc,MAAM,WAAW,eAAe,KAAK;IACxE;AACJ;AAEA;;;CAGC,GACD,MAAM,mBAAmB,CAAC;IACtB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,eAAe;IACrB,MAAM,MAAM;IAEZ,8BAA8B;IAC9B,MAAM,QAAQ;QACV;QACA;QACA;QACA,OAAS,KAAK;KACjB;IAED,MAAM,OAAO,CAAC,CAAC,MAAM;QACjB,MAAM,YAAY,MAAM,CAAC,eAAe,GAAG,IAAI;QAC/C,iBAAiB,cAAc,MAAM,WAAW,eAAe,KAAK;IACxE;AACJ;AAEA;;;CAGC,GACD,MAAM,iBAAiB,CAAC;IACpB,MAAM,MAAM,aAAa,WAAW;IACpC,MAAM,WAAW;IAEjB,mCAAmC;IACnC,MAAM,cAAc;QAAC;QAAK;QAAK;KAAI,CAAE,8BAA8B;;IACnE,MAAM,QAAQ;QAAC;QAAK;QAAK;KAAI;IAE7B,YAAY,OAAO,CAAC,CAAC,MAAM;QACvB,MAAM,aAAa,aAAa,gBAAgB;QAChD,MAAM,WAAW,aAAa,UAAU;QAExC,WAAW,IAAI,GAAG;QAClB,WAAW,SAAS,CAAC,cAAc,CAAC,MAAM;QAE1C,yCAAyC;QACzC,SAAS,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,MAAM,EAAE;QAC3C,SAAS,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,MAAM,WAAW;QAClE,SAAS,IAAI,CAAC,4BAA4B,CAAC,MAAM,MAAM;QAEvD,WAAW,OAAO,CAAC;QACnB,SAAS,OAAO,CAAC,aAAa,WAAW;QAEzC,WAAW,KAAK,CAAC;QACjB,WAAW,IAAI,CAAC,MAAM;IAC1B;AACJ;AAEA;;CAEC,GACD,MAAM,mBAAmB,CACrB,cACA,WACA,WACA,UACA;IAEA,kCAAkC;IAClC,MAAM,cAAc,aAAa,gBAAgB;IACjD,MAAM,YAAY,aAAa,UAAU;IAEzC,YAAY,IAAI,GAAG;IACnB,YAAY,SAAS,CAAC,cAAc,CAAC,WAAW;IAEhD,0BAA0B;IAC1B,UAAU,IAAI,CAAC,cAAc,CAAC,MAAM;IACpC,UAAU,IAAI,CAAC,4BAA4B,CAAC,QAAQ,YAAY;IAChE,UAAU,IAAI,CAAC,cAAc,CAAC,SAAS,KAAK,YAAY,WAAW;IACnE,UAAU,IAAI,CAAC,4BAA4B,CAAC,MAAM,YAAY;IAE9D,YAAY,OAAO,CAAC;IACpB,UAAU,OAAO,CAAC,aAAa,WAAW;IAE1C,uCAAuC;IACvC,MAAM,cAAc,aAAa,gBAAgB;IACjD,MAAM,YAAY,aAAa,UAAU;IAEzC,YAAY,IAAI,GAAG;IACnB,YAAY,SAAS,CAAC,cAAc,CAAC,YAAY,KAAK;IAEtD,UAAU,IAAI,CAAC,cAAc,CAAC,MAAM;IACpC,UAAU,IAAI,CAAC,4BAA4B,CAAC,SAAS,MAAM,YAAY;IACvE,UAAU,IAAI,CAAC,4BAA4B,CAAC,MAAM,YAAY;IAE9D,YAAY,OAAO,CAAC;IACpB,UAAU,OAAO,CAAC,aAAa,WAAW;IAE1C,YAAY,KAAK,CAAC;IAClB,YAAY,IAAI,CAAC,YAAY;IAC7B,YAAY,KAAK,CAAC;IAClB,YAAY,IAAI,CAAC,YAAY;AACjC"}},
    {"offset": {"line": 4689, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/combined-audio.ts"],"sourcesContent":["import { playBellSound } from \"./bell-sounds\"\r\nimport { playAnnouncement } from \"./voice-utils\"\r\nimport { useStore } from \"./store\"\r\nimport type { BellType } from \"./bell-sounds\"\r\nimport type { VoiceType, Language } from \"./store\"\r\n\r\nexport interface CombinedAudioOptions {\r\n  tone?: BellType\r\n  voice?: VoiceType\r\n  language?: Language\r\n  repeatCount?: number\r\n  delayBetweenToneAndVoice?: number\r\n  delayBetweenRepeats?: number\r\n}\r\n\r\nexport class CombinedAudioPlayer {\r\n  static async playToneAndAnnouncement(\r\n    taskName: string,\r\n    options: CombinedAudioOptions = {}\r\n  ): Promise<boolean> {\r\n    const settings = useStore.getState().settings\r\n    const {\r\n      tone = \"bell\",\r\n      voice = settings.defaultVoice,\r\n      language = settings.defaultLanguage,\r\n      repeatCount = settings.defaultRepeatCount,\r\n      delayBetweenToneAndVoice = 1500,\r\n      delayBetweenRepeats = 3000\r\n    } = options\r\n\r\n    console.log(`[CombinedAudio] Playing ${repeatCount} time(s): ${tone} + \"${taskName}\"`)\r\n\r\n    let allSuccessful = true\r\n\r\n    for (let i = 0; i < repeatCount; i++) {\r\n      console.log(`[CombinedAudio] Repetition ${i + 1} of ${repeatCount}`)\r\n      \r\n      try {\r\n        // 1. Play the tone first\r\n        console.log(`[CombinedAudio] Playing ${tone} tone...`)\r\n        playBellSound(tone)\r\n        \r\n        // 2. Wait for tone to finish\r\n        await new Promise(resolve => setTimeout(resolve, delayBetweenToneAndVoice))\r\n        \r\n        // 3. Play voice announcement\r\n        console.log(`[CombinedAudio] Playing voice announcement: \"${taskName}\"`)\r\n        const voiceSuccess = await playAnnouncement(taskName, voice, language, 1) // Single announcement per repetition\r\n        \r\n        if (!voiceSuccess) {\r\n          allSuccessful = false\r\n          console.error(`[CombinedAudio] Voice announcement failed for repetition ${i + 1}`)\r\n        }\r\n        \r\n        // 4. Wait between repetitions (except for the last one)\r\n        if (i < repeatCount - 1) {\r\n          console.log(`[CombinedAudio] Waiting ${delayBetweenRepeats}ms before next repetition...`)\r\n          await new Promise(resolve => setTimeout(resolve, delayBetweenRepeats))\r\n        }\r\n      } catch (error) {\r\n        allSuccessful = false\r\n        console.error(`[CombinedAudio] Error in repetition ${i + 1}:`, error)\r\n      }\r\n    }\r\n\r\n    console.log(`[CombinedAudio] Completed ${repeatCount} repetitions. Success: ${allSuccessful}`)\r\n    return allSuccessful\r\n  }\r\n\r\n  // Specific functions for different task types\r\n  static async playClassBell(taskName: string, options?: Partial<CombinedAudioOptions>): Promise<boolean> {\r\n    return this.playToneAndAnnouncement(taskName, {\r\n      tone: \"bell\",\r\n      delayBetweenToneAndVoice: 2000, // Longer delay for bell\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static async playBreakChime(taskName: string, options?: Partial<CombinedAudioOptions>): Promise<boolean> {\r\n    return this.playToneAndAnnouncement(taskName, {\r\n      tone: \"chime\",\r\n      delayBetweenToneAndVoice: 1000, // Shorter delay for chime\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static async playAnnouncement(taskName: string, options?: Partial<CombinedAudioOptions>): Promise<boolean> {\r\n    return this.playToneAndAnnouncement(taskName, {\r\n      tone: \"announcement\",\r\n      delayBetweenToneAndVoice: 800, // Quick notification sound\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static async playEmergencyAlert(taskName: string, options?: Partial<CombinedAudioOptions>): Promise<boolean> {\r\n    return this.playToneAndAnnouncement(taskName, {\r\n      tone: \"emergency-alert\",\r\n      delayBetweenToneAndVoice: 500, // Immediate voice after emergency tone\r\n      repeatCount: 3, // Emergency alerts repeat more\r\n      delayBetweenRepeats: 2000, // Shorter delay for urgency\r\n      ...options\r\n    })\r\n  }\r\n\r\n  // High-quality AI voice announcement (no tone, just premium voice)\r\n  static async playHighQualityAnnouncement(\r\n    message: string, \r\n    options?: Partial<CombinedAudioOptions>\r\n  ): Promise<boolean> {\r\n    const settings = useStore.getState().settings\r\n    const {\r\n      voice = \"openai-nova\", // Default to high-quality AI voice\r\n      language = settings.defaultLanguage,\r\n      repeatCount = settings.defaultRepeatCount\r\n    } = options || {}\r\n\r\n    console.log(`[CombinedAudio] Playing high-quality announcement: \"${message}\"`)\r\n\r\n    let allSuccessful = true\r\n\r\n    for (let i = 0; i < repeatCount; i++) {\r\n      console.log(`[CombinedAudio] High-quality announcement repetition ${i + 1} of ${repeatCount}`)\r\n      \r\n      try {\r\n        const voiceSuccess = await playAnnouncement(message, voice, language, 1)\r\n        \r\n        if (!voiceSuccess) {\r\n          allSuccessful = false\r\n          console.error(`[CombinedAudio] High-quality announcement failed for repetition ${i + 1}`)\r\n        }\r\n        \r\n        // Wait between repetitions (except for the last one)\r\n        if (i < repeatCount - 1) {\r\n          await new Promise(resolve => setTimeout(resolve, 3000))\r\n        }\r\n      } catch (error) {\r\n        allSuccessful = false\r\n        console.error(`[CombinedAudio] Error in high-quality announcement repetition ${i + 1}:`, error)\r\n      }\r\n    }\r\n\r\n    console.log(`[CombinedAudio] High-quality announcement completed. Success: ${allSuccessful}`)\r\n    return allSuccessful\r\n  }\r\n\r\n  // Normal announcement with tone + high-quality AI voice\r\n  static async playNormalAnnouncement(\r\n    message: string,\r\n    options?: Partial<CombinedAudioOptions>\r\n  ): Promise<boolean> {\r\n    return this.playToneAndAnnouncement(message, {\r\n      tone: \"announcement\",\r\n      voice: \"openai-nova\", // High-quality AI voice\r\n      delayBetweenToneAndVoice: 800,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  // Smart task-based audio player\r\n  static async playTaskAudio(\r\n    taskName: string,\r\n    taskType: string,\r\n    bellType?: BellType,\r\n    options?: Partial<CombinedAudioOptions>\r\n  ): Promise<boolean> {\r\n    console.log(`[CombinedAudio] Playing task audio for: \"${taskName}\" (Type: ${taskType}, Bell: ${bellType})`)\r\n    \r\n    // Determine appropriate tone and settings based on task type and bell type\r\n    let tone: BellType = bellType || \"bell\"\r\n    let delayBetweenToneAndVoice = 1500\r\n    let voiceMessage = taskName\r\n\r\n    // Customize based on task type\r\n    switch (taskType.toLowerCase()) {\r\n      case \"class\":\r\n      case \"lesson\":\r\n        tone = bellType || \"bell\"\r\n        delayBetweenToneAndVoice = 2000\r\n        voiceMessage = `Attention all students, it is time for ${taskName}. Please proceed to your classrooms.`\r\n        break\r\n      case \"break\":\r\n      case \"recess\":\r\n        tone = bellType || \"chime\"\r\n        delayBetweenToneAndVoice = 1000\r\n        voiceMessage = `Attention all students, it is time for ${taskName}. You may now leave your classrooms.`\r\n        break\r\n      case \"assembly\":\r\n      case \"meeting\":\r\n        tone = bellType || \"announcement\"\r\n        delayBetweenToneAndVoice = 800\r\n        voiceMessage = `Attention all students and staff, it is time for ${taskName}. Please proceed to the assembly hall.`\r\n        break\r\n      case \"lunch\":\r\n      case \"meal\":\r\n        tone = bellType || \"chime\"\r\n        delayBetweenToneAndVoice = 1200\r\n        voiceMessage = `Attention all students, it is time for ${taskName}. Please proceed to the dining hall.`\r\n        break\r\n      case \"dismissal\":\r\n      case \"end\":\r\n        tone = bellType || \"dismissal-bell\"\r\n        delayBetweenToneAndVoice = 2000\r\n        voiceMessage = `Attention all students, it is time for ${taskName}. Please collect your belongings and proceed to the exit.`\r\n        break\r\n      case \"emergency\":\r\n      case \"drill\":\r\n        tone = bellType || \"emergency-alert\"\r\n        delayBetweenToneAndVoice = 500\r\n        voiceMessage = `Emergency alert. ${taskName}. All students and staff must follow emergency procedures immediately.`\r\n        break\r\n      default:\r\n        // Use provided bell type or default\r\n        tone = bellType || \"bell\"\r\n        voiceMessage = `Attention all students, it is time for ${taskName}.`\r\n    }\r\n\r\n    return this.playToneAndAnnouncement(voiceMessage, {\r\n      tone,\r\n      delayBetweenToneAndVoice,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  // Get appropriate tone for task type\r\n  static getToneForTaskType(taskType: string): BellType {\r\n    switch (taskType.toLowerCase()) {\r\n      case \"class\":\r\n      case \"lesson\":\r\n      case \"dismissal\":\r\n        return \"bell\"\r\n      case \"break\":\r\n      case \"recess\":\r\n      case \"lunch\":\r\n        return \"chime\"\r\n      case \"assembly\":\r\n      case \"meeting\":\r\n      case \"announcement\":\r\n        return \"announcement\"\r\n      case \"emergency\":\r\n      case \"drill\":\r\n        return \"emergency-alert\"\r\n      default:\r\n        return \"bell\"\r\n    }\r\n  }\r\n\r\n  // Generate appropriate voice message for task\r\n  static generateVoiceMessage(taskName: string, taskType: string): string {\r\n    const baseMessages: Record<string, string> = {\r\n      class: `Attention all students, it is time for ${taskName}. Please proceed to your classrooms.`,\r\n      lesson: `Attention all students, it is time for ${taskName}. Please proceed to your classrooms.`,\r\n      break: `Attention all students, it is time for ${taskName}. You may now leave your classrooms.`,\r\n      recess: `Attention all students, it is time for ${taskName}. You may now leave your classrooms.`,\r\n      lunch: `Attention all students, it is time for ${taskName}. Please proceed to the dining hall.`,\r\n      assembly: `Attention all students and staff, it is time for ${taskName}. Please proceed to the assembly hall.`,\r\n      meeting: `Attention all students and staff, it is time for ${taskName}. Please proceed to the designated area.`,\r\n      announcement: `Attention all students and staff, it is time for ${taskName}. Please listen carefully.`,\r\n      dismissal: `Attention all students, it is time for ${taskName}. Please collect your belongings and proceed to the exit.`,\r\n      end: `Attention all students, it is time for ${taskName}. Please collect your belongings and proceed to the exit.`,\r\n      emergency: `Emergency alert. ${taskName}. All students and staff must follow emergency procedures immediately.`,\r\n      drill: `Emergency drill. ${taskName}. All students and staff must follow drill procedures immediately.`\r\n    }\r\n\r\n    return baseMessages[taskType.toLowerCase()] || `Attention all students, it is time for ${taskName}.`\r\n  }\r\n}\r\n\r\n// Export convenience functions\r\nexport const playToneAndAnnouncement = (taskName: string, options?: CombinedAudioOptions) =>\r\n  CombinedAudioPlayer.playToneAndAnnouncement(taskName, options)\r\n\r\nexport const playClassBell = (taskName: string, options?: Partial<CombinedAudioOptions>) =>\r\n  CombinedAudioPlayer.playClassBell(taskName, options)\r\n\r\nexport const playBreakChime = (taskName: string, options?: Partial<CombinedAudioOptions>) =>\r\n  CombinedAudioPlayer.playBreakChime(taskName, options)\r\n\r\nexport const playAnnouncementTone = (taskName: string, options?: Partial<CombinedAudioOptions>) =>\r\n  CombinedAudioPlayer.playAnnouncement(taskName, options)\r\n\r\nexport const playEmergencyAlert = (taskName: string, options?: Partial<CombinedAudioOptions>) =>\r\n  CombinedAudioPlayer.playEmergencyAlert(taskName, options)\r\n\r\nexport const playHighQualityAnnouncement = (message: string, options?: Partial<CombinedAudioOptions>) =>\r\n  CombinedAudioPlayer.playHighQualityAnnouncement(message, options)\r\n\r\nexport const playNormalAnnouncement = (message: string, options?: Partial<CombinedAudioOptions>) =>\r\n  CombinedAudioPlayer.playNormalAnnouncement(message, options)\r\n\r\nexport const playTaskAudio = (taskName: string, taskType: string, bellType?: BellType, options?: Partial<CombinedAudioOptions>) =>\r\n  CombinedAudioPlayer.playTaskAudio(taskName, taskType, bellType, options)\r\n\r\nexport const getToneForTaskType = (taskType: string) => CombinedAudioPlayer.getToneForTaskType(taskType)\r\n\r\nexport const generateVoiceMessage = (taskName: string, taskType: string) => \r\n  CombinedAudioPlayer.generateVoiceMessage(taskName, taskType)\r\n\r\n// Make it available globally for console testing\r\nif (typeof window !== \"undefined\") {\r\n  (window as any).CombinedAudioPlayer = CombinedAudioPlayer;\r\n  (window as any).playToneAndAnnouncement = playToneAndAnnouncement;\r\n  (window as any).playTaskAudio = playTaskAudio;\r\n  (window as any).playHighQualityAnnouncement = playHighQualityAnnouncement;\r\n  (window as any).playNormalAnnouncement = playNormalAnnouncement;\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4934, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/high-quality-announcements.ts"],"sourcesContent":["import { playHighQualityAnnouncement, playNormalAnnouncement } from \"./combined-audio\"\r\nimport type { VoiceType, Language } from \"./store\"\r\n\r\n/**\r\n * High-Quality AI Voice Announcement System\r\n * Uses premium AI voices for crystal-clear announcements\r\n */\r\n\r\nexport interface HighQualityAnnouncementOptions {\r\n  voice?: VoiceType\r\n  language?: Language\r\n  repeatCount?: number\r\n  withTone?: boolean\r\n}\r\n\r\nexport class HighQualityAnnouncementSystem {\r\n  // Premium AI voices for different announcement types\r\n  static readonly PREMIUM_VOICES = {\r\n    professional: \"openai-nova\" as VoiceType,      // Clear, professional female\r\n    authoritative: \"openai-onyx\" as VoiceType,     // Deep, authoritative male\r\n    friendly: \"openai-shimmer\" as VoiceType,       // Bright, friendly female\r\n    warm: \"openai-echo\" as VoiceType,              // Warm, rounded male\r\n    storytelling: \"openai-fable\" as VoiceType,     // British accent, engaging\r\n    balanced: \"openai-alloy\" as VoiceType,         // Neutral, balanced\r\n    elevenlabs: \"elevenlabs-rachel\" as VoiceType,  // Premium ElevenLabs voice\r\n    azure: \"azure-aria\" as VoiceType               // Microsoft Azure premium\r\n  }\r\n\r\n  // Play a custom announcement with high-quality AI voice\r\n  static async playCustomAnnouncement(\r\n    message: string,\r\n    options: HighQualityAnnouncementOptions = {}\r\n  ): Promise<boolean> {\r\n    const {\r\n      voice = this.PREMIUM_VOICES.professional,\r\n      language = \"english\",\r\n      repeatCount = 1,\r\n      withTone = false\r\n    } = options\r\n\r\n    console.log(`[HighQuality] Playing custom announcement with ${voice}`)\r\n    console.log(`[HighQuality] Message: \"${message}\"`)\r\n\r\n    if (withTone) {\r\n      return playNormalAnnouncement(message, {\r\n        voice,\r\n        language,\r\n        repeatCount\r\n      })\r\n    } else {\r\n      return playHighQualityAnnouncement(message, {\r\n        voice,\r\n        language,\r\n        repeatCount\r\n      })\r\n    }\r\n  }\r\n\r\n  // Professional school announcements\r\n  static async playSchoolAnnouncement(\r\n    title: string,\r\n    details: string,\r\n    options: HighQualityAnnouncementOptions = {}\r\n  ): Promise<boolean> {\r\n    const message = `Attention all students and staff. ${title}. ${details}`\r\n    \r\n    return this.playCustomAnnouncement(message, {\r\n      voice: this.PREMIUM_VOICES.professional,\r\n      withTone: true,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  // Emergency announcements with authoritative voice\r\n  static async playEmergencyAnnouncement(\r\n    emergency: string,\r\n    instructions: string,\r\n    options: HighQualityAnnouncementOptions = {}\r\n  ): Promise<boolean> {\r\n    const message = `Emergency alert. ${emergency}. ${instructions}. Please follow all safety procedures immediately.`\r\n    \r\n    return this.playCustomAnnouncement(message, {\r\n      voice: this.PREMIUM_VOICES.authoritative,\r\n      withTone: true,\r\n      repeatCount: 2,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  // Friendly announcements for positive news\r\n  static async playFriendlyAnnouncement(\r\n    message: string,\r\n    options: HighQualityAnnouncementOptions = {}\r\n  ): Promise<boolean> {\r\n    return this.playCustomAnnouncement(message, {\r\n      voice: this.PREMIUM_VOICES.friendly,\r\n      withTone: true,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  // Administrative announcements\r\n  static async playAdministrativeAnnouncement(\r\n    message: string,\r\n    options: HighQualityAnnouncementOptions = {}\r\n  ): Promise<boolean> {\r\n    return this.playCustomAnnouncement(message, {\r\n      voice: this.PREMIUM_VOICES.balanced,\r\n      withTone: true,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  // Test all premium voices\r\n  static async testAllPremiumVoices(): Promise<void> {\r\n    console.log(\"🎤 Testing All Premium AI Voices\")\r\n    console.log(\"=\" .repeat(50))\r\n\r\n    const testMessage = \"This is a test of the high-quality announcement system.\"\r\n    \r\n    for (const [name, voice] of Object.entries(this.PREMIUM_VOICES)) {\r\n      console.log(`\\n🔊 Testing ${name} voice (${voice})`)\r\n      \r\n      await this.playCustomAnnouncement(testMessage, {\r\n        voice,\r\n        repeatCount: 1,\r\n        withTone: false\r\n      })\r\n      \r\n      // Wait between tests\r\n      await new Promise(resolve => setTimeout(resolve, 4000))\r\n    }\r\n    \r\n    console.log(\"\\n✅ Premium voice testing completed!\")\r\n  }\r\n\r\n  // Demonstrate different announcement types\r\n  static async demonstrateAnnouncementTypes(): Promise<void> {\r\n    console.log(\"📢 Demonstrating High-Quality Announcement Types\")\r\n    console.log(\"=\" .repeat(60))\r\n\r\n    const demonstrations = [\r\n      {\r\n        type: \"School Announcement\",\r\n        func: () => this.playSchoolAnnouncement(\r\n          \"Morning Assembly\",\r\n          \"All students please proceed to the main hall for our weekly assembly\"\r\n        )\r\n      },\r\n      {\r\n        type: \"Emergency Announcement\", \r\n        func: () => this.playEmergencyAnnouncement(\r\n          \"Fire drill in progress\",\r\n          \"Please exit the building using the nearest emergency exit\"\r\n        )\r\n      },\r\n      {\r\n        type: \"Friendly Announcement\",\r\n        func: () => this.playFriendlyAnnouncement(\r\n          \"Congratulations to our basketball team for winning the championship! Well done everyone!\"\r\n        )\r\n      },\r\n      {\r\n        type: \"Administrative Announcement\",\r\n        func: () => this.playAdministrativeAnnouncement(\r\n          \"Reminder that parent-teacher conferences are scheduled for next week. Please check your emails for appointment times.\"\r\n        )\r\n      },\r\n      {\r\n        type: \"Custom High-Quality\",\r\n        func: () => this.playCustomAnnouncement(\r\n          \"This is a demonstration of our premium AI voice system with crystal-clear audio quality.\",\r\n          { voice: this.PREMIUM_VOICES.elevenlabs, withTone: false }\r\n        )\r\n      }\r\n    ]\r\n\r\n    for (const demo of demonstrations) {\r\n      console.log(`\\n🎯 ${demo.type}`)\r\n      await demo.func()\r\n      \r\n      // Wait between demonstrations\r\n      await new Promise(resolve => setTimeout(resolve, 6000))\r\n    }\r\n\r\n    console.log(\"\\n✅ All announcement type demonstrations completed!\")\r\n  }\r\n\r\n  // Quick test with the best voice\r\n  static async quickHighQualityTest(): Promise<void> {\r\n    console.log(\"⚡ Quick High-Quality Voice Test\")\r\n    \r\n    await this.playCustomAnnouncement(\r\n      \"Attention all students, this is a test of our premium AI voice announcement system. The audio quality should be crystal clear and professional.\",\r\n      {\r\n        voice: this.PREMIUM_VOICES.professional,\r\n        withTone: true,\r\n        repeatCount: 1\r\n      }\r\n    )\r\n    \r\n    console.log(\"✅ Quick test completed!\")\r\n  }\r\n\r\n  // Get available premium voices\r\n  static getAvailablePremiumVoices(): Array<{name: string, voice: VoiceType, description: string}> {\r\n    return [\r\n      { name: \"Professional\", voice: this.PREMIUM_VOICES.professional, description: \"Clear, professional female voice\" },\r\n      { name: \"Authoritative\", voice: this.PREMIUM_VOICES.authoritative, description: \"Deep, authoritative male voice\" },\r\n      { name: \"Friendly\", voice: this.PREMIUM_VOICES.friendly, description: \"Bright, friendly female voice\" },\r\n      { name: \"Warm\", voice: this.PREMIUM_VOICES.warm, description: \"Warm, rounded male voice\" },\r\n      { name: \"Storytelling\", voice: this.PREMIUM_VOICES.storytelling, description: \"British accent, engaging voice\" },\r\n      { name: \"Balanced\", voice: this.PREMIUM_VOICES.balanced, description: \"Neutral, balanced voice\" },\r\n      { name: \"ElevenLabs Premium\", voice: this.PREMIUM_VOICES.elevenlabs, description: \"Premium ElevenLabs voice\" },\r\n      { name: \"Azure Premium\", voice: this.PREMIUM_VOICES.azure, description: \"Microsoft Azure premium voice\" }\r\n    ]\r\n  }\r\n}\r\n\r\n// Export convenience functions\r\nexport const playCustomAnnouncement = (message: string, options?: HighQualityAnnouncementOptions) =>\r\n  HighQualityAnnouncementSystem.playCustomAnnouncement(message, options)\r\n\r\nexport const playSchoolAnnouncement = (title: string, details: string, options?: HighQualityAnnouncementOptions) =>\r\n  HighQualityAnnouncementSystem.playSchoolAnnouncement(title, details, options)\r\n\r\nexport const playEmergencyAnnouncement = (emergency: string, instructions: string, options?: HighQualityAnnouncementOptions) =>\r\n  HighQualityAnnouncementSystem.playEmergencyAnnouncement(emergency, instructions, options)\r\n\r\nexport const playFriendlyAnnouncement = (message: string, options?: HighQualityAnnouncementOptions) =>\r\n  HighQualityAnnouncementSystem.playFriendlyAnnouncement(message, options)\r\n\r\nexport const playAdministrativeAnnouncement = (message: string, options?: HighQualityAnnouncementOptions) =>\r\n  HighQualityAnnouncementSystem.playAdministrativeAnnouncement(message, options)\r\n\r\nexport const testAllPremiumVoices = () => HighQualityAnnouncementSystem.testAllPremiumVoices()\r\n\r\nexport const demonstrateAnnouncementTypes = () => HighQualityAnnouncementSystem.demonstrateAnnouncementTypes()\r\n\r\nexport const quickHighQualityTest = () => HighQualityAnnouncementSystem.quickHighQualityTest()\r\n\r\nexport const getAvailablePremiumVoices = () => HighQualityAnnouncementSystem.getAvailablePremiumVoices()\r\n\r\n// Make it available globally for console testing\r\nif (typeof window !== \"undefined\") {\r\n  (window as any).HighQualityAnnouncementSystem = HighQualityAnnouncementSystem;\r\n  (window as any).playCustomAnnouncement = playCustomAnnouncement;\r\n  (window as any).playSchoolAnnouncement = playSchoolAnnouncement;\r\n  (window as any).playEmergencyAnnouncement = playEmergencyAnnouncement;\r\n  (window as any).playFriendlyAnnouncement = playFriendlyAnnouncement;\r\n  (window as any).playAdministrativeAnnouncement = playAdministrativeAnnouncement;\r\n  (window as any).testAllPremiumVoices = testAllPremiumVoices;\r\n  (window as any).demonstrateAnnouncementTypes = demonstrateAnnouncementTypes;\r\n  (window as any).quickHighQualityTest = quickHighQualityTest;\r\n  (window as any).getAvailablePremiumVoices = getAvailablePremiumVoices;\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5150, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/lib/complete-bell-system.ts"],"sourcesContent":["import { playTaskAudio, playToneAndAnnouncement, CombinedAudioPlayer } from \"./combined-audio\"\r\nimport { playCustomAnnouncement } from \"./high-quality-announcements\"\r\nimport { playBellSound } from \"./bell-sounds\"\r\nimport { useStore } from \"./store\"\r\nimport type { BellType } from \"./bell-sounds\"\r\nimport type { VoiceType, Language } from \"./store\"\r\n\r\n/**\r\n * COMPLETE BELL SYSTEM FOR SCHOOL\r\n * Combines ringing tones with voice announcements\r\n * Supports all bell types, voice options, and scheduling\r\n */\r\n\r\nexport interface BellSystemOptions {\r\n  bellType?: BellType\r\n  voice?: VoiceType\r\n  language?: Language\r\n  repeatCount?: number\r\n  delayBetweenToneAndVoice?: number\r\n  delayBetweenRepeats?: number\r\n  useHighQualityVoice?: boolean\r\n}\r\n\r\nexport interface ScheduledBell {\r\n  id: string\r\n  name: string\r\n  time: string\r\n  day: string\r\n  bellType: BellType\r\n  message: string\r\n  voice?: VoiceType\r\n  enabled: boolean\r\n}\r\n\r\nexport class CompleteBellSystem {\r\n  // All available bell types with descriptions\r\n  static readonly BELL_TYPES = {\r\n    // Traditional bells\r\n    \"bell\": \"Traditional school bell - classic ringing sound\",\r\n    \"electronic-bell\": \"Modern electronic bell - sharp beeps\",\r\n    \"double-ring\": \"Double ring bell - two quick rings\",\r\n    \"triple-ring\": \"Triple ring bell - three quick rings\", \r\n    \"long-ring\": \"Long continuous ring - extended bell sound\",\r\n    \"dismissal-bell\": \"Dismissal bell - cheerful ascending melody\",\r\n    \r\n    // Chimes and soft tones\r\n    \"chime\": \"Soft melodic chime - pleasant ascending notes\",\r\n    \"westminster-chimes\": \"Westminster chimes - Big Ben style\",\r\n    \"islamic-chime\": \"Islamic chime - gentle prayer reminder\",\r\n    \"prayer-bell\": \"Prayer bell - reverent sustained tone\",\r\n    \r\n    // Announcement and alert tones\r\n    \"announcement\": \"Announcement tone - attention-getting sound\",\r\n    \"emergency-alert\": \"Emergency alert - urgent siren sound\",\r\n    \r\n    // Special purpose\r\n    \"adhan-call\": \"Adhan call - Islamic prayer call tone\"\r\n  } as const\r\n\r\n  // Premium voice options for announcements\r\n  static readonly PREMIUM_VOICES = {\r\n    \"openai-nova\": \"Professional female - clear and authoritative\",\r\n    \"openai-onyx\": \"Deep male - authoritative and commanding\", \r\n    \"openai-shimmer\": \"Bright female - friendly and welcoming\",\r\n    \"openai-echo\": \"Warm male - rounded and approachable\",\r\n    \"openai-fable\": \"British storytelling - engaging and articulate\",\r\n    \"openai-alloy\": \"Balanced neutral - versatile for all uses\",\r\n    \"elevenlabs-rachel\": \"Premium ElevenLabs - natural and expressive\",\r\n    \"azure-aria\": \"Microsoft Azure - helpful and conversational\"\r\n  } as const\r\n\r\n  // Play a complete bell sequence (tone + voice)\r\n  static async playBellSequence(\r\n    bellName: string,\r\n    message: string,\r\n    options: BellSystemOptions = {}\r\n  ): Promise<boolean> {\r\n    const settings = useStore.getState().settings\r\n    const {\r\n      bellType = \"bell\",\r\n      voice = settings.defaultVoice,\r\n      language = settings.defaultLanguage,\r\n      repeatCount = settings.defaultRepeatCount,\r\n      delayBetweenToneAndVoice = 1500,\r\n      delayBetweenRepeats = 3000,\r\n      useHighQualityVoice = true\r\n    } = options\r\n\r\n    console.log(`[BellSystem] Playing bell sequence: ${bellName}`)\r\n    console.log(`[BellSystem] Bell type: ${bellType}, Voice: ${voice}`)\r\n    console.log(`[BellSystem] Message: \"${message}\"`)\r\n\r\n    let allSuccessful = true\r\n\r\n    for (let i = 0; i < repeatCount; i++) {\r\n      console.log(`[BellSystem] Sequence ${i + 1} of ${repeatCount}`)\r\n      \r\n      try {\r\n        // 1. Play the bell/tone first\r\n        console.log(`[BellSystem] Playing ${bellType} tone...`)\r\n        playBellSound(bellType)\r\n        \r\n        // 2. Wait for tone to finish\r\n        await new Promise(resolve => setTimeout(resolve, delayBetweenToneAndVoice))\r\n        \r\n        // 3. Play voice announcement\r\n        console.log(`[BellSystem] Playing voice: \"${message}\"`)\r\n        let voiceSuccess: boolean\r\n        \r\n        if (useHighQualityVoice && this.isAIVoice(voice)) {\r\n          voiceSuccess = await playCustomAnnouncement(message, {\r\n            voice,\r\n            language,\r\n            withTone: false // We already played the tone\r\n          })\r\n        } else {\r\n          voiceSuccess = await playToneAndAnnouncement(message, {\r\n            tone: \"bell\", // Dummy tone, we already played the real one\r\n            voice,\r\n            language,\r\n            repeatCount: 1\r\n          })\r\n        }\r\n        \r\n        if (!voiceSuccess) {\r\n          allSuccessful = false\r\n          console.error(`[BellSystem] Voice failed for sequence ${i + 1}`)\r\n        }\r\n        \r\n        // 4. Wait between repetitions\r\n        if (i < repeatCount - 1) {\r\n          console.log(`[BellSystem] Waiting ${delayBetweenRepeats}ms before next sequence...`)\r\n          await new Promise(resolve => setTimeout(resolve, delayBetweenRepeats))\r\n        }\r\n      } catch (error) {\r\n        allSuccessful = false\r\n        console.error(`[BellSystem] Error in sequence ${i + 1}:`, error)\r\n      }\r\n    }\r\n\r\n    console.log(`[BellSystem] Bell sequence completed. Success: ${allSuccessful}`)\r\n    return allSuccessful\r\n  }\r\n\r\n  // School-specific bell functions\r\n  static async playClassBell(className: string, options?: BellSystemOptions): Promise<boolean> {\r\n    const message = `Attention all students, it is time for ${className}. Please proceed to your classrooms.`\r\n    return this.playBellSequence(className, message, {\r\n      bellType: \"bell\",\r\n      delayBetweenToneAndVoice: 2000,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static async playBreakBell(breakName: string, options?: BellSystemOptions): Promise<boolean> {\r\n    const message = `Attention all students, it is time for ${breakName}. You may now leave your classrooms.`\r\n    return this.playBellSequence(breakName, message, {\r\n      bellType: \"chime\",\r\n      delayBetweenToneAndVoice: 1000,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static async playLunchBell(options?: BellSystemOptions): Promise<boolean> {\r\n    const message = \"Attention all students, it is time for lunch. Please proceed to the dining hall.\"\r\n    return this.playBellSequence(\"Lunch Time\", message, {\r\n      bellType: \"chime\",\r\n      delayBetweenToneAndVoice: 1200,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static async playAssemblyBell(assemblyName: string, options?: BellSystemOptions): Promise<boolean> {\r\n    const message = `Attention all students and staff, it is time for ${assemblyName}. Please proceed to the assembly hall.`\r\n    return this.playBellSequence(assemblyName, message, {\r\n      bellType: \"announcement\",\r\n      delayBetweenToneAndVoice: 800,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static async playDismissalBell(options?: BellSystemOptions): Promise<boolean> {\r\n    const message = \"Attention all students, it is time for school dismissal. Please collect your belongings and proceed to the exit.\"\r\n    return this.playBellSequence(\"School Dismissal\", message, {\r\n      bellType: \"dismissal-bell\",\r\n      delayBetweenToneAndVoice: 2000,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static async playEmergencyBell(emergency: string, instructions: string, options?: BellSystemOptions): Promise<boolean> {\r\n    const message = `Emergency alert. ${emergency}. ${instructions}. All students and staff must follow emergency procedures immediately.`\r\n    return this.playBellSequence(\"Emergency\", message, {\r\n      bellType: \"emergency-alert\",\r\n      delayBetweenToneAndVoice: 500,\r\n      repeatCount: 3,\r\n      delayBetweenRepeats: 2000,\r\n      voice: \"openai-onyx\", // Authoritative voice for emergencies\r\n      ...options\r\n    })\r\n  }\r\n\r\n  static async playPrayerBell(prayerName: string, options?: BellSystemOptions): Promise<boolean> {\r\n    const message = `It is time for ${prayerName} prayer. Please proceed to the prayer area.`\r\n    return this.playBellSequence(prayerName, message, {\r\n      bellType: \"prayer-bell\",\r\n      delayBetweenToneAndVoice: 1500,\r\n      voice: \"azan-islamic\",\r\n      language: \"arabic\",\r\n      ...options\r\n    })\r\n  }\r\n\r\n  // Custom bell with any message\r\n  static async playCustomBell(\r\n    bellName: string,\r\n    message: string,\r\n    bellType: BellType,\r\n    options?: BellSystemOptions\r\n  ): Promise<boolean> {\r\n    return this.playBellSequence(bellName, message, {\r\n      bellType,\r\n      ...options\r\n    })\r\n  }\r\n\r\n  // Test all bell types\r\n  static async testAllBellTypes(): Promise<void> {\r\n    console.log(\"🔔 Testing All Bell Types\")\r\n    console.log(\"=\" .repeat(50))\r\n\r\n    for (const [bellType, description] of Object.entries(this.BELL_TYPES)) {\r\n      console.log(`\\n🔊 Testing: ${bellType}`)\r\n      console.log(`   Description: ${description}`)\r\n      \r\n      await this.playBellSequence(\r\n        `Test ${bellType}`,\r\n        `This is a test of the ${bellType} with voice announcement.`,\r\n        {\r\n          bellType: bellType as BellType,\r\n          repeatCount: 1,\r\n          useHighQualityVoice: true,\r\n          voice: \"openai-nova\"\r\n        }\r\n      )\r\n      \r\n      // Wait between tests\r\n      await new Promise(resolve => setTimeout(resolve, 4000))\r\n    }\r\n\r\n    console.log(\"\\n✅ All bell types tested!\")\r\n  }\r\n\r\n  // Test all premium voices\r\n  static async testAllVoices(): Promise<void> {\r\n    console.log(\"🎤 Testing All Premium Voices\")\r\n    console.log(\"=\" .repeat(50))\r\n\r\n    const testMessage = \"This is a test of the premium voice with bell system integration.\"\r\n\r\n    for (const [voice, description] of Object.entries(this.PREMIUM_VOICES)) {\r\n      console.log(`\\n🗣️ Testing: ${voice}`)\r\n      console.log(`   Description: ${description}`)\r\n      \r\n      await this.playBellSequence(\r\n        `Voice Test`,\r\n        testMessage,\r\n        {\r\n          bellType: \"chime\",\r\n          voice: voice as VoiceType,\r\n          repeatCount: 1,\r\n          useHighQualityVoice: true\r\n        }\r\n      )\r\n      \r\n      // Wait between tests\r\n      await new Promise(resolve => setTimeout(resolve, 4000))\r\n    }\r\n\r\n    console.log(\"\\n✅ All voices tested!\")\r\n  }\r\n\r\n  // Demonstrate a complete school day\r\n  static async demonstrateSchoolDay(): Promise<void> {\r\n    console.log(\"🏫 Complete School Day Bell Demonstration\")\r\n    console.log(\"=\" .repeat(60))\r\n\r\n    const schoolSchedule = [\r\n      { time: \"08:00\", func: () => this.playAssemblyBell(\"Morning Assembly\") },\r\n      { time: \"08:30\", func: () => this.playClassBell(\"First Period - Mathematics\") },\r\n      { time: \"09:30\", func: () => this.playBreakBell(\"Morning Break\") },\r\n      { time: \"09:45\", func: () => this.playClassBell(\"Second Period - English\") },\r\n      { time: \"10:45\", func: () => this.playClassBell(\"Third Period - Science\") },\r\n      { time: \"11:45\", func: () => this.playLunchBell() },\r\n      { time: \"12:30\", func: () => this.playClassBell(\"Fourth Period - History\") },\r\n      { time: \"13:30\", func: () => this.playClassBell(\"Fifth Period - Art\") },\r\n      { time: \"14:30\", func: () => this.playDismissalBell() }\r\n    ]\r\n\r\n    for (const event of schoolSchedule) {\r\n      console.log(`\\n🕐 ${event.time} - Playing school bell...`)\r\n      await event.func()\r\n      \r\n      // Wait between events (shorter for demo)\r\n      await new Promise(resolve => setTimeout(resolve, 6000))\r\n    }\r\n\r\n    console.log(\"\\n✅ Complete school day demonstration finished!\")\r\n  }\r\n\r\n  // Emergency drill demonstration\r\n  static async demonstrateEmergencyDrills(): Promise<void> {\r\n    console.log(\"🚨 Emergency Drill Demonstrations\")\r\n    console.log(\"=\" .repeat(50))\r\n\r\n    const emergencies = [\r\n      {\r\n        name: \"Fire Drill\",\r\n        instructions: \"Please exit the building using the nearest emergency exit and proceed to the assembly point\"\r\n      },\r\n      {\r\n        name: \"Earthquake Drill\", \r\n        instructions: \"Drop, cover, and hold on. Stay under your desks until the shaking stops\"\r\n      },\r\n      {\r\n        name: \"Lockdown Drill\",\r\n        instructions: \"Please remain in your classrooms and follow lockdown procedures\"\r\n      },\r\n      {\r\n        name: \"Severe Weather Alert\",\r\n        instructions: \"Please move to the designated safe areas immediately\"\r\n      }\r\n    ]\r\n\r\n    for (const emergency of emergencies) {\r\n      console.log(`\\n🚨 ${emergency.name}`)\r\n      await this.playEmergencyBell(emergency.name, emergency.instructions, {\r\n        repeatCount: 2 // Emergency drills repeat twice\r\n      })\r\n      \r\n      // Wait between drills\r\n      await new Promise(resolve => setTimeout(resolve, 8000))\r\n    }\r\n\r\n    console.log(\"\\n✅ Emergency drill demonstrations completed!\")\r\n  }\r\n\r\n  // Get system status\r\n  static getSystemStatus(): {\r\n    bellTypes: number\r\n    voices: number\r\n    features: string[]\r\n  } {\r\n    return {\r\n      bellTypes: Object.keys(this.BELL_TYPES).length,\r\n      voices: Object.keys(this.PREMIUM_VOICES).length,\r\n      features: [\r\n        \"Tone + Voice Combination\",\r\n        \"High-Quality AI Voices\", \r\n        \"Multiple Bell Types\",\r\n        \"School Schedule Integration\",\r\n        \"Emergency Alert System\",\r\n        \"Prayer Time Support\",\r\n        \"Custom Messages\",\r\n        \"Repeat Functionality\"\r\n      ]\r\n    }\r\n  }\r\n\r\n  // Helper function to check if voice is AI\r\n  static isAIVoice(voice: VoiceType): boolean {\r\n    return voice.startsWith(\"openai-\") || \r\n           voice.startsWith(\"elevenlabs-\") || \r\n           voice.startsWith(\"azure-\")\r\n  }\r\n\r\n  // Show all available options\r\n  static showAllOptions(): void {\r\n    console.log(\"🔔 COMPLETE BELL SYSTEM OPTIONS\")\r\n    console.log(\"=\" .repeat(60))\r\n    \r\n    console.log(\"\\n🔊 AVAILABLE BELL TYPES:\")\r\n    Object.entries(this.BELL_TYPES).forEach(([type, desc], index) => {\r\n      console.log(`${index + 1}. ${type} - ${desc}`)\r\n    })\r\n    \r\n    console.log(\"\\n🎤 AVAILABLE PREMIUM VOICES:\")\r\n    Object.entries(this.PREMIUM_VOICES).forEach(([voice, desc], index) => {\r\n      console.log(`${index + 1}. ${voice} - ${desc}`)\r\n    })\r\n    \r\n    console.log(\"\\n📚 SCHOOL BELL FUNCTIONS:\")\r\n    console.log(\"• playClassBell(className)\")\r\n    console.log(\"• playBreakBell(breakName)\")\r\n    console.log(\"• playLunchBell()\")\r\n    console.log(\"• playAssemblyBell(assemblyName)\")\r\n    console.log(\"• playDismissalBell()\")\r\n    console.log(\"• playEmergencyBell(emergency, instructions)\")\r\n    console.log(\"• playPrayerBell(prayerName)\")\r\n    console.log(\"• playCustomBell(name, message, bellType)\")\r\n    \r\n    console.log(\"\\n🧪 TEST FUNCTIONS:\")\r\n    console.log(\"• testAllBellTypes()\")\r\n    console.log(\"• testAllVoices()\")\r\n    console.log(\"• demonstrateSchoolDay()\")\r\n    console.log(\"• demonstrateEmergencyDrills()\")\r\n    \r\n    const status = this.getSystemStatus()\r\n    console.log(`\\n📊 SYSTEM STATUS:`)\r\n    console.log(`• ${status.bellTypes} bell types available`)\r\n    console.log(`• ${status.voices} premium voices available`)\r\n    console.log(`• ${status.features.length} features supported`)\r\n    \r\n    console.log(\"=\" .repeat(60))\r\n  }\r\n}\r\n\r\n// Export convenience functions\r\nexport const playClassBell = (className: string, options?: BellSystemOptions) =>\r\n  CompleteBellSystem.playClassBell(className, options)\r\n\r\nexport const playBreakBell = (breakName: string, options?: BellSystemOptions) =>\r\n  CompleteBellSystem.playBreakBell(breakName, options)\r\n\r\nexport const playLunchBell = (options?: BellSystemOptions) =>\r\n  CompleteBellSystem.playLunchBell(options)\r\n\r\nexport const playAssemblyBell = (assemblyName: string, options?: BellSystemOptions) =>\r\n  CompleteBellSystem.playAssemblyBell(assemblyName, options)\r\n\r\nexport const playDismissalBell = (options?: BellSystemOptions) =>\r\n  CompleteBellSystem.playDismissalBell(options)\r\n\r\nexport const playEmergencyBell = (emergency: string, instructions: string, options?: BellSystemOptions) =>\r\n  CompleteBellSystem.playEmergencyBell(emergency, instructions, options)\r\n\r\nexport const playPrayerBell = (prayerName: string, options?: BellSystemOptions) =>\r\n  CompleteBellSystem.playPrayerBell(prayerName, options)\r\n\r\nexport const playCustomBell = (name: string, message: string, bellType: BellType, options?: BellSystemOptions) =>\r\n  CompleteBellSystem.playCustomBell(name, message, bellType, options)\r\n\r\nexport const testAllBellTypes = () => CompleteBellSystem.testAllBellTypes()\r\nexport const testAllVoices = () => CompleteBellSystem.testAllVoices()\r\nexport const demonstrateSchoolDay = () => CompleteBellSystem.demonstrateSchoolDay()\r\nexport const demonstrateEmergencyDrills = () => CompleteBellSystem.demonstrateEmergencyDrills()\r\nexport const showAllBellOptions = () => CompleteBellSystem.showAllOptions()\r\nexport const getBellSystemStatus = () => CompleteBellSystem.getSystemStatus()\r\n\r\n// Make it available globally for console testing\r\nif (typeof window !== \"undefined\") {\r\n  (window as any).CompleteBellSystem = CompleteBellSystem;\r\n  (window as any).playClassBell = playClassBell;\r\n  (window as any).playBreakBell = playBreakBell;\r\n  (window as any).playLunchBell = playLunchBell;\r\n  (window as any).playAssemblyBell = playAssemblyBell;\r\n  (window as any).playDismissalBell = playDismissalBell;\r\n  (window as any).playEmergencyBell = playEmergencyBell;\r\n  (window as any).playPrayerBell = playPrayerBell;\r\n  (window as any).playCustomBell = playCustomBell;\r\n  (window as any).testAllBellTypes = testAllBellTypes;\r\n  (window as any).testAllVoices = testAllVoices;\r\n  (window as any).demonstrateSchoolDay = demonstrateSchoolDay;\r\n  (window as any).demonstrateEmergencyDrills = demonstrateEmergencyDrills;\r\n  (window as any).showAllBellOptions = showAllBellOptions;\r\n  (window as any).getBellSystemStatus = getBellSystemStatus;\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5536, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/dashboard.tsx"],"sourcesContent":["\"use client\"\n\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Bell, Users, Volume2, Wifi } from \"lucide-react\"\nimport { useStore } from \"@/lib/store\"\nimport { playAzanCall, getTTSStatus } from \"@/lib/voice-utils\"\nimport { CompleteBellSystem } from \"@/lib/complete-bell-system\"\nimport { BellSystemStatus } from \"./bell-system-status\"\nimport { useEffect, useRef, useState } from \"react\"\n\n// Helper function to derive task type from timetable name\nconst deriveTaskType = (name: string): string => {\n  const lowerName = name.toLowerCase()\n  \n  if (lowerName.includes(\"assembly\") || lowerName.includes(\"meeting\")) return \"assembly\"\n  if (lowerName.includes(\"break\") || lowerName.includes(\"recess\")) return \"break\"\n  if (lowerName.includes(\"lunch\") || lowerName.includes(\"meal\")) return \"lunch\"\n  if (lowerName.includes(\"dismissal\") || lowerName.includes(\"end\") || lowerName.includes(\"home\")) return \"dismissal\"\n  if (lowerName.includes(\"emergency\") || lowerName.includes(\"drill\") || lowerName.includes(\"fire\")) return \"emergency\"\n  if (lowerName.includes(\"class\") || lowerName.includes(\"period\") || lowerName.includes(\"lesson\")) return \"class\"\n  \n  // Default to class for most school activities\n  return \"class\"\n}\n\nexport function Dashboard() {\n  const { timetables, students, devices, settings } = useStore()\n  const lastCheckedPrayerRef = useRef<string>(\"\")\n  const lastCheckedTimetableRef = useRef<string>(\"\")\n  const [ttsStatus, setTtsStatus] = useState({ available: true, message: \"TTS is ready\" })\n\n  useEffect(() => {\n    // Check TTS status on client side only\n    setTtsStatus(getTTSStatus())\n  }, [])\n\n  useEffect(() => {\n    if (!settings.azanEnabled || !settings.prayerTimes) return\n\n    const checkPrayerTimes = async () => {\n      const now = new Date()\n      const currentTime =\n        now.getHours().toString().padStart(2, \"0\") + \":\" + now.getMinutes().toString().padStart(2, \"0\")\n\n      // Only play once per minute to avoid multiple triggers\n      if (currentTime === lastCheckedPrayerRef.current) return\n      lastCheckedPrayerRef.current = currentTime\n\n      console.log(\"[v0] Checking prayer times. Current time:\", currentTime)\n\n      for (const [prayer, time] of Object.entries(settings.prayerTimes || {})) {\n        if (currentTime === time) {\n          console.log(\"[v0] Prayer time matched! Playing Azan for:\", prayer)\n          await playAzanCall(prayer)\n        }\n      }\n    }\n\n    // Check immediately on mount\n    checkPrayerTimes()\n\n    // Check every minute\n    const interval = setInterval(checkPrayerTimes, 60000)\n    return () => clearInterval(interval)\n  }, [settings.azanEnabled, settings.prayerTimes])\n\n  // Timetable scheduler\n  useEffect(() => {\n    if (timetables.length === 0) return\n\n    const checkTimetables = async () => {\n      const now = new Date()\n      const currentTime =\n        now.getHours().toString().padStart(2, \"0\") + \":\" + now.getMinutes().toString().padStart(2, \"0\")\n      const currentDay = now.toLocaleDateString('en-US', { weekday: 'long' })\n\n      // Only play once per minute to avoid multiple triggers\n      if (currentTime === lastCheckedTimetableRef.current) return\n      lastCheckedTimetableRef.current = currentTime\n\n      console.log(\"[v0] Checking timetables. Current time:\", currentTime, \"Day:\", currentDay)\n\n      for (const timetable of timetables) {\n        // Check if this timetable should trigger now\n        const shouldTrigger =\n          currentTime === timetable.bellTime &&\n          (timetable.day === \"Daily\" || timetable.day === currentDay)\n\n        if (shouldTrigger) {\n          console.log(\"[v0] Timetable matched! Triggering:\", timetable.name, \"Type:\", timetable.bellType)\n          \n          // Use Complete Bell System - perfect tone + voice combination\n          const taskType = deriveTaskType(timetable.name)\n          \n          // Generate professional message based on task type\n          let message: string\n          switch (taskType) {\n            case \"class\":\n            case \"lesson\":\n              message = `Attention all students, it is time for ${timetable.name}. Please proceed to your classrooms.`\n              break\n            case \"break\":\n            case \"recess\":\n              message = `Attention all students, it is time for ${timetable.name}. You may now leave your classrooms.`\n              break\n            case \"assembly\":\n            case \"meeting\":\n              message = `Attention all students and staff, it is time for ${timetable.name}. Please proceed to the assembly hall.`\n              break\n            case \"lunch\":\n            case \"meal\":\n              message = `Attention all students, it is time for ${timetable.name}. Please proceed to the dining hall.`\n              break\n            case \"dismissal\":\n            case \"end\":\n              message = `Attention all students, it is time for ${timetable.name}. Please collect your belongings and proceed to the exit.`\n              break\n            case \"emergency\":\n            case \"drill\":\n              message = `Emergency alert. ${timetable.name}. All students and staff must follow emergency procedures immediately.`\n              break\n            default:\n              message = `Attention all students, it is time for ${timetable.name}.`\n          }\n          \n          // Play complete bell sequence: tone first → voice announcement\n          await CompleteBellSystem.playBellSequence(\n            timetable.name,\n            message,\n            {\n              bellType: timetable.bellType as any,\n              voice: settings.defaultVoice,\n              language: settings.defaultLanguage,\n              repeatCount: settings.defaultRepeatCount,\n              useHighQualityVoice: true\n            }\n          )\n        }\n      }\n    }\n\n    // Check immediately on mount\n    checkTimetables()\n\n    // Check every minute\n    const interval = setInterval(checkTimetables, 60000)\n    return () => clearInterval(interval)\n  }, [timetables, settings.defaultVoice, settings.defaultLanguage])\n\n  // Calculate next timetable event\n  const getNextTimetableEvent = () => {\n    if (timetables.length === 0) {\n      return { name: \"No Timetables Set\", timeUntil: \"Create in Timetables\" }\n    }\n\n    const now = new Date()\n    const currentTime = now.getHours() * 60 + now.getMinutes()\n    const currentDay = now.toLocaleDateString('en-US', { weekday: 'long' })\n\n    // Get today's timetables\n    const todayTimetables = timetables\n      .filter(tt => tt.day === \"Daily\" || tt.day === currentDay)\n      .map(tt => {\n        const [hours, minutes] = tt.bellTime.split(':').map(Number)\n        const eventMinutes = hours * 60 + minutes\n        return { ...tt, minutes: eventMinutes }\n      })\n      .sort((a, b) => a.minutes - b.minutes)\n\n    // Find next event today\n    let nextEvent = todayTimetables.find(tt => tt.minutes > currentTime)\n\n    if (nextEvent) {\n      const minutesUntil = nextEvent.minutes - currentTime\n      const hoursUntil = Math.floor(minutesUntil / 60)\n      const minsUntil = minutesUntil % 60\n      return {\n        name: nextEvent.name,\n        timeUntil: `In ${hoursUntil}h ${minsUntil}m`\n      }\n    }\n\n    // If no event today, find tomorrow's first event\n    const tomorrowEvents = timetables\n      .filter(tt => tt.day === \"Daily\")\n      .map(tt => {\n        const [hours, minutes] = tt.bellTime.split(':').map(Number)\n        return { ...tt, minutes: hours * 60 + minutes }\n      })\n      .sort((a, b) => a.minutes - b.minutes)\n\n    if (tomorrowEvents.length > 0) {\n      const nextEvent = tomorrowEvents[0]\n      const minutesUntil = (24 * 60) - currentTime + nextEvent.minutes\n      const hoursUntil = Math.floor(minutesUntil / 60)\n      const minsUntil = minutesUntil % 60\n      return {\n        name: `${nextEvent.name} (Tomorrow)`,\n        timeUntil: `In ${hoursUntil}h ${minsUntil}m`\n      }\n    }\n\n    return { name: \"No Upcoming Events\", timeUntil: \"Check timetables\" }\n  }\n\n  // Calculate next prayer time\n  const getNextPrayerTime = () => {\n    if (!settings.azanEnabled || !settings.prayerTimes) {\n      return { name: \"No Prayer Times Set\", timeUntil: \"Configure in Settings\" }\n    }\n\n    const now = new Date()\n    const currentTime = now.getHours() * 60 + now.getMinutes() // Convert to minutes since midnight\n\n    const prayerTimes = Object.entries(settings.prayerTimes).map(([name, time]) => {\n      const [hours, minutes] = time.split(':').map(Number)\n      const prayerMinutes = hours * 60 + minutes\n      return { name: name.charAt(0).toUpperCase() + name.slice(1), time, minutes: prayerMinutes }\n    }).sort((a, b) => a.minutes - b.minutes)\n\n    // Find next prayer time\n    let nextPrayer = prayerTimes.find(prayer => prayer.minutes > currentTime)\n\n    // If no prayer found today, use first prayer of tomorrow\n    if (!nextPrayer) {\n      nextPrayer = prayerTimes[0]\n      const minutesUntil = (24 * 60) - currentTime + nextPrayer.minutes\n      const hoursUntil = Math.floor(minutesUntil / 60)\n      const minsUntil = minutesUntil % 60\n      return {\n        name: `${nextPrayer.name} (Tomorrow)`,\n        timeUntil: `In ${hoursUntil}h ${minsUntil}m`\n      }\n    }\n\n    const minutesUntil = nextPrayer.minutes - currentTime\n    const hoursUntil = Math.floor(minutesUntil / 60)\n    const minsUntil = minutesUntil % 60\n\n    return {\n      name: nextPrayer.name,\n      timeUntil: `In ${hoursUntil}h ${minsUntil}m`\n    }\n  }\n\n  const nextPrayer = getNextPrayerTime()\n  const nextTimetableEvent = getNextTimetableEvent()\n\n  const stats = [\n    {\n      title: \"Active Timetables\",\n      value: timetables.length,\n      icon: Bell,\n      color: \"text-blue-600\",\n    },\n    {\n      title: \"Students\",\n      value: students.length,\n      icon: Users,\n      color: \"text-green-600\",\n    },\n    {\n      title: \"Announcements Today\",\n      value: \"3\",\n      icon: Volume2,\n      color: \"text-purple-600\",\n    },\n    {\n      title: \"Connected Devices\",\n      value: devices.filter((d) => d.status === \"online\").length,\n      icon: Wifi,\n      color: \"text-orange-600\",\n    },\n  ]\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-4xl font-bold text-foreground mb-2\">Dashboard</h1>\n        <p className=\"text-foreground/60\">System Overview & Quick Stats</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n        {stats.map((stat, idx) => {\n          const Icon = stat.icon\n          return (\n            <Card key={idx}>\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4\">\n                <CardTitle className=\"text-sm font-medium\">{stat.title}</CardTitle>\n                <Icon className={`w-4 h-4 ${stat.color}`} />\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold\">{stat.value}</div>\n              </CardContent>\n            </Card>\n          )\n        })}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Next Timetable Event</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-2xl font-bold text-green-600\">{nextTimetableEvent.name}</p>\n            <p className=\"text-foreground/60 mt-2\">{nextTimetableEvent.timeUntil}</p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Next Prayer Time</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-2xl font-bold text-blue-600\">{nextPrayer.name}</p>\n            <p className=\"text-foreground/60 mt-2\">{nextPrayer.timeUntil}</p>\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Today's Prayer Times</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {settings.azanEnabled && settings.prayerTimes ? (\n              <div className=\"space-y-2\">\n                {Object.entries(settings.prayerTimes).map(([prayer, time]) => (\n                  <div key={prayer} className=\"flex justify-between\">\n                    <span className=\"text-foreground/60 capitalize\">{prayer}</span>\n                    <span className=\"font-semibold\">{time}</span>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-foreground/60\">Prayer times not configured</p>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>System Status</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-foreground/60\">Database</span>\n                <span className=\"text-green-600 font-semibold\">Online</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-foreground/60\">TTS Engine</span>\n                <span className={ttsStatus.available ? \"text-green-600 font-semibold\" : \"text-red-600 font-semibold\"}>\n                  {ttsStatus.available ? \"Ready\" : \"Unavailable\"}\n                </span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-foreground/60\">Prayer Scheduler</span>\n                <span className={settings.azanEnabled ? \"text-green-600 font-semibold\" : \"text-gray-500 font-semibold\"}>\n                  {settings.azanEnabled ? \"Active\" : \"Disabled\"}\n                </span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-foreground/60\">Timetable Scheduler</span>\n                <span className={timetables.length > 0 ? \"text-green-600 font-semibold\" : \"text-gray-500 font-semibold\"}>\n                  {timetables.length > 0 ? \"Active\" : \"No Timetables\"}\n                </span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6208, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,uRAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,2JAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 6233, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/timetable.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState } from \"react\"\nimport { useStore } from \"@/lib/store\"\nimport { Card, CardContent } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Trash2, Plus, Edit2, Volume2 } from \"lucide-react\"\nimport { CompleteBellSystem } from \"@/lib/complete-bell-system\"\nimport type { BellType } from \"@/lib/bell-sounds\"\n\nexport function Timetable() {\n  const { timetables, addTimetable, removeTimetable, updateTimetable } = useStore()\n  const [showForm, setShowForm] = useState(false)\n  const [editingId, setEditingId] = useState<string | null>(null)\n  const [formData, setFormData] = useState({\n    name: \"\",\n    day: \"Monday\",\n    bellTime: \"\",\n    bellType: \"bell\",\n  })\n\n  const days = [\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\", \"Sunday\", \"Daily\"]\n  const bellTypes = [\n    \"bell\",\n    \"electronic-bell\",\n    \"westminster-chimes\",\n    \"double-ring\",\n    \"triple-ring\",\n    \"long-ring\",\n    \"chime\",\n    \"announcement\",\n    \"emergency-alert\",\n    \"dismissal-bell\",\n    \"adhan-call\",\n    \"islamic-chime\",\n    \"prayer-bell\"\n  ]\n\n  const formatBellTypeName = (type: string): string => {\n    const names: Record<string, string> = {\n      'bell': 'Traditional Bell',\n      'electronic-bell': 'Electronic Bell',\n      'westminster-chimes': 'Westminster Chimes',\n      'double-ring': 'Double Ring',\n      'triple-ring': 'Triple Ring',\n      'long-ring': 'Long Ring',\n      'chime': 'Soft Chime',\n      'announcement': 'Announcement Tone',\n      'emergency-alert': 'Emergency Alert',\n      'dismissal-bell': 'Dismissal Bell',\n      'adhan-call': 'Adhan Call (Islamic)',\n      'islamic-chime': 'Islamic Chime',\n      'prayer-bell': 'Prayer Bell (Islamic)'\n    }\n    return names[type] || type\n  }\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!formData.name || !formData.bellTime) return\n\n    if (editingId) {\n      updateTimetable(editingId, formData)\n      setEditingId(null)\n    } else {\n      addTimetable({\n        id: Date.now().toString(),\n        ...formData,\n      })\n    }\n\n    setFormData({ name: \"\", day: \"Monday\", bellTime: \"\", bellType: \"bell\" })\n    setShowForm(false)\n  }\n\n  const startEdit = (id: string) => {\n    const timetable = timetables.find((t) => t.id === id)\n    if (timetable) {\n      setFormData({\n        name: timetable.name,\n        day: timetable.day,\n        bellTime: timetable.bellTime,\n        bellType: timetable.bellType,\n      })\n      setEditingId(id)\n      setShowForm(true)\n    }\n  }\n\n  const cancelEdit = () => {\n    setEditingId(null)\n    setFormData({ name: \"\", day: \"Monday\", bellTime: \"\", bellType: \"bell\" })\n    setShowForm(false)\n  }\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8 flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-4xl font-bold text-foreground mb-2\">Timetables</h1>\n          <p className=\"text-foreground/60\">Manage bell schedules and announcements</p>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button \n            onClick={async () => {\n              // Test the complete bell system\n              await CompleteBellSystem.playBellSequence(\n                \"System Test\",\n                \"This is a test of the complete bell system. Bell tone first, followed by voice announcement.\",\n                {\n                  bellType: \"bell\",\n                  voice: \"openai-nova\",\n                  useHighQualityVoice: true,\n                  repeatCount: 1\n                }\n              )\n            }}\n            variant=\"outline\" \n            className=\"gap-2\"\n          >\n            <Volume2 className=\"w-4 h-4\" />\n            Test Bell System\n          </Button>\n          <Button onClick={() => setShowForm(!showForm)} className=\"bg-blue-600 hover:bg-blue-700 text-white gap-2\">\n            <Plus className=\"w-4 h-4\" />\n            Add New Bell\n          </Button>\n        </div>\n      </div>\n\n      {showForm && (\n        <Card className=\"mb-6\">\n          <CardContent className=\"pt-6\">\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"text-sm font-semibold text-foreground mb-1 block\">Bell Name</label>\n                <Input\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  placeholder=\"e.g., Morning Assembly\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-3 gap-4\">\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">Day</label>\n                  <select\n                    value={formData.day}\n                    onChange={(e) => setFormData({ ...formData, day: e.target.value })}\n                    className=\"w-full p-2 border border-border rounded-lg bg-background\"\n                  >\n                    {days.map((day) => (\n                      <option key={day} value={day}>\n                        {day}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">Time</label>\n                  <Input\n                    type=\"time\"\n                    value={formData.bellTime}\n                    onChange={(e) => setFormData({ ...formData, bellTime: e.target.value })}\n                  />\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">Type</label>\n                  <select\n                    value={formData.bellType}\n                    onChange={(e) => setFormData({ ...formData, bellType: e.target.value })}\n                    className=\"w-full p-2 border border-border rounded-lg bg-background\"\n                  >\n                    {bellTypes.map((type) => (\n                      <option key={type} value={type}>\n                        {formatBellTypeName(type)}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button type=\"submit\" className=\"bg-green-600 hover:bg-green-700 text-white\">\n                  {editingId ? \"Update Bell\" : \"Save Bell\"}\n                </Button>\n                <Button type=\"button\" variant=\"outline\" onClick={cancelEdit}>\n                  Cancel\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      )}\n\n      <div className=\"space-y-3\">\n        {timetables.length === 0 ? (\n          <Card>\n            <CardContent className=\"pt-6 text-center text-foreground/60\">\n              No timetables yet. Create your first bell schedule.\n            </CardContent>\n          </Card>\n        ) : (\n          timetables.map((tt) => (\n            <Card key={tt.id}>\n              <CardContent className=\"pt-6 flex justify-between items-center\">\n                <div>\n                  <h3 className=\"font-semibold text-foreground\">{tt.name}</h3>\n                  <p className=\"text-sm text-foreground/60\">\n                    {tt.day} at {tt.bellTime} • {tt.bellType}\n                  </p>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={async () => {\n                      // Test the complete bell system with this timetable entry\n                      const taskType = tt.name.toLowerCase().includes(\"assembly\") ? \"assembly\" :\n                                     tt.name.toLowerCase().includes(\"break\") ? \"break\" :\n                                     tt.name.toLowerCase().includes(\"lunch\") ? \"lunch\" :\n                                     tt.name.toLowerCase().includes(\"dismissal\") ? \"dismissal\" :\n                                     tt.name.toLowerCase().includes(\"emergency\") ? \"emergency\" : \"class\"\n                      \n                      let message: string\n                      switch (taskType) {\n                        case \"class\":\n                          message = `Attention all students, it is time for ${tt.name}. Please proceed to your classrooms.`\n                          break\n                        case \"break\":\n                          message = `Attention all students, it is time for ${tt.name}. You may now leave your classrooms.`\n                          break\n                        case \"assembly\":\n                          message = `Attention all students and staff, it is time for ${tt.name}. Please proceed to the assembly hall.`\n                          break\n                        case \"lunch\":\n                          message = `Attention all students, it is time for ${tt.name}. Please proceed to the dining hall.`\n                          break\n                        case \"dismissal\":\n                          message = `Attention all students, it is time for ${tt.name}. Please collect your belongings and proceed to the exit.`\n                          break\n                        case \"emergency\":\n                          message = `Emergency alert. ${tt.name}. All students and staff must follow emergency procedures immediately.`\n                          break\n                        default:\n                          message = `Attention all students, it is time for ${tt.name}.`\n                      }\n                      \n                      await CompleteBellSystem.playBellSequence(\n                        tt.name,\n                        message,\n                        {\n                          bellType: tt.bellType as BellType,\n                          voice: \"openai-nova\",\n                          useHighQualityVoice: true,\n                          repeatCount: 1\n                        }\n                      )\n                    }}\n                    className=\"text-green-600 hover:text-green-700\"\n                    title=\"Test Complete Bell (Tone + Voice)\"\n                  >\n                    <Volume2 className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => startEdit(tt.id)}\n                    className=\"text-blue-600 hover:text-blue-700\"\n                  >\n                    <Edit2 className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => removeTimetable(tt.id)}\n                    className=\"text-red-600 hover:text-red-700\"\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          ))\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6801, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/students.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState } from \"react\"\nimport { useStore } from \"@/lib/store\"\nimport { Card, CardContent } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Trash2, Plus } from \"lucide-react\"\n\nexport function Students() {\n  const { students, addStudent, removeStudent } = useStore()\n  const [showForm, setShowForm] = useState(false)\n  const [formData, setFormData] = useState({\n    firstName: \"\",\n    lastName: \"\",\n    class: \"\",\n    useCustomClass: false,\n  })\n  const [searchTerm, setSearchTerm] = useState(\"\")\n\n  const classes = [\n    \"JHS 1 Blue\",\n    \"JHS 1 Green\",\n    \"JHS 1 Red\",\n    \"JHS 2 Blue\",\n    \"JHS 2 Green\",\n    \"JHS 2 Red\",\n    \"JHS 3 Blue\",\n    \"JHS 3 Green\",\n    \"JHS 3 Red\",\n  ]\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!formData.firstName || !formData.lastName) return\n\n    addStudent({\n      id: Date.now().toString(),\n      firstName: formData.firstName,\n      lastName: formData.lastName,\n      class: formData.class || undefined,\n    })\n\n    setFormData({ firstName: \"\", lastName: \"\", class: \"\", useCustomClass: false })\n    setShowForm(false)\n  }\n\n  const filteredStudents = students.filter((s) =>\n    `${s.firstName} ${s.lastName}`.toLowerCase().includes(searchTerm.toLowerCase()),\n  )\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8 flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-4xl font-bold text-foreground mb-2\">Students</h1>\n          <p className=\"text-foreground/60\">Manage student database</p>\n        </div>\n        <Button onClick={() => setShowForm(!showForm)} className=\"bg-blue-600 hover:bg-blue-700 text-white gap-2\">\n          <Plus className=\"w-4 h-4\" />\n          Add Student\n        </Button>\n      </div>\n\n      <div className=\"mb-6\">\n        <Input placeholder=\"Search by name...\" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />\n      </div>\n\n      {showForm && (\n        <Card className=\"mb-6\">\n          <CardContent className=\"pt-6\">\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">First Name</label>\n                  <Input\n                    value={formData.firstName}\n                    onChange={(e) => setFormData({ ...formData, firstName: e.target.value })}\n                    placeholder=\"First name\"\n                    required\n                  />\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">Last Name</label>\n                  <Input\n                    value={formData.lastName}\n                    onChange={(e) => setFormData({ ...formData, lastName: e.target.value })}\n                    placeholder=\"Last name\"\n                    required\n                  />\n                </div>\n              </div>\n\n              <div>\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"useCustom\"\n                    checked={formData.useCustomClass}\n                    onChange={(e) => setFormData({ ...formData, useCustomClass: e.target.checked, class: \"\" })}\n                    className=\"w-4 h-4\"\n                  />\n                  <label htmlFor=\"useCustom\" className=\"text-sm font-semibold text-foreground\">\n                    Use custom class name\n                  </label>\n                </div>\n\n                {formData.useCustomClass ? (\n                  <Input\n                    value={formData.class}\n                    onChange={(e) => setFormData({ ...formData, class: e.target.value })}\n                    placeholder=\"e.g., Form 2A, Grade 7, Senior 2\"\n                  />\n                ) : (\n                  <select\n                    value={formData.class}\n                    onChange={(e) => setFormData({ ...formData, class: e.target.value })}\n                    className=\"w-full p-2 border border-border rounded-lg bg-background\"\n                  >\n                    <option value=\"\">Select class (optional)</option>\n                    {classes.map((cls) => (\n                      <option key={cls} value={cls}>\n                        {cls}\n                      </option>\n                    ))}\n                  </select>\n                )}\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button type=\"submit\" className=\"bg-green-600 hover:bg-green-700 text-white\">\n                  Add Student\n                </Button>\n                <Button type=\"button\" variant=\"outline\" onClick={() => setShowForm(false)}>\n                  Cancel\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      )}\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        {filteredStudents.length === 0 ? (\n          <Card className=\"col-span-full\">\n            <CardContent className=\"pt-6 text-center text-foreground/60\">No students found.</CardContent>\n          </Card>\n        ) : (\n          filteredStudents.map((student) => (\n            <Card key={student.id}>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex justify-between items-start mb-2\">\n                  <div>\n                    <h3 className=\"font-semibold text-foreground\">\n                      {student.firstName} {student.lastName}\n                    </h3>\n                    {student.class && <p className=\"text-sm text-foreground/60\">{student.class}</p>}\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => removeStudent(student.id)}\n                    className=\"text-red-600 hover:text-red-700\"\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          ))\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7230, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/call-student.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { useStore } from \"@/lib/store\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Volume2 } from \"lucide-react\"\nimport { VOICE_OPTIONS, translateMessage, playTextToSpeech } from \"@/lib/voice-utils\"\nimport type { VoiceType } from \"@/lib/store\"\n\nexport function CallStudent() {\n  const { students, devices, settings, addCallRequest } = useStore()\n  const [searchTerm, setSearchTerm] = useState(\"\")\n  const [selectedStudent, setSelectedStudent] = useState<string | null>(null)\n  const [customMessage, setCustomMessage] = useState(\"\")\n  const [selectedTemplate, setSelectedTemplate] = useState(\"office\")\n  const [selectedVoice, setSelectedVoice] = useState<VoiceType>(settings.defaultVoice)\n  const [selectedLanguage, setSelectedLanguage] = useState(settings.defaultLanguage)\n  const [isPlaying, setIsPlaying] = useState(false)\n\n  const templates = [\n    { id: \"office\", text: \"should report to the office\" },\n    { id: \"parent\", text: \"your parent is waiting at the gate\" },\n    { id: \"staff\", text: \"please come to the staff common room\" },\n  ]\n\n  const filteredStudents = students.filter((s) =>\n    `${s.firstName} ${s.lastName}`.toLowerCase().includes(searchTerm.toLowerCase()),\n  )\n\n  const handleCallStudent = async () => {\n    if (!selectedStudent) return\n\n    const student = students.find((s) => s.id === selectedStudent)\n    if (!student) return\n\n    const baseMessage =\n      customMessage ||\n      `Student ${student.firstName} ${student.lastName}, ${templates.find((t) => t.id === selectedTemplate)?.text || \"\"}`\n\n    const finalMessage = translateMessage(baseMessage, selectedLanguage)\n\n    const request = {\n      id: Date.now().toString(),\n      studentId: selectedStudent,\n      message: finalMessage,\n      timestamp: new Date().toISOString(),\n      status: \"played\" as const,\n      voice: selectedVoice,\n      language: selectedLanguage,\n    }\n\n    addCallRequest(request)\n\n    setIsPlaying(true)\n    await playTextToSpeech(finalMessage, selectedVoice, selectedLanguage)\n    setIsPlaying(false)\n\n    setSelectedStudent(null)\n    setCustomMessage(\"\")\n  }\n\n  const playAudio = async (text: string, voice: VoiceType) => {\n    setIsPlaying(true)\n    await playTextToSpeech(text, voice, selectedLanguage)\n    setIsPlaying(false)\n  }\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-4xl font-bold text-foreground mb-2\">Call Student</h1>\n        <p className=\"text-foreground/60\">Use Text-to-Speech to call students in multiple languages</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <div className=\"lg:col-span-2\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Search & Call Student</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              <div>\n                <label className=\"text-sm font-semibold text-foreground mb-2 block\">Search Student</label>\n                <Input\n                  placeholder=\"Type student name...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  disabled={isPlaying}\n                />\n              </div>\n\n              {searchTerm && filteredStudents.length > 0 && (\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-2 block\">\n                    Results ({filteredStudents.length})\n                  </label>\n                  <div className=\"space-y-2 max-h-48 overflow-y-auto\">\n                    {filteredStudents.map((student) => (\n                      <button\n                        key={student.id}\n                        onClick={() => setSelectedStudent(student.id)}\n                        disabled={isPlaying}\n                        className={`w-full p-3 text-left rounded-lg border-2 transition ${selectedStudent === student.id\n                            ? \"border-blue-500 bg-blue-50 dark:bg-blue-950\"\n                            : \"border-border hover:border-blue-300\"\n                          } ${isPlaying ? \"opacity-50 cursor-not-allowed\" : \"\"}`}\n                      >\n                        <div className=\"font-semibold text-foreground\">\n                          {student.firstName} {student.lastName}\n                        </div>\n                        <div className=\"text-sm text-foreground/60\">{student.class || \"No class assigned\"}</div>\n                      </button>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {selectedStudent && (\n                <>\n                  <div>\n                    <label className=\"text-sm font-semibold text-foreground mb-2 block\">Message Template</label>\n                    <div className=\"space-y-2\">\n                      {templates.map((tmpl) => (\n                        <button\n                          key={tmpl.id}\n                          onClick={() => setSelectedTemplate(tmpl.id)}\n                          disabled={isPlaying}\n                          className={`w-full p-3 text-left rounded-lg border-2 transition ${selectedTemplate === tmpl.id\n                              ? \"border-green-500 bg-green-50 dark:bg-green-950\"\n                              : \"border-border\"\n                            } ${isPlaying ? \"opacity-50 cursor-not-allowed\" : \"\"}`}\n                        >\n                          <div className=\"font-semibold text-foreground\">\n                            Student {students.find((s) => s.id === selectedStudent)?.firstName}, {tmpl.text}\n                          </div>\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  <div>\n                    <label className=\"text-sm font-semibold text-foreground mb-2 block\">\n                      Custom Message (Optional)\n                    </label>\n                    <textarea\n                      placeholder=\"Enter custom message or leave blank to use template...\"\n                      value={customMessage}\n                      onChange={(e) => setCustomMessage(e.target.value)}\n                      disabled={isPlaying}\n                      className=\"w-full p-3 border border-border rounded-lg bg-background text-foreground disabled:opacity-50\"\n                      rows={3}\n                    />\n                  </div>\n\n                  <Button\n                    onClick={handleCallStudent}\n                    disabled={isPlaying}\n                    className=\"w-full bg-blue-600 hover:bg-blue-700 text-white gap-2 disabled:opacity-50\"\n                  >\n                    <Volume2 className=\"w-4 h-4\" />\n                    {isPlaying ? \"Playing...\" : \"Call Now\"}\n                  </Button>\n                </>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Speaker Zones</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-2\">\n              {devices.map((device) => (\n                <div key={device.id} className=\"p-3 rounded-lg bg-muted flex items-center justify-between\">\n                  <div>\n                    <div className=\"font-semibold text-foreground\">{device.name}</div>\n                    <div className={`text-xs ${device.status === \"online\" ? \"text-green-600\" : \"text-red-600\"}`}>\n                      {device.status === \"online\" ? \"● Online\" : \"● Offline\"}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Quick Info</CardTitle>\n            </CardHeader>\n            <CardContent className=\"text-sm text-foreground/70 space-y-2\">\n              <p>✓ Select a student</p>\n              <p>✓ Select message template</p>\n              <p>✓ Click \"Call Now\" to play</p>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7688, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/announcements.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\nimport { playTextToSpeech } from \"@/lib/voice-utils\"\nimport { useState } from \"react\"\nimport { useStore } from \"@/lib/store\"\nimport { Card, CardContent } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Volume2, Plus, RotateCcw, Pencil } from \"lucide-react\"\nimport { VOICE_OPTIONS } from \"@/lib/voice-utils\"\nimport type { VoiceType, Language } from \"@/lib/store\"\n\nexport function Announcements() {\n  const { settings } = useStore()\n  const [announcements, setAnnouncements] = useState([\n    {\n      id: 1,\n      title: \"Assembly Tomorrow\",\n      content: \"All students attend assembly at 8 AM tomorrow\",\n      date: \"2024-01-15\",\n      voice: settings.defaultVoice as VoiceType,\n      language: settings.defaultLanguage,\n      repeatCount: 1,\n    },\n  ])\n  const [showForm, setShowForm] = useState(false)\n  const [formData, setFormData] = useState({\n    title: \"\",\n    content: \"\",\n    voice: settings.defaultVoice as VoiceType,\n    language: settings.defaultLanguage,\n    repeatCount: settings.defaultRepeatCount || 1,\n  })\n  const [playingId, setPlayingId] = useState<number | null>(null)\n  const [lastPlayedId, setLastPlayedId] = useState<number | null>(null)\n  const [editingId, setEditingId] = useState<number | null>(null)\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault()\n    const newAnnouncement = {\n      id: Date.now(),\n      title: formData.title,\n      content: formData.content,\n      date: new Date().toISOString().split(\"T\")[0],\n      voice: formData.voice,\n      language: formData.language,\n      repeatCount: formData.repeatCount,\n    }\n\n    if (editingId) {\n      setAnnouncements(announcements.map(a => a.id === editingId ? { ...newAnnouncement, id: editingId, date: a.date } : a))\n      setEditingId(null)\n    } else {\n      setAnnouncements([...announcements, newAnnouncement])\n    }\n\n    setFormData({\n      title: \"\",\n      content: \"\",\n      voice: settings.defaultVoice as VoiceType,\n      language: settings.defaultLanguage,\n      repeatCount: settings.defaultRepeatCount || 1,\n    })\n    setShowForm(false)\n  }\n\n  const playAnnouncement = async (id: number, text: string, voice: VoiceType, language: string, repeatCount: number = 1) => {\n    console.log('Playing announcement with repeat count:', repeatCount)\n    setPlayingId(id)\n\n    for (let i = 0; i < repeatCount; i++) {\n      console.log(`Playing repetition ${i + 1} of ${repeatCount}`)\n      await playTextToSpeech(text, voice, language as Language)\n\n      // Add a small delay between repetitions if not the last one\n      if (i < repeatCount - 1) {\n        await new Promise(resolve => setTimeout(resolve, 1500))\n      }\n    }\n\n    setPlayingId(null)\n    setLastPlayedId(id)\n  }\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8 flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-4xl font-bold text-foreground mb-2\">Announcements</h1>\n          <p className=\"text-foreground/60\">Create and manage audio announcements in multiple voices & languages</p>\n        </div>\n      </div>\n      <Button onClick={() => {\n        setShowForm(!showForm)\n        setEditingId(null)\n        setFormData({\n          title: \"\",\n          content: \"\",\n          voice: settings.defaultVoice as VoiceType,\n          language: settings.defaultLanguage,\n          repeatCount: settings.defaultRepeatCount || 1,\n        })\n      }} className=\"bg-blue-600 hover:bg-blue-700 text-white gap-2\">\n        <Plus className=\"w-4 h-4\" />\n        New Announcement\n      </Button>\n      {\n        showForm && (\n          <Card className=\"mb-6\">\n            <CardContent className=\"pt-6\">\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">Title</label>\n                  <input\n                    type=\"text\"\n                    value={formData.title}\n                    onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                    className=\"w-full p-2 border border-border rounded-lg bg-background\"\n                    placeholder=\"Announcement title\"\n                    required\n                  />\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">Message</label>\n                  <textarea\n                    value={formData.content}\n                    onChange={(e) => setFormData({ ...formData, content: e.target.value })}\n                    className=\"w-full p-2 border border-border rounded-lg bg-background\"\n                    placeholder=\"Write announcement message\"\n                    rows={4}\n                    required\n                  />\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">Voice</label>\n                  <select\n                    value={formData.voice}\n                    onChange={(e) => setFormData({ ...formData, voice: e.target.value as VoiceType })}\n                    className=\"w-full p-2 border border-border rounded-lg bg-background text-foreground\"\n                  >\n                    {Object.entries(VOICE_OPTIONS).map(([key, data]) => (\n                      <option key={key} value={key}>\n                        {data.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">Language</label>\n                  <select\n                    value={formData.language}\n                    onChange={(e) => setFormData({ ...formData, language: e.target.value as Language })}\n                    className=\"w-full p-2 border border-border rounded-lg bg-background text-foreground\"\n                  >\n                    <option value=\"english\">English</option>\n                    <option value=\"hausa\">Hausa</option>\n                    <option value=\"twi\">Twi</option>\n                    <option value=\"arabic\">Arabic</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-semibold text-foreground mb-1 block\">Repeat Count</label>\n                  <input\n                    type=\"number\"\n                    min=\"1\"\n                    max=\"10\"\n                    value={formData.repeatCount}\n                    onChange={(e) => setFormData({ ...formData, repeatCount: parseInt(e.target.value) || 1 })}\n                    className=\"w-full p-2 border border-border rounded-lg bg-background\"\n                    required\n                  />\n                </div>\n\n                <div className=\"flex gap-2\">\n                  <Button type=\"submit\" className=\"bg-green-600 hover:bg-green-700 text-white\">\n                    {editingId ? \"Update Announcement\" : \"Create Announcement\"}\n                  </Button>\n                  <Button type=\"button\" variant=\"outline\" onClick={() => setShowForm(false)}>\n                    Cancel\n                  </Button>\n                </div>\n              </form>\n            </CardContent>\n          </Card>\n        )\n      }\n\n      <div className=\"space-y-3\">\n        {announcements.map((ann) => (\n          <Card key={ann.id}>\n            <CardContent className=\"pt-6\">\n              <div className=\"flex justify-between items-start\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2\">\n                    <h3 className=\"font-semibold text-foreground\">{ann.title}</h3>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"h-6 w-6 text-foreground/40 hover:text-foreground\"\n                      onClick={() => {\n                        setFormData({\n                          title: ann.title,\n                          content: ann.content,\n                          voice: ann.voice,\n                          language: ann.language as Language,\n                          repeatCount: ann.repeatCount || 1,\n                        })\n                        setEditingId(ann.id)\n                        setShowForm(true)\n                      }}\n                    >\n                      <Pencil className=\"w-3 h-3\" />\n                    </Button>\n                  </div>\n                  <p className=\"text-sm text-foreground/70 mt-1\">{ann.content}</p>\n                  <div className=\"flex gap-4 text-xs text-foreground/60 mt-2\">\n                    <span>Voice: {VOICE_OPTIONS[ann.voice]?.name || \"Standard\"}</span>\n                    <span>Language: {ann.language}</span>\n                    <span>Repeats: {ann.repeatCount || 1}</span>\n                    <span>{ann.date}</span>\n                  </div>\n                </div>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => playAnnouncement(ann.id, ann.content, ann.voice, ann.language, ann.repeatCount || 1)}\n                  disabled={playingId === ann.id}\n                  className=\"gap-2\"\n                >\n                  <Volume2 className=\"w-4 h-4\" />\n                  {playingId === ann.id ? \"Playing...\" : \"Preview\"}\n                </Button>\n                {lastPlayedId === ann.id && playingId !== ann.id && (\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => playAnnouncement(ann.id, ann.content, ann.voice, ann.language, ann.repeatCount || 1)}\n                    className=\"gap-2 ml-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50\"\n                  >\n                    <RotateCcw className=\"w-4 h-4\" />\n                    Replay\n                  </Button>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8276, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/devices.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState } from \"react\"\nimport { useStore } from \"@/lib/store\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Wifi, WifiOff, Plus, Trash2 } from \"lucide-react\"\n\nexport function Devices() {\n  const { devices, addDevice, removeDevice } = useStore()\n  const [showForm, setShowForm] = useState(false)\n  const [formData, setFormData] = useState({\n    name: \"\",\n    type: \"esp32\" as const,\n  })\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!formData.name) return\n\n    addDevice({\n      id: Date.now().toString(),\n      name: formData.name,\n      type: formData.type,\n      status: \"online\",\n      lastSeen: new Date().toISOString(),\n    })\n\n    setFormData({ name: \"\", type: \"esp32\" })\n    setShowForm(false)\n  }\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8 flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-4xl font-bold text-foreground mb-2\">Devices</h1>\n          <p className=\"text-foreground/60\">Manage speakers and hardware devices</p>\n        </div>\n        <Button onClick={() => setShowForm(!showForm)} className=\"bg-blue-600 hover:bg-blue-700 text-white gap-2\">\n          <Plus className=\"w-4 h-4\" />\n          Add Device\n        </Button>\n      </div>\n\n      {showForm && (\n        <Card className=\"mb-6\">\n          <CardContent className=\"pt-6\">\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"text-sm font-semibold text-foreground mb-1 block\">Device Name</label>\n                <Input\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  placeholder=\"e.g., Office Speaker\"\n                />\n              </div>\n\n              <div>\n                <label className=\"text-sm font-semibold text-foreground mb-1 block\">Device Type</label>\n                <select\n                  value={formData.type}\n                  onChange={(e) => setFormData({ ...formData, type: e.target.value as any })}\n                  className=\"w-full p-2 border border-border rounded-lg bg-background\"\n                >\n                  <option value=\"esp32\">ESP32 + DFPlayer</option>\n                  <option value=\"raspberry-pi\">Raspberry Pi</option>\n                </select>\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button type=\"submit\" className=\"bg-green-600 hover:bg-green-700 text-white\">\n                  Add Device\n                </Button>\n                <Button type=\"button\" variant=\"outline\" onClick={() => setShowForm(false)}>\n                  Cancel\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      )}\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        {devices.length === 0 ? (\n          <Card className=\"col-span-full\">\n            <CardContent className=\"pt-6 text-center text-foreground/60\">No devices paired yet.</CardContent>\n          </Card>\n        ) : (\n          devices.map((device) => (\n            <Card key={device.id}>\n              <CardContent className=\"pt-6\">\n                <div className=\"flex justify-between items-start mb-4\">\n                  <div>\n                    <h3 className=\"font-semibold text-foreground\">{device.name}</h3>\n                    <p className=\"text-xs text-foreground/60 capitalize\">{device.type.replace(\"-\", \" \")}</p>\n                  </div>\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => removeDevice(device.id)} className=\"text-red-600\">\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n\n                <div className=\"flex items-center gap-2 mb-2\">\n                  {device.status === \"online\" ? (\n                    <>\n                      <Wifi className=\"w-4 h-4 text-green-600\" />\n                      <span className=\"text-sm text-green-600 font-semibold\">Online</span>\n                    </>\n                  ) : (\n                    <>\n                      <WifiOff className=\"w-4 h-4 text-red-600\" />\n                      <span className=\"text-sm text-red-600 font-semibold\">Offline</span>\n                    </>\n                  )}\n                </div>\n\n                <p className=\"text-xs text-foreground/50\">\n                  Last seen: {new Date(device.lastSeen).toLocaleDateString()}\n                </p>\n              </CardContent>\n            </Card>\n          ))\n        )}\n      </div>\n\n      <Card className=\"mt-8 bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800\">\n        <CardHeader>\n          <CardTitle className=\"text-blue-900 dark:text-blue-100\">Offline Mode Support</CardTitle>\n        </CardHeader>\n        <CardContent className=\"text-blue-800 dark:text-blue-100 space-y-2\">\n          <p>✓ All devices store schedules locally</p>\n          <p>✓ Bells ring automatically even without internet</p>\n          <p>✓ Student name calls queued and played when online</p>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8706, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/logs.tsx"],"sourcesContent":["\"use client\"\n\nimport { useStore } from \"@/lib/store\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { Trash2 } from \"lucide-react\"\n\nexport function Logs() {\n  const { callRequests, timetables, clearCallRequests } = useStore()\n\n  const logs = [\n    ...timetables.map((tt) => ({\n      id: tt.id,\n      type: \"bell\",\n      message: `${tt.name} triggered`,\n      timestamp: new Date().toISOString(),\n      status: \"success\",\n    })),\n    ...callRequests.map((cr) => ({\n      id: cr.id,\n      type: \"student-call\",\n      message: cr.message,\n      timestamp: cr.timestamp,\n      status: cr.status,\n    })),\n  ].sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime())\n\n  const handleClearLogs = () => {\n    if (window.confirm(\"Are you sure you want to clear all logs? This cannot be undone.\")) {\n      clearCallRequests()\n    }\n  }\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8 flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-4xl font-bold text-foreground mb-2\">Logs & Reports</h1>\n          <p className=\"text-foreground/60\">Activity history and system events</p>\n        </div>\n        {logs.length > 0 && (\n          <Button onClick={handleClearLogs} className=\"bg-red-600 hover:bg-red-700 text-white gap-2\">\n            <Trash2 className=\"w-4 h-4\" />\n            Clear All Logs\n          </Button>\n        )}\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Recent Activity</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {logs.length === 0 ? (\n            <p className=\"text-foreground/60 text-center py-8\">No activity yet</p>\n          ) : (\n            <div className=\"space-y-3\">\n              {logs.map((log) => (\n                <div\n                  key={log.id}\n                  className=\"flex justify-between items-start pb-3 border-b border-border last:border-b-0\"\n                >\n                  <div>\n                    <div className=\"text-sm font-semibold text-foreground capitalize\">\n                      {log.type === \"bell\" ? \"Bell\" : \"Student Call\"}\n                    </div>\n                    <p className=\"text-sm text-foreground/70 mt-1\">{log.message}</p>\n                  </div>\n                  <div className=\"text-right\">\n                    <span\n                      className={`text-xs px-2 py-1 rounded-full ${\n                        log.status === \"success\" || log.status === \"played\"\n                          ? \"bg-green-100 text-green-800 dark:bg-green-950 dark:text-green-200\"\n                          : \"bg-yellow-100 text-yellow-800 dark:bg-yellow-950 dark:text-yellow-200\"\n                      }`}\n                    >\n                      {log.status}\n                    </span>\n                    <p className=\"text-xs text-foreground/50 mt-1\">{new Date(log.timestamp).toLocaleTimeString()}</p>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOO,SAAS;IACd,MAAM,EAAE,YAAY,EAAE,UAAU,EAAE,iBAAiB,EAAE,GAAG,IAAA,iKAAQ;IAEhE,MAAM,OAAO;WACR,WAAW,GAAG,CAAC,CAAC,KAAO,CAAC;gBACzB,IAAI,GAAG,EAAE;gBACT,MAAM;gBACN,SAAS,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC;gBAC/B,WAAW,IAAI,OAAO,WAAW;gBACjC,QAAQ;YACV,CAAC;WACE,aAAa,GAAG,CAAC,CAAC,KAAO,CAAC;gBAC3B,IAAI,GAAG,EAAE;gBACT,MAAM;gBACN,SAAS,GAAG,OAAO;gBACnB,WAAW,GAAG,SAAS;gBACvB,QAAQ,GAAG,MAAM;YACnB,CAAC;KACF,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO,KAAK,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO;IAEhF,MAAM,kBAAkB;QACtB,IAAI,OAAO,OAAO,CAAC,oEAAoE;YACrF;QACF;IACF;IAEA,qBACE,uRAAC;QAAI,WAAU;;0BACb,uRAAC;gBAAI,WAAU;;kCACb,uRAAC;;0CACC,uRAAC;gCAAG,WAAU;0CAA0C;;;;;;0CACxD,uRAAC;gCAAE,WAAU;0CAAqB;;;;;;;;;;;;oBAEnC,KAAK,MAAM,GAAG,mBACb,uRAAC,8KAAM;wBAAC,SAAS;wBAAiB,WAAU;;0CAC1C,uRAAC,6PAAM;gCAAC,WAAU;;;;;;4BAAY;;;;;;;;;;;;;0BAMpC,uRAAC,0KAAI;;kCACH,uRAAC,gLAAU;kCACT,cAAA,uRAAC,+KAAS;sCAAC;;;;;;;;;;;kCAEb,uRAAC,iLAAW;kCACT,KAAK,MAAM,KAAK,kBACf,uRAAC;4BAAE,WAAU;sCAAsC;;;;;iDAEnD,uRAAC;4BAAI,WAAU;sCACZ,KAAK,GAAG,CAAC,CAAC,oBACT,uRAAC;oCAEC,WAAU;;sDAEV,uRAAC;;8DACC,uRAAC;oDAAI,WAAU;8DACZ,IAAI,IAAI,KAAK,SAAS,SAAS;;;;;;8DAElC,uRAAC;oDAAE,WAAU;8DAAmC,IAAI,OAAO;;;;;;;;;;;;sDAE7D,uRAAC;4CAAI,WAAU;;8DACb,uRAAC;oDACC,WAAW,CAAC,+BAA+B,EACzC,IAAI,MAAM,KAAK,aAAa,IAAI,MAAM,KAAK,WACvC,sEACA,yEACJ;8DAED,IAAI,MAAM;;;;;;8DAEb,uRAAC;oDAAE,WAAU;8DAAmC,IAAI,KAAK,IAAI,SAAS,EAAE,kBAAkB;;;;;;;;;;;;;mCAnBvF,IAAI,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6B7B"}},
    {"offset": {"line": 8908, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/components/settings.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { useStore } from \"@/lib/store\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\nimport { SettingsIcon, Volume2, Clock } from \"lucide-react\"\nimport { VOICE_OPTIONS } from \"@/lib/voice-utils\"\nimport type { VoiceType } from \"@/lib/store\"\n\nexport function Settings() {\n  const { settings, updateSettings } = useStore()\n  const [tempSettings, setTempSettings] = useState(settings)\n\n  const handleSave = () => {\n    updateSettings(tempSettings)\n    alert(\"Settings saved successfully!\")\n  }\n\n  return (\n    <div className=\"p-8\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-4xl font-bold text-foreground mb-2\">System Settings</h1>\n        <p className=\"text-foreground/60\">Configure voices, languages, and Islamic prayer times</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Default Voice & Language */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Volume2 className=\"w-5 h-5\" />\n              Default Voice & Language\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <label className=\"text-sm font-semibold text-foreground mb-2 block\">Default Voice</label>\n              <select\n                value={tempSettings.defaultVoice}\n                onChange={(e) =>\n                  setTempSettings({\n                    ...tempSettings,\n                    defaultVoice: e.target.value as VoiceType,\n                  })\n                }\n                className=\"w-full p-2 border border-border rounded-lg bg-background text-foreground\"\n              >\n                {Object.entries(VOICE_OPTIONS).map(([key, data]) => (\n                  <option key={key} value={key}>\n                    {data.name}\n                  </option>\n                ))}\n              </select>\n              <p className=\"text-xs text-foreground/60 mt-2\">{VOICE_OPTIONS[tempSettings.defaultVoice].description}</p>\n            </div>\n\n            <div>\n              <label className=\"text-sm font-semibold text-foreground mb-2 block\">Default Language</label>\n              <select\n                value={tempSettings.defaultLanguage}\n                onChange={(e) =>\n                  setTempSettings({\n                    ...tempSettings,\n                    defaultLanguage: e.target.value as any,\n                  })\n                }\n                className=\"w-full p-2 border border-border rounded-lg bg-background text-foreground\"\n              >\n                <option value=\"english\">English</option>\n                <option value=\"hausa\">Hausa</option>\n                <option value=\"twi\">Twi</option>\n                <option value=\"arabic\">Arabic</option>\n              </select>\n            </div>\n\n            <div>\n              <label className=\"text-sm font-semibold text-foreground mb-2 block\">Default Repeat Count</label>\n              <input\n                type=\"number\"\n                min=\"1\"\n                max=\"10\"\n                value={tempSettings.defaultRepeatCount}\n                onChange={(e) =>\n                  setTempSettings({\n                    ...tempSettings,\n                    defaultRepeatCount: parseInt(e.target.value) || 1,\n                  })\n                }\n                className=\"w-full p-2 border border-border rounded-lg bg-background text-foreground\"\n              />\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Islamic Settings */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Clock className=\"w-5 h-5\" />\n              Islamic Prayer Times (Azan)\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex items-center gap-2 mb-4\">\n              <input\n                type=\"checkbox\"\n                checked={tempSettings.azanEnabled}\n                onChange={(e) =>\n                  setTempSettings({\n                    ...tempSettings,\n                    azanEnabled: e.target.checked,\n                  })\n                }\n                className=\"w-4 h-4\"\n              />\n              <label className=\"text-sm font-semibold text-foreground\">Enable Azan (Islamic Call to Prayer)</label>\n            </div>\n\n            {tempSettings.azanEnabled && tempSettings.prayerTimes && (\n              <div className=\"space-y-3\">\n                {Object.entries(tempSettings.prayerTimes).map(([prayer, time]) => (\n                  <div key={prayer}>\n                    <label className=\"text-sm font-semibold text-foreground mb-1 block capitalize\">{prayer} Time</label>\n                    <input\n                      type=\"time\"\n                      value={time}\n                      onChange={(e) =>\n                        setTempSettings({\n                          ...tempSettings,\n                          prayerTimes: {\n                            ...tempSettings.prayerTimes!,\n                            [prayer]: e.target.value,\n                          },\n                        })\n                      }\n                      className=\"w-full p-2 border border-border rounded-lg bg-background text-foreground\"\n                    />\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"mt-8 flex gap-3\">\n        <Button onClick={handleSave} className=\"bg-green-600 hover:bg-green-700 text-white\">\n          <SettingsIcon className=\"w-4 h-4 mr-2\" />\n          Save Settings\n        </Button>\n        <Button variant=\"outline\" onClick={() => setTempSettings(settings)}>\n          Cancel\n        </Button>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 9309, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Downloads/school-bell-system/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { Sidebar } from \"@/components/sidebar\"\nimport { Dashboard } from \"@/components/dashboard\"\nimport { Timetable } from \"@/components/timetable\"\nimport { Students } from \"@/components/students\"\nimport { CallStudent } from \"@/components/call-student\"\nimport { Announcements } from \"@/components/announcements\"\nimport { Devices } from \"@/components/devices\"\nimport { Logs } from \"@/components/logs\"\nimport { Settings } from \"@/components/settings\"\n\nexport default function Home() {\n  const [currentPage, setCurrentPage] = useState(\"dashboard\")\n\n  const renderPage = () => {\n    switch (currentPage) {\n      case \"dashboard\":\n        return <Dashboard />\n      case \"timetable\":\n        return <Timetable />\n      case \"students\":\n        return <Students />\n      case \"call-student\":\n        return <CallStudent />\n      case \"announcements\":\n        return <Announcements />\n      case \"devices\":\n        return <Devices />\n      case \"logs\":\n        return <Logs />\n      case \"settings\":\n        return <Settings />\n      default:\n        return <Dashboard />\n    }\n  }\n\n  return (\n    <div className=\"flex h-screen bg-background\">\n      <Sidebar currentPage={currentPage} setCurrentPage={setCurrentPage} />\n      <main className=\"flex-1 overflow-auto\">{renderPage()}</main>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;;;;;;;;;;;;AAae,SAAS;IACtB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,0PAAQ,EAAC;IAE/C,MAAM,aAAa;QACjB,OAAQ;YACN,KAAK;gBACH,qBAAO,uRAAC,8KAAS;;;;;YACnB,KAAK;gBACH,qBAAO,uRAAC,8KAAS;;;;;YACnB,KAAK;gBACH,qBAAO,uRAAC,4KAAQ;;;;;YAClB,KAAK;gBACH,qBAAO,uRAAC,sLAAW;;;;;YACrB,KAAK;gBACH,qBAAO,uRAAC,sLAAa;;;;;YACvB,KAAK;gBACH,qBAAO,uRAAC,0KAAO;;;;;YACjB,KAAK;gBACH,qBAAO,uRAAC,oKAAI;;;;;YACd,KAAK;gBACH,qBAAO,uRAAC,4KAAQ;;;;;YAClB;gBACE,qBAAO,uRAAC,8KAAS;;;;;QACrB;IACF;IAEA,qBACE,uRAAC;QAAI,WAAU;;0BACb,uRAAC,0KAAO;gBAAC,aAAa;gBAAa,gBAAgB;;;;;;0BACnD,uRAAC;gBAAK,WAAU;0BAAwB;;;;;;;;;;;;AAG9C"}}]
}